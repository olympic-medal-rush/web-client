var Ye=(d,p,l)=>{if(!p.has(d))throw TypeError("Cannot "+l)};var _=(d,p,l)=>(Ye(d,p,"read from private field"),l?l.call(d):p.get(d)),tt=(d,p,l)=>{if(p.has(d))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(d):p.set(d,l)},et=(d,p,l,u)=>(Ye(d,p,"write to private field"),u?u.call(d,l):p.set(d,l),l);import{s as nt,E as ut,b as M,_ as Je,g as Jt,G as I,h as v,D as ss,M as Pt,i as rs}from"./index-ef0e659c.js";import{c as os,g as as}from"./_commonjsHelpers-725317a4.js";import{P as ls,a as ps}from"./debugConfig-0eed7304.js";function us(d,p){for(var l=0;l<p.length;l++){const u=p[l];if(typeof u!="string"&&!Array.isArray(u)){for(const x in u)if(x!=="default"&&!(x in d)){const y=Object.getOwnPropertyDescriptor(u,x);y&&Object.defineProperty(d,x,y.get?y:{enumerable:!0,get:()=>u[x]})}}}return Object.freeze(Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}))}function cs(d,p,l){const u=d.addFolder({title:l,expanded:!1});let x=0;const y=async()=>{const E=M.$wrapper;if(p.orbitControls)E.style.pointerEvents="",p.orbitControls.dispose(),p.orbitControls=null,p.position.set(0,0,10),p.far=x,p.updateProjectionMatrix();else{E.style.pointerEvents="all";const D=await Je(()=>import("./OrbitControls-795594b3.js"),["assets/OrbitControls-795594b3.js","assets/index-ef0e659c.js","assets/index-4bea3ac6.css"]);p.orbitControls=new D.OrbitControls(p,E),p.orbitControls.enableDamping=!0,p.orbitControls.dampingFactor=.15,p.orbitControls.enableZoom=!0,p.orbitControls.update(),p.position.z+=10,x=p.far,p.far=200,p.updateProjectionMatrix()}},w={Orbit:!1};return new URLSearchParams(location.search).has("orbit")&&(y(),w.Orbit=!0),nt.on(ut.TICK,()=>{var E;return(E=p.orbitControls)==null?void 0:E.update()}),u.addInput(w,"Orbit",{title:"OrbitControls"}).on("change",y),u.addInput(p,"fov"),u.addInput(p,"near"),u.addInput(p,"far"),u.on("change",()=>p.updateProjectionMatrix()),u}function ds(d){}const hs=Object.freeze(Object.defineProperty({__proto__:null,createPane:cs,debug:ds},Symbol.toStringTag,{value:"Module"}));let Yt=0,R,kt,Vt=null,Wt=null;const We=Object.entries(rs),b=Jt.data.length-1;function vs(d,p,l){const u=d.addFolder({title:l,expanded:!0});u.addButton({title:"Create Team"}).on("click",()=>{const w=Math.round(Math.random()*(We.length-1)),c=We[w];I.game.createTeam({iso:c[0],position:{x:v(0,b),y:v(0,b)}}),console.log("Create Team",c[0])}),u.addButton({title:"Spawn Medals"}).on("click",()=>{const w=[{id:Yt++,type:0,position:{x:v(0,b),y:v(0,b)}},{id:Yt++,type:1,position:{x:v(0,b),y:v(0,b)}},{id:Yt++,type:2,position:{x:v(0,b),y:v(0,b)}}];I.game.addMedals({medals:w})}),u.addButton({title:"Collect Medal"}).on("click",()=>{const w=Array.from(I.game.medals);if(w.length>0){const c={iso:M.webgl.camera.playerFocus.name,medal:w[Math.floor(Math.random()*w.length)][1]};I.game.medalCollect(c)}else alert("There are no more medals at play")}),u.addSeparator(),nt.on(ut.CREATE_TEAM,()=>y()),nt.on(ut.STATE_READY,()=>y()),Wt=M.debug.urlParams.getString("team")||"FRA";function y(){R==null||R.dispose(),kt==null||kt.dispose(),Vt==null||Vt.dispose();const w=[...I.game.teams.keys()].map(c=>({text:c,value:c}));R=u.addBlade({view:"list",label:"Team",options:w,value:Wt}).on("change",c=>{M.webgl.camera.playerFocus=M.webgl.players.get(c.value),Wt=c.value}),kt=u.addBlade({view:"buttongrid",size:[3,3],cells:(c,E)=>({title:[["-","UP","-"],["LEFT","-","RIGHT"],["-","DOWN","-"]][E][c]}),label:"Move Team"}).on("click",c=>{R&&c.cell.title!=="-"&&I.game.voteResults({iso:R.value,direction:ss[c.cell.title.toLowerCase()],nextVoteId:0})}),Vt=u.addButton({title:"Get Zone"}).on("click",()=>{if(!(R!=null&&R.value))return;const c=I.game.teams.get(R.value).position;console.log(Jt.mapping[Jt.data[c.y][c.x]],c.x,c.y)})}return u}function bs(d){if(M.debug.urlParams.has("noServer")){nt.on(ut.KEY_DOWN,l=>{switch(l){case"ArrowUp":M.webgl.camera.playerFocus.positionOnGrid.y--;break;case"ArrowDown":M.webgl.camera.playerFocus.positionOnGrid.y++;break;case"ArrowLeft":M.webgl.camera.playerFocus.positionOnGrid.x--;break;case"ArrowRight":M.webgl.camera.playerFocus.positionOnGrid.x++;break}}),I.game.setState({userId:"userId",teamsState:{FRA:{iso:"FRA",position:{x:v(0,b),y:v(0,b)},medals:{0:5,1:2,2:15}},ESP:{iso:"ESP",position:{x:v(0,b),y:v(0,b)},medals:{0:1,1:2,2:3}},AFG:{iso:"AFG",position:{x:v(0,b),y:v(0,b)},medals:{0:50,1:4,2:12}}},medalsInGame:[{id:-4,type:Pt.bronze,position:{x:v(0,b),y:v(0,b)}},{id:-3,type:Pt.gold,position:{x:v(0,b),y:v(0,b)}},{id:-2,type:Pt.gold,position:{x:v(0,b),y:v(0,b)}},{id:-1,type:Pt.silver,position:{x:v(0,b),y:v(0,b)}}]});const p=M.debug.urlParams.getString("team")||"FRA";I.game.userJoin({iso:p,voteId:1,voteProgress:.5,votes:{down:25,left:25,right:25,up:25}})}}const ms=Object.freeze(Object.defineProperty({__proto__:null,createPane:vs,debug:bs},Symbol.toStringTag,{value:"Module"}));function gs(d){}const _s=Object.freeze(Object.defineProperty({__proto__:null,debug:gs},Symbol.toStringTag,{value:"Module"}));function fs(d,p,l){const u=d.addFolder({title:l,expanded:!1});return u.addMonitor(p.info.memory,"geometries",{label:"Geometries"}),u.addMonitor(p.info.memory,"textures",{label:"Textures"}),u.addMonitor(p.info.programs,"length",{label:"Programs"}),u.addMonitor(p.info.render,"calls",{label:"Calls"}),u.addMonitor(p.info.render,"points",{label:"Points"}),u.addMonitor(p.info.render,"triangles",{label:"Triangles"}),p.info.autoReset=!1,nt.on(ut.RENDER,()=>p.info.reset()),u}function ws(d){}const xs=Object.freeze(Object.defineProperty({__proto__:null,createPane:fs,debug:ws},Symbol.toStringTag,{value:"Module"}));var ct={},ys={get exports(){return ct},set exports(d){ct=d}};(function(d,p){(function(l,u){u(p)})(os,function(l){class u{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class x{constructor(t){this.target=t}}class y extends x{constructor(t,e,n,s){super(t),this.value=e,this.presetKey=n,this.last=s??!0}}function w(i){return i}function c(i){return i==null}const E={alreadydisposed:()=>"View has been already disposed",invalidparams:i=>`Invalid parameters for '${i.name}'`,nomatchingcontroller:i=>`No matching controller for '${i.key}'`,nomatchingview:i=>`No matching view for '${JSON.stringify(i.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:i=>`Property '${i.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class D{constructor(t){var e;this.message=(e=E[t.type](t.context))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new D({type:"alreadydisposed"})}static notBindable(){return new D({type:"notbindable"})}static propertyNotFound(t){return new D({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new D({type:"shouldneverhappen"})}}class S{constructor(){this.observers_={}}on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter(s=>s.handler!==e)),this}emit(t,e){const n=this.observers_[t];n&&n.forEach(s=>{s.handler(e)})}}const Ze="tp";function m(i){return(e,n)=>[Ze,"-",i,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function Qe(i,t){return e=>t(i(e))}function ti(i){return i.rawValue}function B(i,t){i.emitter.on("change",Qe(ti,t)),t(i.rawValue)}function Y(i,t,e){B(i.value(t),e)}function ei(i,t,e){e?i.classList.add(t):i.classList.remove(t)}function ht(i,t){return e=>{ei(i,t,e)}}function ii(i,t){B(i,e=>{t.textContent=e??""})}const zt=m("btn");class ni{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(zt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(zt("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const s=t.createElement("div");s.classList.add(zt("t")),ii(e.props.value("title"),s),this.buttonElement.appendChild(s)}}class si{constructor(t,e){this.emitter=new S,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new ni(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ri{constructor(t,e){var n;this.constraint_=e==null?void 0:e.constraint,this.equals_=(n=e==null?void 0:e.equals)!==null&&n!==void 0?n:(s,r)=>s===r,this.emitter=new S,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(t):t,r=this.rawValue_;this.equals_(r,s)&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:s,sender:this}))}}class oi{constructor(t){this.emitter=new S,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0},s=this.value_;s===t&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:this.value_,sender:this}))}}function O(i,t){const e=t==null?void 0:t.constraint,n=t==null?void 0:t.equals;return!e&&!n?new oi(i):new ri(i,t)}class g{constructor(t){this.emitter=new S,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}static createCore(t){return Object.keys(t).reduce((n,s)=>Object.assign(n,{[s]:O(t[s])}),{})}static fromObject(t){const e=this.createCore(t);return new g(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function ai(i,t){const n=Object.keys(t).reduce((s,r)=>{if(s===void 0)return;const o=t[r],a=o(i[r]);return a.succeeded?Object.assign(Object.assign({},s),{[r]:a.value}):void 0},{});return n}function li(i,t){return i.reduce((e,n)=>{if(e===void 0)return;const s=t(n);if(!(!s.succeeded||s.value===void 0))return[...e,s.value]},[])}function pi(i){return i===null?!1:typeof i=="object"}function N(i){return t=>e=>{if(!t&&e===void 0)return{succeeded:!1,value:void 0};if(t&&e===void 0)return{succeeded:!0,value:void 0};const n=i(e);return n!==void 0?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function Zt(i){return{custom:t=>N(t)(i),boolean:N(t=>typeof t=="boolean"?t:void 0)(i),number:N(t=>typeof t=="number"?t:void 0)(i),string:N(t=>typeof t=="string"?t:void 0)(i),function:N(t=>typeof t=="function"?t:void 0)(i),constant:t=>N(e=>e===t?t:void 0)(i),raw:N(t=>t)(i),object:t=>N(e=>{if(pi(e))return ai(e,t)})(i),array:t=>N(e=>{if(Array.isArray(e))return li(e,t)})(i)}}const K={optional:Zt(!0),required:Zt(!1)};function W(i,t){const e=K.required.object(t)(i);return e.succeeded?e.value:void 0}function ui(i){console.warn([`Missing '${i.key}' of ${i.target} in ${i.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function ci(i){return i&&i.parentElement&&i.parentElement.removeChild(i),null}class Tt{constructor(t){this.value_=t}static create(t){return[new Tt(t),(e,n)=>{t.setRawValue(e,n)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const di=m("");function Qt(i,t){return ht(i,di(void 0,t))}class U extends g{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Tt.create(O(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,n,s;const r=t??{};return new U(g.createCore({disabled:(e=r.disabled)!==null&&e!==void 0?e:!1,disposed:!1,hidden:(n=r.hidden)!==null&&n!==void 0?n:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){B(this.globalDisabled_,Qt(t,"disabled")),Y(this,"hidden",Qt(t,"hidden"))}bindDisabled(t){B(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){B(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}getGlobalDisabled_(){const t=this.get("parent");return(t?t.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const n=t.previousRawValue;n==null||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function hi(){return["veryfirst","first","last","verylast"]}const te=m(""),ee={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class ie{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{hi().forEach(n=>{e.classList.remove(te(void 0,ee[n]))}),this.blade.get("positions").forEach(n=>{e.classList.add(te(void 0,ee[n]))})}),this.viewProps.handleDispose(()=>{ci(e)})}get parent(){return this.parent_}set parent(t){if(this.parent_=t,!("parent"in this.viewProps.valMap_)){ui({key:"parent",target:U.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const P="http://www.w3.org/2000/svg";function vt(i){i.offsetHeight}function vi(i,t){const e=i.style.transition;i.style.transition="none",t(),i.style.transition=e}function ne(i){return i.ontouchstart!==void 0}function bi(i){for(;i.childNodes.length>0;)i.removeChild(i.childNodes[0])}function mi(i){return i.relatedTarget?i.relatedTarget:"explicitOriginalTarget"in i?i.explicitOriginalTarget:null}const st=m("lbl");function gi(i,t){const e=i.createDocumentFragment();return t.split(`
`).map(s=>i.createTextNode(s)).forEach((s,r)=>{r>0&&e.appendChild(i.createElement("br")),e.appendChild(s)}),e}class se{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(st()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(st("l")),Y(e.props,"label",r=>{c(r)?this.element.classList.add(st(void 0,"nol")):(this.element.classList.remove(st(void 0,"nol")),bi(n),n.appendChild(gi(t,r)))}),this.element.appendChild(n),this.labelElement=n;const s=t.createElement("div");s.classList.add(st("v")),this.element.appendChild(s),this.valueElement=s}}class bt extends ie{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new se(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class _i extends ie{constructor(t){super(t),this.value=t.value}}class Mt extends g{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=g.createCore(e);return new Mt(n)}get styleExpanded(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!c(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const n=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};Y(this,"expanded",n),Y(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function fi(i){return Mt.create(i)}function wi(i,t){let e=0;return vi(t,()=>{i.set("expandedHeight",null),i.set("temporaryExpanded",!0),vt(t),e=t.clientHeight,i.set("temporaryExpanded",null),vt(t)}),e}function re(i,t){t.style.height=i.styleHeight}function xi(i,t){i.value("expanded").emitter.on("beforechange",()=>{i.set("completed",!1),c(i.get("expandedHeight"))&&i.set("expandedHeight",wi(i,t)),i.set("shouldFixHeight",!0),vt(t)}),i.emitter.on("change",()=>{re(i,t)}),re(i,t),t.addEventListener("transitionend",e=>{e.propertyName==="height"&&i.cleanUpTransition()})}class oe{constructor(t,e){const n=m(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}}class mt extends _i{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new se(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class yi{constructor(){this.disabled=!1,this.emitter=new S}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Ci{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new S,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class ae{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((e,n)=>n.constrain(e),t)}}function gt(i,t){if(i instanceof t)return i;if(i instanceof ae){const e=i.constraints.reduce((n,s)=>n||(s instanceof t?s:null),null);if(e)return e}return null}class le{constructor(t){this.values=g.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(t,n),e)}}class Dt{constructor(t){this.values=g.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),n=this.values.get("min");let s=t;return c(n)||(s=Math.max(s,n)),c(e)||(s=Math.min(s,e)),s}}class _t{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step,n=Math.round((t-e)/this.step);return e+n*this.step}}const pe=m("pop");class Ei{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pe()),e.viewProps.bindClassModifiers(this.element),B(e.shows,ht(this.element,pe(void 0,"v")))}}class Pi{constructor(t,e){this.shows=O(!1),this.viewProps=e.viewProps,this.view=new Ei(t,{shows:this.shows,viewProps:this.viewProps})}}const ue=m("txt");class ki{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ue()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const n=t.createElement("input");n.classList.add(ue("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Vi{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ki(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const n=t.currentTarget.value,s=this.parser_(n);c(s)||(this.value.rawValue=s),this.view.refresh()}}function zi(i){return i==="false"?!1:!!i}class Ti{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const Mi={"**":(i,t)=>Math.pow(i,t),"*":(i,t)=>i*t,"/":(i,t)=>i/t,"%":(i,t)=>i%t,"+":(i,t)=>i+t,"-":(i,t)=>i-t,"<<":(i,t)=>i<<t,">>":(i,t)=>i>>t,">>>":(i,t)=>i>>>t,"&":(i,t)=>i&t,"^":(i,t)=>i^t,"|":(i,t)=>i|t};class Di{constructor(t,e,n){this.left=e,this.operator=t,this.right=n}evaluate(){const t=Mi[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Li={"+":i=>i,"-":i=>-i,"~":i=>~i};class Si{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=Li[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Lt(i){return(t,e)=>{for(let n=0;n<i.length;n++){const s=i[n](t,e);if(s!=="")return s}return""}}function rt(i,t){var e;const n=i.substr(t).match(/^\s+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}function Oi(i,t){const e=i.substr(t,1);return e.match(/^[1-9]$/)?e:""}function ot(i,t){var e;const n=i.substr(t).match(/^[0-9]+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}function Ri(i,t){const e=ot(i,t);if(e!=="")return e;const n=i.substr(t,1);if(t+=1,n!=="-"&&n!=="+")return"";const s=ot(i,t);return s===""?"":n+s}function St(i,t){const e=i.substr(t,1);if(t+=1,e.toLowerCase()!=="e")return"";const n=Ri(i,t);return n===""?"":e+n}function ce(i,t){const e=i.substr(t,1);if(e==="0")return e;const n=Oi(i,t);return t+=n.length,n===""?"":n+ot(i,t)}function Ai(i,t){const e=ce(i,t);if(t+=e.length,e==="")return"";const n=i.substr(t,1);if(t+=n.length,n!==".")return"";const s=ot(i,t);return t+=s.length,e+n+s+St(i,t)}function Bi(i,t){const e=i.substr(t,1);if(t+=e.length,e!==".")return"";const n=ot(i,t);return t+=n.length,n===""?"":e+n+St(i,t)}function Ni(i,t){const e=ce(i,t);return t+=e.length,e===""?"":e+St(i,t)}const ji=Lt([Ai,Bi,Ni]);function Ii(i,t){var e;const n=i.substr(t).match(/^[01]+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}function $i(i,t){const e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0b")return"";const n=Ii(i,t);return n===""?"":e+n}function Gi(i,t){var e;const n=i.substr(t).match(/^[0-7]+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}function Fi(i,t){const e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0o")return"";const n=Gi(i,t);return n===""?"":e+n}function Ki(i,t){var e;const n=i.substr(t).match(/^[0-9a-f]+/i);return(e=n&&n[0])!==null&&e!==void 0?e:""}function Ui(i,t){const e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0x")return"";const n=Ki(i,t);return n===""?"":e+n}const qi=Lt([$i,Fi,Ui]),Hi=Lt([qi,ji]);function Xi(i,t){const e=Hi(i,t);return t+=e.length,e===""?null:{evaluable:new Ti(e),cursor:t}}function Yi(i,t){const e=i.substr(t,1);if(t+=e.length,e!=="(")return null;const n=he(i,t);if(!n)return null;t=n.cursor,t+=rt(i,t).length;const s=i.substr(t,1);return t+=s.length,s!==")"?null:{evaluable:n.evaluable,cursor:t}}function Wi(i,t){var e;return(e=Xi(i,t))!==null&&e!==void 0?e:Yi(i,t)}function de(i,t){const e=Wi(i,t);if(e)return e;const n=i.substr(t,1);if(t+=n.length,n!=="+"&&n!=="-"&&n!=="~")return null;const s=de(i,t);return s?(t=s.cursor,{cursor:t,evaluable:new Si(n,s.evaluable)}):null}function Ji(i,t,e){e+=rt(t,e).length;const n=i.filter(s=>t.startsWith(s,e))[0];return n?(e+=n.length,e+=rt(t,e).length,{cursor:e,operator:n}):null}function Zi(i,t){return(e,n)=>{const s=i(e,n);if(!s)return null;n=s.cursor;let r=s.evaluable;for(;;){const o=Ji(t,e,n);if(!o)break;n=o.cursor;const a=i(e,n);if(!a)return null;n=a.cursor,r=new Di(o.operator,r,a.evaluable)}return r?{cursor:n,evaluable:r}:null}}const Qi=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((i,t)=>Zi(i,t),de);function he(i,t){return t+=rt(i,t).length,Qi(i,t)}function tn(i){const t=he(i,0);return!t||t.cursor+rt(i,t.cursor).length!==i.length?null:t.evaluable}function ft(i){var t;const e=tn(i);return(t=e==null?void 0:e.evaluate())!==null&&t!==void 0?t:null}function en(i){if(typeof i=="number")return i;if(typeof i=="string"){const t=ft(i);if(!c(t))return t}return 0}function C(i){return t=>t.toFixed(Math.max(Math.min(i,20),0))}const nn=C(0);function wt(i){return nn(i)+"%"}function sn(i){return String(i)}function ve(i,t){for(;i.length<t;)i.push(void 0)}function rn(i){const t=[];return ve(t,i),O(t)}function on(i){const t=i.indexOf(void 0);return t<0?i:i.slice(0,t)}function an(i,t){const e=[...on(i),t];return e.length>i.length?e.splice(0,e.length-i.length):ve(e,i.length),e}function be({primary:i,secondary:t,forward:e,backward:n}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}i.emitter.on("change",o=>{r(()=>{t.setRawValue(e(i,t),o.options)})}),t.emitter.on("change",o=>{r(()=>{i.setRawValue(n(i,t),o.options)}),r(()=>{t.setRawValue(e(i,t),o.options)})}),r(()=>{t.setRawValue(e(i,t),{forceEmit:!1,last:!0})})}function J(i,t){const e=i*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+e:t.downKey?-e:0}function xt(i){return{altKey:i.altKey,downKey:i.key==="ArrowDown",shiftKey:i.shiftKey,upKey:i.key==="ArrowUp"}}function me(i){return{altKey:i.altKey,downKey:i.key==="ArrowLeft",shiftKey:i.shiftKey,upKey:i.key==="ArrowRight"}}function ln(i){return i==="ArrowUp"||i==="ArrowDown"}function ge(i){return ln(i)||i==="ArrowLeft"||i==="ArrowRight"}function Ot(i,t){var e,n;const s=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:i.pageX-(((e=s&&s.scrollX)!==null&&e!==void 0?e:0)+r.left),y:i.pageY-(((n=s&&s.scrollY)!==null&&n!==void 0?n:0)+r.top)}}class yt{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new S,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),(e=t.currentTarget)===null||e===void 0||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Ot(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Ot(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Ot(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=(e=t.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-s.left,y:n.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function f(i,t,e,n,s){const r=(i-t)/(e-t);return n+r*(s-n)}function _e(i){return String(i.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Z(i,t,e){return Math.min(Math.max(i,t),e)}const V=m("txt");class pn{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(V(),V(void 0,"num")),e.arrayPosition&&this.element.classList.add(V(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(V("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(V()),this.inputElement.classList.add(V("i"));const s=t.createElement("div");s.classList.add(V("k")),this.element.appendChild(s),this.knobElement=s;const r=t.createElementNS(P,"svg");r.classList.add(V("g")),this.knobElement.appendChild(r);const o=t.createElementNS(P,"path");o.classList.add(V("gb")),r.appendChild(o),this.guideBodyElem_=o;const a=t.createElementNS(P,"path");a.classList.add(V("gh")),r.appendChild(a),this.guideHeadElem_=a;const h=t.createElement("div");h.classList.add(m("tt")()),this.knobElement.appendChild(h),this.tooltipElem_=h,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(t.rawValue===null){this.element.classList.remove(V(void 0,"drg"));return}this.element.classList.add(V(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),s=Z(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+s},0 L${n},4 L${n+s},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class un{constructor(t,e){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=(n=e.sliderProps)!==null&&n!==void 0?n:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=O(null),this.view=new pn(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new yt(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,n;const s=(e=this.sliderProps_)===null||e===void 0?void 0:e.get("minValue"),r=(n=this.sliderProps_)===null||n===void 0?void 0:n.get("maxValue");let o=t;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(t){const n=t.currentTarget.value,s=this.parser_(n);c(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(t){const e=J(this.baseStep_,xt(t));e!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){J(this.baseStep_,xt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function Rt(i,t){i.write(t)}function cn(i){const t=i?gt(i,_t):null;return t?t.step:null}function dn(i,t){const e=i&&gt(i,_t);return e?_e(e.step):Math.max(_e(t),2)}function fe(i){const t=cn(i);return t??1}function hn(i,t){var e;const n=i&&gt(i,_t),s=Math.abs((e=n==null?void 0:n.step)!==null&&e!==void 0?e:t);return s===0?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function Ct(i){return[i[0],i[1],i[2]]}function we(i){const t=Z(Math.floor(i),0,255).toString(16);return t.length===1?`0${t}`:t}function vn(i,t="#"){const e=Ct(i.getComponents("rgb")).map(we).join("");return`${t}${e}`}function bn(i,t="#"){const e=i.getComponents("rgb"),n=[e[0],e[1],e[2],e[3]*255].map(we).join("");return`${t}${n}`}function mn(i,t){const e=C(t==="float"?2:0);return`rgb(${Ct(i.getComponents("rgb",t)).map(s=>e(s)).join(", ")})`}function gn(i){return t=>mn(t,i)}function _n(i,t){const e=C(2),n=C(t==="float"?2:0);return`rgba(${i.getComponents("rgb",t).map((r,o)=>(o===3?e:n)(r)).join(", ")})`}function fn(i){return t=>_n(t,i)}function wn(i){const t=[C(0),wt,wt];return`hsl(${Ct(i.getComponents("hsl")).map((n,s)=>t[s](n)).join(", ")})`}function xn(i){const t=[C(0),wt,wt,C(2)];return`hsla(${i.getComponents("hsl").map((n,s)=>t[s](n)).join(", ")})`}function yn(i,t){const e=C(t==="float"?2:0),n=["r","g","b"];return`{${Ct(i.getComponents("rgb",t)).map((r,o)=>`${n[o]}: ${e(r)}`).join(", ")}}`}function Cn(i){return t=>yn(t,i)}function En(i,t){const e=C(2),n=C(t==="float"?2:0),s=["r","g","b","a"];return`{${i.getComponents("rgb",t).map((o,a)=>{const h=a===3?e:n;return`${s[a]}: ${h(o)}`}).join(", ")}}`}function Pn(i){return t=>En(t,i)}[...["int","float"].reduce((i,t)=>[...i,{format:{alpha:!1,mode:"rgb",notation:"func",type:t},stringifier:gn(t)},{format:{alpha:!0,mode:"rgb",notation:"func",type:t},stringifier:fn(t)},{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:Cn(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:Pn(t)}],[])];class kn{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((n,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(n))!==null&&o!==void 0?o:n});return this.asm_.fromComponents(e)}}const xe=m("pndtxt");class Vn{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(xe()),this.textViews.forEach(n=>{const s=t.createElement("div");s.classList.add(xe("a")),s.appendChild(n.element),this.element.appendChild(s)})}}function zn(i,t,e){return new un(i,{arrayPosition:e===0?"fst":e===t.axes.length-1?"lst":"mid",baseStep:t.axes[e].baseStep,parser:t.parser,props:t.axes[e].textProps,value:O(0,{constraint:t.axes[e].constraint}),viewProps:t.viewProps})}class At{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((n,s)=>zn(t,e,s)),this.acs_.forEach((n,s)=>{be({primary:this.value,secondary:n.value,forward:r=>e.assembly.toComponents(r.rawValue)[s],backward:(r,o)=>{const a=e.assembly.toComponents(r.rawValue);return a[s]=o.rawValue,e.assembly.fromComponents(a)}})}),this.view=new Vn(t,{textViews:this.acs_.map(n=>n.view)})}}function Tn(i,t){return"step"in i&&!c(i.step)?new _t(i.step,t):null}function Mn(i){return!c(i.max)&&!c(i.min)?new le({max:i.max,min:i.min}):!c(i.max)||!c(i.min)?new Dt({max:i.max,min:i.min}):null}const Dn={monitor:{defaultInterval:200,defaultLineCount:3}},$=m("grl");class Ln{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add($()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=t.createElementNS(P,"svg");n.classList.add($("g")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const s=t.createElementNS(P,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=t.createElement("div");r.classList.add($("t"),m("tt")()),this.element.appendChild(r),this.tooltipElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.props_.get("minValue"),s=this.props_.get("maxValue"),r=[];this.value.rawValue.forEach((j,Xt)=>{if(j===void 0)return;const is=f(Xt,0,e,0,t.width),ns=f(j,n,s,t.height,0);r.push([is,ns].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){o.classList.remove($("t","a"));return}const h=f(this.cursor_.rawValue,0,e,0,t.width),T=f(a,n,s,t.height,0);o.style.left=`${h}px`,o.style.top=`${T}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains($("t","a"))||(o.classList.add($("t","a"),$("t","in")),vt(o),o.classList.remove($("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Sn{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=O(-1),this.view=new Ln(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!ne(t))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const n=new yt(this.view.element);n.emitter.on("down",this.onGraphPointerDown_),n.emitter.on("move",this.onGraphPointerMove_),n.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(f(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){if(!t.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(f(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class ye{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return(t=this.controller_.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.emitter.on(t,()=>{n(new x(this))}),this}}class On extends x{constructor(t,e,n){super(t),this.cell=e,this.index=n}}class Ce extends u{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new S;const e=this.controller_.valueController;e.cellControllers.forEach((n,s)=>{const r=new ye(n);this.cellToApiMap_.set(n,r),n.emitter.on("click",()=>{const o=s%e.size[0],a=Math.floor(s/e.size[0]);this.emitter_.emit("click",{event:new On(this,r,[o,a])})})})}cell(t,e){const n=this.controller_.valueController,s=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(s)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,s=>{n(s.event)}),this}}class Bt{constructor(t,e){this.size=e.size;const[n,s]=this.size,r=[];for(let o=0;o<s;o++)for(let a=0;a<n;a++){const h=new si(t,{props:g.fromObject(Object.assign({},e.cellConfig(a,o))),viewProps:U.create()});r.push(h)}this.cellCs_=r,this.viewProps=U.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(o=>{o.viewProps.set("disposed",!0)})}),this.view=new oe(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach(o=>{this.view.element.appendChild(o.view.element)})}get cellControllers(){return this.cellCs_}}const Rn={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const t=K,e=W(i,{cells:t.required.function,size:t.required.array(t.required.number),view:t.required.constant("buttongrid"),label:t.optional.string});return e?{params:e}:null},controller(i){return new bt(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:new Bt(i.document,{cellConfig:i.params.cells,size:i.params.size})})},api(i){return!(i.controller instanceof bt)||!(i.controller.valueController instanceof Bt)?null:new Ce(i.controller)}};class Ee extends u{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.controller_.valueController.value.emitter.on(t,s=>{n(new y(this,s.rawValue,void 0,s.options.last))}),this}}function z(i,t,e){return i*(1-e)+t*e}const An=20,Bn=.001,Nt=100;function Nn(i,t){let e=.25,n=.5,s=-1;for(let r=0;r<An;r++){const[o,a]=i.curve(n);if(n+=e*(o<t?1:-1),s=a,e*=.5,Math.abs(t-o)<Bn)break}return s}class G{constructor(t=0,e=0,n=1,s=1){this.cache_=[],this.comps_=[t,e,n,s]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return c(t)||!Array.isArray(t)?!1:typeof t[0]=="number"&&typeof t[1]=="number"&&typeof t[2]=="number"&&typeof t[3]=="number"}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=z(0,this.x1,t),n=z(0,this.y1,t),s=z(this.x1,this.x2,t),r=z(this.y1,this.y2,t),o=z(this.x2,1,t),a=z(this.y2,1,t),h=z(e,s,t),T=z(n,r,t),j=z(s,o,t),Xt=z(r,a,t);return[z(h,j,t),z(T,Xt,t)]}y(t){if(this.cache_.length===0){const e=[];for(let n=0;n<Nt;n++)e.push(Nn(this,f(n,0,Nt-1,0,1)));this.cache_=e}return this.cache_[Math.round(f(Z(t,0,1),0,1,0,Nt-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const jt={toComponents:i=>i.toObject(),fromComponents:i=>new G(...i)};function jn(i){const t=C(2);return`cubic-bezier(${i.toObject().map(n=>t(n)).join(", ")})`}const Pe=[0,.5,.5,1];function In(i){const t=i.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!t)return new G(...Pe);const e=[t[1],t[2],t[3],t[4]].reduce((n,s)=>{if(!n)return null;const r=Number(s);return isNaN(r)?null:[...n,r]},[]);return new G(...e??Pe)}const q=m("cbz");class ke{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(q()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,q(void 0,"expanded")),Y(e.foldable,"completed",ht(this.element,q(void 0,"cpl")));const n=t.createElement("div");n.classList.add(q("h")),this.element.appendChild(n);const s=t.createElement("button");s.classList.add(q("b")),e.viewProps.bindDisabled(s);const r=t.createElementNS(P,"svg");r.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',s.appendChild(r),n.appendChild(s),this.buttonElement=s;const o=t.createElement("div");if(o.classList.add(q("t")),n.appendChild(o),this.textElement=o,e.pickerLayout==="inline"){const a=t.createElement("div");a.classList.add(q("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}const It=m("cbzp");class Ve{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(It()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(It("g")),this.element.appendChild(n),this.graphElement=n;const s=t.createElement("div");s.classList.add(It("t")),this.element.appendChild(s),this.textElement=s}}function ze(i,t){const e=new MutationObserver(s=>{for(const r of s)r.type==="childList"&&r.addedNodes.forEach(o=>{o.contains(o)&&(t(),e.disconnect())})}),n=i.ownerDocument;e.observe(n.body,{attributes:!0,childList:!0,subtree:!0})}const F=m("cbzg");function $n(i,t){return e=>t(i(e))}class Te{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(F()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(F("p")),this.element.appendChild(n),this.previewElement=n;const s=t.createElementNS(P,"svg");s.classList.add(F("g")),this.element.appendChild(s),this.svgElem_=s;const r=t.createElementNS(P,"path");r.classList.add(F("u")),this.svgElem_.appendChild(r),this.guideElem_=r;const o=t.createElementNS(P,"polyline");o.classList.add(F("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach(a=>{a.classList.add(F("h")),this.element.appendChild(a)}),this.vectorElems_=[t.createElementNS(P,"line"),t.createElementNS(P,"line")],this.vectorElems_.forEach(a=>{a.classList.add(F("v")),this.svgElem_.appendChild(a)}),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach((a,h)=>{B(this.sel_,$n(T=>T===h,ht(a,F("h","sel"))))}),ze(this.element,()=>{this.refresh()})}getVertMargin_(t){return t*.25}valueToPosition(t,e){const n=this.element.getBoundingClientRect(),s=n.width,r=n.height,o=this.getVertMargin_(r);return{x:f(t,0,1,0,s),y:f(e,0,1,r-o,o)}}positionToValue(t,e){const n=this.element.getBoundingClientRect(),s=n.width,r=n.height,o=this.getVertMargin_(r);return{x:Z(f(t,0,s,0,1),0,1),y:f(e,r-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(r=>{const o=this.valueToPosition(0,r),a=this.valueToPosition(1,r);return[`M ${o.x},${o.y}`,`L ${a.x},${a.y}`].join(" ")}).join(" "));const t=this.value_.rawValue,e=[];let n=0;for(;;){const r=this.valueToPosition(...t.curve(n));if(e.push([r.x,r.y].join(",")),n>=1)break;n=Math.min(n+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const s=t.toObject();[0,1].forEach(r=>{const o=this.valueToPosition(r,r),a=this.valueToPosition(s[r*2],s[r*2+1]),h=this.vectorElems_[r];h.setAttributeNS(null,"x1",String(o.x)),h.setAttributeNS(null,"y1",String(o.y)),h.setAttributeNS(null,"x2",String(a.x)),h.setAttributeNS(null,"y2",String(a.y));const T=this.handleElems_[r];T.style.left=`${a.x}px`,T.style.top=`${a.y}px`})}onValueChange_(){this.refresh()}}const Me=24,De=400,Le=1e3,Q=m("cbzprv");class Se{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Q()),e.viewProps.bindClassModifiers(this.element);const n=t.createElementNS(P,"svg");n.classList.add(Q("g")),this.element.appendChild(n),this.svgElem_=n;const s=t.createElementNS(P,"path");s.classList.add(Q("t")),this.svgElem_.appendChild(s),this.ticksElem_=s;const r=t.createElement("div");r.classList.add(Q("m")),this.element.appendChild(r),this.markerElem_=r,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),ze(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(Q("m","a")),this.startTime_=new Date().getTime()+De,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(Q("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(Z(t,0,1));this.markerElem_.style.left=`${e*100}%`}refresh(){const t=this.svgElem_.getBoundingClientRect(),e=t.width,n=t.height,s=[],r=this.value_.rawValue;for(let o=0;o<Me;o++){const a=f(o,0,Me-1,0,1),h=f(r.y(a),0,1,0,e);s.push(`M ${h},0 v${n}`)}this.ticksElem_.setAttributeNS(null,"d",s.join(" "))}onTimer_(){if(this.startTime_===null)return;const t=new Date().getTime()-this.startTime_,e=t/Le;this.updateMarker_(e),t>Le+De&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function $t(i,t,e,n){const s=e-i,r=n-t;return Math.sqrt(s*s+r*r)}function Gn(i,t,e,n){const s=$t(i,t,e,n),r=Math.atan2(n-t,e-i),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:i+Math.cos(o)*s,y:t+Math.sin(o)*s}}class Oe{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=O(0),this.viewProps=e.viewProps,this.view=new Te(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new Se(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",s=>{s.stopImmediatePropagation(),s.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const n=new yt(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e,n){const s=this.sel_.rawValue,r=this.value.rawValue.toObject(),o=this.view.positionToValue(t.x,t.y),a=e?Gn(s,s,o.x,o.y):o;r[s*2]=a.x,r[s*2+1]=a.y,this.value.setRawValue(new G(...r),n)}onPointerDown_(t){const e=t.data;if(!e.point)return;const n=this.value.rawValue,s=this.view.valueToPosition(n.x1,n.y1),r=$t(e.point.x,e.point.y,s.x,s.y),o=this.view.valueToPosition(n.x2,n.y2),a=$t(e.point.x,e.point.y,o.x,o.y);this.sel_.rawValue=r<=a?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(t){ge(t.key)&&t.preventDefault();const e=this.sel_.rawValue,n=this.value.rawValue.toObject();n[e*2]+=J(this.baseStep_,me(t)),n[e*2+1]+=J(this.baseStep_,xt(t)),this.value.setRawValue(new G(...n),{forceEmit:!1,last:!1})}onKeyUp_(t){ge(t.key)&&t.preventDefault();const e=J(this.baseStep_,me(t)),n=J(this.baseStep_,xt(t));e===0&&n===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Re{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Ve(t,{viewProps:this.viewProps}),this.gc_=new Oe(t,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const n=Object.assign(Object.assign({},e.axis),{constraint:new Dt({max:1,min:0})}),s=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new At(t,{assembly:jt,axes:[n,s,n,s],parser:ft,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(t=>t.inputElement)]}refresh(){this.gc_.refresh()}}class Gt{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=fi(e.expanded),this.view=new ke(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Vi(t,{parser:In,props:g.fromObject({formatter:jn}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=e.pickerLayout==="popup"?new Pi(t,{viewProps:this.viewProps}):null;const n=new Re(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach(s=>{s.addEventListener("blur",this.onPopupChildBlur_),s.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),B(this.popC_.shows,s=>{s&&n.refresh()}),be({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:s=>s.rawValue,backward:(s,r)=>r.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),xi(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;(!e||!this.popC_.view.element.contains(e))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=mi(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!ne(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_&&t.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function Fn(){return new kn({assembly:jt,components:[0,1,2,3].map(i=>i%2===0?new Dt({min:0,max:1}):void 0)})}const Kn={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const t=K,e=W(i,{value:t.required.array(t.required.number),view:t.required.constant("cubicbezier"),expanded:t.optional.boolean,label:t.optional.string,picker:t.optional.custom(n=>n==="inline"||n==="popup"?n:void 0)});return e?{params:e}:null},controller(i){var t,e;const n=new G(...i.params.value),s=O(n,{constraint:Fn(),equals:G.equals}),r=new Gt(i.document,{axis:{baseStep:.1,textProps:g.fromObject({draggingScale:.01,formatter:C(2)})},expanded:(t=i.params.expanded)!==null&&t!==void 0?t:!1,pickerLayout:(e=i.params.picker)!==null&&e!==void 0?e:"popup",value:s,viewProps:i.viewProps});return new mt(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:r})},api(i){return!(i.controller instanceof mt)||!(i.controller.valueController instanceof Gt)?null:new Ee(i.controller)}};class Ae extends u{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Be=20;class Ne{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(this.timestamps_.length===0)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=Be)return;const t=this.timestamps_.length-Be;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach(n=>{n.frameCount-=e}),this.frameCount_-=e}end(t){if(this.start_===null)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const at=m("fps");class je{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(at()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(at("g")),this.element.appendChild(this.graphElement);const n=t.createElement("div");n.classList.add(at("l")),this.element.appendChild(n);const s=t.createElement("span");s.classList.add(at("v")),s.textContent="--",n.appendChild(s),this.valueElement=s;const r=t.createElement("span");r.classList.add(at("u")),r.textContent="FPS",n.appendChild(r)}}class Ft{constructor(t,e){this.stopwatch_=new Ne,this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new je(t,{viewProps:this.viewProps}),this.graphC_=new Sn(t,{formatter:C(0),lineCount:e.lineCount,props:g.fromObject({maxValue:e.maxValue,minValue:e.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()})}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.stopwatch_.fps;if(t!==null){const e=this.value_.rawValue;this.value_.rawValue=an(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}function Un(i,t){return t===0?new yi:new Ci(i,t??Dn.monitor.defaultInterval)}const qn={id:"fpsgraph",type:"blade",accept(i){const t=K,e=W(i,{view:t.required.constant("fpsgraph"),interval:t.optional.number,label:t.optional.string,lineCount:t.optional.number,max:t.optional.number,min:t.optional.number});return e?{params:e}:null},controller(i){var t,e,n,s;const r=(t=i.params.interval)!==null&&t!==void 0?t:500;return new bt(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:new Ft(i.document,{lineCount:(e=i.params.lineCount)!==null&&e!==void 0?e:2,maxValue:(n=i.params.max)!==null&&n!==void 0?n:90,minValue:(s=i.params.min)!==null&&s!==void 0?s:0,ticker:Un(i.document,r),value:rn(80),viewProps:i.viewProps})})},api(i){return!(i.controller instanceof bt)||!(i.controller.valueController instanceof Ft)?null:new Ae(i.controller)}};class k{constructor(t,e){this.min=t,this.max=e}static isObject(t){if(typeof t!="object"||t===null)return!1;const e=t.min,n=t.max;return!(typeof e!="number"||typeof n!="number")}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Kt={fromComponents:i=>new k(i[0],i[1]),toComponents:i=>[i.min,i.max]};class Ut{constructor(t){this.edge=t}constrain(t){var e,n,s,r,o,a,h,T;if(t.min<=t.max)return new k((n=(e=this.edge)===null||e===void 0?void 0:e.constrain(t.min))!==null&&n!==void 0?n:t.min,(r=(s=this.edge)===null||s===void 0?void 0:s.constrain(t.max))!==null&&r!==void 0?r:t.max);const j=(t.min+t.max)/2;return new k((a=(o=this.edge)===null||o===void 0?void 0:o.constrain(j))!==null&&a!==void 0?a:j,(T=(h=this.edge)===null||h===void 0?void 0:h.constrain(j))!==null&&T!==void 0?T:j)}}const qt=m("rsltxt");class Ie{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(qt());const n=t.createElement("div");n.classList.add(qt("s")),n.appendChild(this.sliderView_.element),this.element.appendChild(n);const s=t.createElement("div");s.classList.add(qt("t")),s.appendChild(this.textView_.element),this.element.appendChild(s)}}const H=m("rsl");class $e{constructor(t,e){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=e.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=t.createElement("div"),this.element.classList.add(H()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_);const n=t.createElement("div");n.classList.add(H("t")),this.element.appendChild(n),this.trackElement=n;const s=t.createElement("div");s.classList.add(H("b")),n.appendChild(s),this.barElement=s;const r=["min","max"].map(o=>{const a=t.createElement("div");return a.classList.add(H("k"),H("k",o)),n.appendChild(a),a});this.knobElements=[r[0],r[1]],this.update_()}valueToX_(t){const e=this.sliderProps_.get("minValue"),n=this.sliderProps_.get("maxValue");return Z(f(t,e,n,0,1),0,1)*100}update_(){const t=this.value_.rawValue;t.length===0?this.element.classList.add(H(void 0,"zero")):this.element.classList.remove(H(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=`${100-e[1]}%`,this.knobElements.forEach((n,s)=>{n.style.left=`${e[s]}%`})}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Ge{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=e.sliderProps,this.viewProps=e.viewProps,this.value=e.value,this.view=new $e(t,{sliderProps:this.sliderProps,value:this.value,viewProps:e.viewProps});const n=new yt(this.view.trackElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){if(!t.point)return null;const e=(t.point.x+this.ofs_())/t.bounds.width,n=this.sliderProps.get("minValue"),s=this.sliderProps.get("maxValue");return f(e,0,1,n,s)}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,n=this.value.rawValue,s=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue"),o=f(n.min,s,r,0,1),a=f(n.max,s,r,0,1);Math.abs(a-e)<=.025?this.grabbing_="max":Math.abs(o-e)<=.025?this.grabbing_="min":e>=o&&e<=a?(this.grabbing_="length",this.grabOffset_=f(e-o,0,1,0,r-s)):e<o?(this.grabbing_="min",this.onPointerMove_(t)):e>a&&(this.grabbing_="max",this.onPointerMove_(t))}applyPointToValue_(t,e){const n=this.valueFromData_(t);if(n===null)return;const s=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue");if(this.grabbing_==="min")this.value.setRawValue(new k(n,this.value.rawValue.max),e);else if(this.grabbing_==="max")this.value.setRawValue(new k(this.value.rawValue.min,n),e);else if(this.grabbing_==="length"){const o=this.value.rawValue.length;let a=n-this.grabOffset_,h=a+o;a<s?(a=s,h=s+o):h>r&&(a=r-o,h=r),this.value.setRawValue(new k(a,h),e)}}onPointerMove_(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Fe{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new Ge(t,e);const n={baseStep:e.baseStep,constraint:e.constraint,textProps:g.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new At(t,{assembly:Kt,axes:[n,n],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new Ie(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function Hn(i){return k.isObject(i)?new k(i.min,i.max):new k(0,0)}function Xn(i,t){i.writeProperty("max",t.max),i.writeProperty("min",t.min)}function Yn(i){const t=[],e=Mn(i);e&&t.push(e);const n=Tn(i);return n&&t.push(n),new Ut(new ae(t))}const Wn={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(i,t)=>{if(!k.isObject(i))return null;const e=K,n=W(t,{format:e.optional.function,max:e.optional.number,min:e.optional.number,step:e.optional.number});return n?{initialValue:new k(i.min,i.max),params:n}:null},binding:{reader:i=>Hn,constraint:i=>Yn(i.params),equals:k.equals,writer:i=>Xn},controller(i){var t;const e=i.value,n=i.constraint;if(!(n instanceof Ut))throw D.shouldNeverHappen();const s=(e.rawValue.min+e.rawValue.max)/2,r=(t=i.params.format)!==null&&t!==void 0?t:C(dn(n.edge,s)),o=n.edge&&gt(n.edge,le);if(o)return new Fe(i.document,{baseStep:fe(n.edge),constraint:n.edge,draggingScale:hn(n.edge,s),formatter:r,parser:ft,sliderProps:new g({maxValue:o.values.value("max"),minValue:o.values.value("min")}),value:e,viewProps:i.viewProps});const a={baseStep:fe(n.edge),constraint:n.edge,textProps:g.fromObject({draggingScale:s,formatter:r})};return new At(i.document,{assembly:Kt,axes:[a,a],parser:ft,value:e,viewProps:i.viewProps})}};class Ke{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return(t=this.controller_.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.props.set("title",t)}}class Ue extends y{constructor(t,e,n,s,r){super(t,s,r),this.cell=e,this.index=n}}class qe extends u{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach(n=>{const s=new Ke(n);this.cellToApiMap_.set(n,s)})}get value(){return this.controller_.value}cell(t,e){const n=this.controller_.valueController,s=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(s)}on(t,e){const n=e.bind(this);this.controller_.value.emitter.on(t,s=>{const r=this.controller_.valueController,o=r.findCellByValue(s.rawValue);if(!o)return;const a=this.cellToApiMap_.get(o);if(!a)return;const h=r.cellControllers.indexOf(o);n(new Ue(this,a,[h%r.size[0],Math.floor(h/r.size[0])],s.rawValue,void 0))})}}const lt=m("rad");class He{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(lt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("label");n.classList.add(lt("l")),this.element.appendChild(n);const s=t.createElement("input");s.classList.add(lt("i")),s.name=e.name,s.type="radio",e.viewProps.bindDisabled(s),n.appendChild(s),this.inputElement=s;const r=t.createElement("div");r.classList.add(lt("b")),n.appendChild(r);const o=t.createElement("div");o.classList.add(lt("t")),r.appendChild(o),Y(e.props,"title",a=>{o.textContent=a})}}class Xe{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new He(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class Et{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[n,s]=this.size;for(let r=0;r<s;r++)for(let o=0;o<n;o++){const a=new Xe(t,{name:e.groupName,props:g.fromObject(Object.assign({},e.cellConfig(o,r))),viewProps:U.create()});this.cellCs_.push(a),this.cellValues_.push(e.cellConfig(o,r).value)}this.value=e.value,B(this.value,r=>{const o=this.findCellByValue(r);o&&(o.view.inputElement.checked=!0)}),this.viewProps=U.create(),this.view=new oe(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach(r=>{r.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(r.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex(n=>n===t);return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,n=this.cellCs_.findIndex(s=>s.view.inputElement===e);n<0||(this.value.rawValue=this.cellValues_[n])}}const Jn=function(){return{id:"radiogrid",type:"blade",accept(i){const t=K,e=W(i,{cells:t.required.function,groupName:t.required.string,size:t.required.array(t.required.number),value:t.required.raw,view:t.required.constant("radiogrid"),label:t.optional.string});return e?{params:e}:null},controller(i){return new mt(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:new Et(i.document,{groupName:i.params.groupName,cellConfig:i.params.cells,size:i.params.size,value:O(i.params.value)})})},api(i){return!(i.controller instanceof mt)||!(i.controller.valueController instanceof Et)?null:new qe(i.controller)}}}();function Ht(i){return{id:"input-radiogrid",type:"input",accept(t,e){if(!i.isType(t))return null;const n=K,s=W(e,{cells:n.required.function,groupName:n.required.string,size:n.required.array(n.required.number),view:n.required.constant("radiogrid")});return s?{initialValue:t,params:s}:null},binding:i.binding,controller:t=>new Et(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}}const Zn=Ht({isType:i=>typeof i=="number",binding:{reader:i=>en,writer:i=>Rt}}),Qn=Ht({isType:i=>typeof i=="string",binding:{reader:i=>sn,writer:i=>Rt}}),ts=Ht({isType:i=>typeof i=="boolean",binding:{reader:i=>zi,writer:i=>Rt}}),es=[Rn,Kn,qn,Wn,Jn,ts,Zn,Qn];l.ButtonCellApi=ye,l.ButtonGridApi=Ce,l.ButtonGridController=Bt,l.CubicBezier=G,l.CubicBezierApi=Ee,l.CubicBezierAssembly=jt,l.CubicBezierController=Gt,l.CubicBezierGraphController=Oe,l.CubicBezierGraphView=Te,l.CubicBezierPickerController=Re,l.CubicBezierPickerView=Ve,l.CubicBezierPreviewView=Se,l.CubicBezierView=ke,l.FpsGraphBladeApi=Ae,l.FpsGraphController=Ft,l.FpsView=je,l.Fpswatch=Ne,l.Interval=k,l.IntervalAssembly=Kt,l.IntervalConstraint=Ut,l.RadioCellApi=Ke,l.RadioController=Xe,l.RadioGridApi=qe,l.RadioGridController=Et,l.RadioView=He,l.RangeSliderController=Ge,l.RangeSliderTextController=Fe,l.RangeSliderTextView=Ie,l.RangeSliderView=$e,l.TpRadioGridChangeEvent=Ue,l.plugins=es,Object.defineProperty(l,"__esModule",{value:!0})})})(ys,ct);const Cs=as(ct),Es=us({__proto__:null,default:Cs},[ct]),pt=Object.fromEntries(Object.entries(Object.assign({"./functions/CameraDebug.js":hs,"./functions/GameDebug.js":ms,"./functions/SceneDebug.js":_s,"./functions/StatsDebug.js":xs})).map(([d,p])=>[d.split("/").pop().split(".")[0].replace("Debug",""),p]));var A,X,it,L,dt;class Ts{constructor(){tt(this,A,void 0);tt(this,X,void 0);tt(this,it,void 0);tt(this,L,void 0);tt(this,dt,void 0);nt.register(this),et(this,A,new Map),et(this,X,new Map)}async load(){et(this,dt,await Je(()=>import("./tweakpane-6a89d895.js").then(p=>p.t),["assets/tweakpane-6a89d895.js","assets/_commonjsHelpers-725317a4.js"]))}init(){var l;et(this,L,new(_(this,dt)).Pane({title:ls})),_(this,L).registerPlugin(Es),et(this,it,_(this,L).addTab({pages:ps.map(u=>({title:u}))}).pages),_(this,L).addSeparator(),_(this,L).addButton({title:"Refresh"}).on("click",()=>_(this,L).refresh());const p=(l=M.debug)==null?void 0:l.urlParams.getNumber("tab");p&&_(this,it)[p].controller_.onItemClick_()}addToParent(p,l,u){_(this,A).get(u)||_(this,A).set(u,[]),_(this,A).get(u).push(p),_(this,X).get(u)&&pt[l].createPane(_(this,X).get(u),p,l)}add(p,l,u=0,x=""){var y,w,c,E;if(pt[l]){const D=(w=(y=pt[l]).createPane)==null?void 0:w.call(y,_(this,it)[u],p,x||l);(E=(c=pt[l]).debug)==null||E.call(c,p),_(this,X).set(l,D),_(this,A).get(l)&&(_(this,A).get(l).forEach(S=>pt[l](D,S,l)),_(this,A).delete(l))}else console.warn("No debug mapping found for",l)}onKeyDown(p){p==="h"&&(_(this,L).hidden=!_(this,L).hidden)}}A=new WeakMap,X=new WeakMap,it=new WeakMap,L=new WeakMap,dt=new WeakMap;export{Ts as Mapping};
