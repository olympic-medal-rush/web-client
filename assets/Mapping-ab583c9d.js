var Jt=(c,a,p)=>{if(!a.has(c))throw TypeError("Cannot "+p)};var w=(c,a,p)=>(Jt(c,a,"read from private field"),p?p.call(c):a.get(c)),ne=(c,a,p)=>{if(a.has(c))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(c):a.set(c,p)},se=(c,a,p,u)=>(Jt(c,a,"write to private field"),u?u.call(c,p):a.set(c,p),p);import{s as N,E as U,d as g,x as ei,y as ti,T as Me,z as v,D as he,A as Qe,M as W,B as ls,C as ps}from"./index-7da68565.js";import{C as re,P as us,a as ds}from"./debugConfig-5b4f09a7.js";import{c as cs,g as hs}from"./_commonjsHelpers-725317a4.js";function vs(c,a){for(var p=0;p<a.length;p++){const u=a[p];if(typeof u!="string"&&!Array.isArray(u)){for(const _ in u)if(_!=="default"&&!(_ in c)){const f=Object.getOwnPropertyDescriptor(u,_);f&&Object.defineProperty(c,_,f.get?f:{enumerable:!0,get:()=>u[_]})}}}return Object.freeze(Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}))}function ms(c,a,p){const u=c.addFolder({title:p,expanded:!1});let _=0;const f=async()=>{const x=g.$wrapper;if(a.orbitControls)x.style.pointerEvents="",a.orbitControls.dispose(),a.orbitControls=null,a.position.set(0,0,10),a.far=_,a.updateProjectionMatrix();else{x.style.pointerEvents="all";const P=await ei(()=>import("./OrbitControls-1ec969e0.js"),["assets/OrbitControls-1ec969e0.js","assets/index-7da68565.js","assets/index-385e56d5.css"]);a.orbitControls=new P.OrbitControls(a,x),a.orbitControls.enableDamping=!0,a.orbitControls.dampingFactor=.15,a.orbitControls.enableZoom=!0,a.orbitControls.update(),a.position.z+=10,a.orbitControls.target=new ti(Me.size*.5,0,Me.size*.5),_=a.far,a.far=200,a.updateProjectionMatrix()}},h={Orbit:!1};return new URLSearchParams(location.search).has("orbit")&&(f(),h.Orbit=!0),N.on(U.TICK,()=>{var x;return(x=a.orbitControls)==null?void 0:x.update()}),u.addInput(h,"Orbit",{title:"OrbitControls"}).on("change",f),u.addInput(a,"fov"),u.addInput(a,"near"),u.addInput(a,"far"),u.on("change",()=>a.updateProjectionMatrix()),u}function bs(c){N.on(U.KEY_DOWN,a=>{a===" "&&(c.focusPlayer=!c.focusPlayer)})}const gs=Object.freeze(Object.defineProperty({__proto__:null,createPane:ms,debug:bs},Symbol.toStringTag,{value:"Module"}));let Je=0,R,ze,Te=null,G=null;const Qt=Object.entries(ls),m=Qe.data.length-1;function _s(c,a,p){const u=c.addFolder({title:p,expanded:!0});u.addButton({title:"Create Team"}).on("click",()=>{const h=Math.round(Math.random()*(Qt.length-1)),d=Qt[h];g.game.createTeam({iso:d[0],position:{x:v(0,m),y:v(0,m)}}),console.log("Create Team",d[0])}),u.addButton({title:"Spawn Medals"}).on("click",()=>{const h=[{id:(Je++).toString(),type:0,position:{x:v(0,m),y:v(0,m)}},{id:(Je++).toString(),type:1,position:{x:v(0,m),y:v(0,m)}},{id:(Je++).toString(),type:2,position:{x:v(0,m),y:v(0,m)}}];g.game.addMedals({medals:h})}),u.addButton({title:"Collect Medal"}).on("click",()=>{const h=[...g.game.medals.values()];if(h.length>0){const d={iso:G,medal_id:h[Math.floor(Math.random()*h.length)].id};g.game.medalCollect(d)}else alert("There are no more medals")}),u.addSeparator(),N.on(U.CREATE_TEAM,()=>f()),N.on(U.STATE_READY,()=>f()),G=g.debug.urlParams.getString("team")||"FRA";function f(){R==null||R.dispose(),ze==null||ze.dispose(),Te==null||Te.dispose();const h=[...g.game.teams.keys()].map(d=>({text:d,value:d}));R=u.addBlade({view:"list",label:"Team",options:h,value:G}).on("change",d=>{g.webgl.camera.playerPosition=g.webgl.players.get(g.game.teams.get(d.value)).position,g.webgl.camera.focusPlayer=!0,G=d.value}),ze=u.addBlade({view:"buttongrid",size:[3,3],cells:(d,x)=>({title:[["-","UP","-"],["LEFT","-","RIGHT"],["-","DOWN","-"]][x][d]}),label:"Move Team"}).on("click",d=>{R&&d.cell.title!=="-"&&g.game.voteResults({iso:R.value,direction:he[d.cell.title.toLowerCase()],next_vote_id:0})}),Te=u.addButton({title:"Get Zone"}).on("click",()=>{if(!(R!=null&&R.value))return;const d=g.game.teams.get(R.value).position;console.log(Qe.mapping[Qe.data[d.y][d.x]],d.x,d.y)})}return u}function fs(c){if(g.debug.urlParams.has("noServer")){N.on(U.KEY_DOWN,p=>{switch(p){case"ArrowUp":g.game.voteResults({iso:G,direction:he.up,next_vote_id:0});break;case"ArrowDown":g.game.voteResults({iso:G,direction:he.down,next_vote_id:0});break;case"ArrowLeft":g.game.voteResults({iso:G,direction:he.left,next_vote_id:0});break;case"ArrowRight":g.game.voteResults({iso:G,direction:he.right,next_vote_id:0});break}}),g.game.setState({user_id:"userId",countries_states:{BZH:{iso:"BZH",position:{x:v(0,m),y:v(0,m)},medals:{0:42,1:2,2:15}},ESP:{iso:"ESP",position:{x:v(0,m),y:v(0,m)},medals:{0:1,1:2,2:3}},FRA:{iso:"FRA",position:{x:v(0,m),y:v(0,m)},medals:{0:7,1:4,2:12}},DEU:{iso:"DEU",position:{x:v(0,m),y:v(0,m)},medals:{0:10,1:2,2:5}},ITA:{iso:"ITA",position:{x:v(0,m),y:v(0,m)},medals:{0:9,1:0,2:7}},USA:{iso:"USA",position:{x:v(0,m),y:v(0,m)},medals:{0:12,1:4,2:3}}},medals:[{id:(-7).toString(),type:W.bronze,position:{x:v(0,m),y:v(0,m)}},{id:(-6).toString(),type:W.bronze,position:{x:v(0,m),y:v(0,m)}},{id:(-5).toString(),type:W.bronze,position:{x:v(0,m),y:v(0,m)}},{id:(-4).toString(),type:W.bronze,position:{x:v(0,m),y:v(0,m)}},{id:(-3).toString(),type:W.gold,position:{x:v(0,m),y:v(0,m)}},{id:(-2).toString(),type:W.gold,position:{x:v(0,m),y:v(0,m)}},{id:(-1).toString(),type:W.silver,position:{x:v(0,m),y:v(0,m)}}]});const a=g.debug.urlParams.getString("team")||"FRA";g.game.userJoin({iso:a,vote_id:1,vote_progress:.5,votes:{down:25,left:25,right:25,up:25},player_count:10})}}const ws=Object.freeze(Object.defineProperty({__proto__:null,createPane:_s,debug:fs},Symbol.toStringTag,{value:"Module"}));function xs(c,a,p){const u=c.addFolder({title:p,expanded:!1});u.addInput(a,"position");const _=u.addFolder({title:"Flame",expanded:!1});_.addInput(a.flame.material.uniforms.uRadius,"value",{min:0,max:.6,label:"uRadius"}),_.addInput(a.flame.material.uniforms.uGlobalSpead,"value",{min:0,max:5,label:"uGlobalSpead"}),_.addInput(a.flame.material.uniforms.uElevation,"value",{min:.5,max:1.5,label:"uElevation"}),_.addInput(new re(a.flame.material.uniforms.uColor,"value"),"value",{label:"uColor"});const f=u.addFolder({title:"Face",expanded:!1}),h=a.model.getObjectByName("face").material;f.addInput(h.uniforms.uRoughness,"value",{min:0,max:1,step:.001,label:"uRoughness"}),f.addInput(h.uniforms.uMetalness,"value",{min:0,max:1,step:.001,label:"uMetalness"}),f.addInput(h.uniforms.uEnvMapIntensity,"value",{min:0,max:1,step:.001,label:"uEnvMapIntensity"}),f.addInput(new re(h.uniforms.uColor,"value"),"value",{label:"uColor"});const d=u.addFolder({title:"Body",expanded:!1}),x=a.model.getObjectByName("body").material;d.addInput(new re(x.uniforms.uColor1,"value"),"value",{label:"uColor1"}),d.addInput(new re(x.uniforms.uColor2,"value"),"value",{label:"uColor2"}),d.addInput(new re(x.uniforms.uColor3,"value"),"value",{label:"uColor3"});const P=u.addFolder({title:"Gold",expanded:!1}),k=a.model.getObjectByName("gold").material;return P.addInput(k.uniforms.uRoughness,"value",{min:0,max:1,step:.001,label:"uRoughness"}),P.addInput(k.uniforms.uMetalness,"value",{min:0,max:1,step:.001,label:"uMetalness"}),P.addInput(k.uniforms.uEnvMapIntensity,"value",{min:0,max:1,step:.001,label:"uEnvMapIntensity"}),P.addInput(new re(k.uniforms.uColor,"value"),"value",{label:"uColor"}),u}function ys(c){}const Cs=Object.freeze(Object.defineProperty({__proto__:null,createPane:xs,debug:ys},Symbol.toStringTag,{value:"Module"}));function Es(c,a,p){const u=c.addFolder({title:p,expanded:!1});return u.addInput(a.uniforms.uEmissiveIntensity,"value",{min:0,max:10,label:"uEmissiveIntensity"}),u}function Ps(c){}const ks=Object.freeze(Object.defineProperty({__proto__:null,createPane:Es,debug:Ps},Symbol.toStringTag,{value:"Module"}));function Vs(c){}function zs(c,a,p){const u=c.addFolder({title:p,expanded:!0});u.addInput(a.shadowCamera,"position",{label:"LightPosition"}).on("change",()=>a.shadowCamera.lookAt(new ti(Me.size*.5,0,Me.size*.5)));const _=new ps(a.shadowCamera);_.visible=!1,a.add(_),u.addInput(_,"visible",{label:"CamHelper"});const f={value:!1},h=document.createElement("canvas");h.width=a.dynamicShadowRenderTarget.width,h.height=a.dynamicShadowRenderTarget.height,h.style.width="512px",h.style.height="512px",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.transformOrigin="0 0",h.style.backgroundColor="#000";const d=h.getContext("2d"),x=()=>{const k=new Uint8Array(4*h.width*h.height);g.webgl.renderer.readRenderTargetPixels(a.dynamicShadowRenderTarget,0,0,h.width,h.height,k);const me=new ImageData(h.width,h.height);me.data.set(k),d.putImageData(me,0,0)},P=()=>{f.value?(document.body.appendChild(h),N.on(U.TICK,x)):(document.body.removeChild(h),N.off(U.TICK,x))};return u.addInput(f,"value",{label:"ShadowCanvas"}).on("change",P),u}const Ts=Object.freeze(Object.defineProperty({__proto__:null,createPane:zs,debug:Vs},Symbol.toStringTag,{value:"Module"}));function Ms(c,a,p){const u=c.addFolder({title:p,expanded:!1});return u.addButton({title:"Play"}).on("click",()=>{g.sound.isInit?(console.log("Sound play"),g.sound.audios.mario.play()):(console.log("Sound init"),g.sound.initAudio(),console.log("Sound play"),g.sound.audios.mario.play())}),u.addButton({title:"Pause"}).on("click",()=>{console.log("Sound pause"),g.sound.audios.mario.pause(),g.sound.audios.mario.currentTime=0}),u}function Ss(c){}const Ds=Object.freeze(Object.defineProperty({__proto__:null,createPane:Ms,debug:Ss},Symbol.toStringTag,{value:"Module"}));function Ls(c,a,p){const u=c.addFolder({title:p,expanded:!1});return u.addMonitor(a.info.memory,"geometries",{label:"Geometries"}),u.addMonitor(a.info.memory,"textures",{label:"Textures"}),u.addMonitor(a.info.programs,"length",{label:"Programs"}),u.addMonitor(a.info.render,"calls",{label:"Calls"}),u.addMonitor(a.info.render,"points",{label:"Points"}),u.addMonitor(a.info.render,"triangles",{label:"Triangles"}),a.info.autoReset=!1,N.on(U.RENDER,()=>a.info.reset()),u}function Is(c){}const Rs=Object.freeze(Object.defineProperty({__proto__:null,createPane:Ls,debug:Is},Symbol.toStringTag,{value:"Module"}));var et={exports:{}};(function(c,a){(function(p,u){u(a)})(cs,function(p){class u{constructor(e){this.controller_=e}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(e){this.controller_.viewProps.set("hidden",e)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class _{constructor(e){this.target=e}}class f extends _{constructor(e,t,n,s){super(e),this.value=t,this.presetKey=n,this.last=s??!0}}function h(i){return i}function d(i){return i==null}const x={alreadydisposed:()=>"View has been already disposed",invalidparams:i=>`Invalid parameters for '${i.name}'`,nomatchingcontroller:i=>`No matching controller for '${i.key}'`,nomatchingview:i=>`No matching view for '${JSON.stringify(i.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:i=>`Property '${i.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class P{constructor(e){var t;this.message=(t=x[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}static alreadyDisposed(){return new P({type:"alreadydisposed"})}static notBindable(){return new P({type:"notbindable"})}static propertyNotFound(e){return new P({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new P({type:"shouldneverhappen"})}}class k{constructor(){this.observers_={}}on(e,t){let n=this.observers_[e];return n||(n=this.observers_[e]=[]),n.push({handler:t}),this}off(e,t){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter(s=>s.handler!==t)),this}emit(e,t){const n=this.observers_[e];n&&n.forEach(s=>{s.handler(t)})}}const me="tp";function y(i){return(t,n)=>[me,"-",i,"v",t?`_${t}`:"",n?`-${n}`:""].join("")}function ni(i,e){return t=>e(i(t))}function si(i){return i.rawValue}function B(i,e){i.emitter.on("change",ni(si,e)),e(i.rawValue)}function J(i,e,t){B(i.value(e),t)}function ri(i,e,t){t?i.classList.add(e):i.classList.remove(e)}function be(i,e){return t=>{ri(i,e,t)}}function oi(i,e){B(i,t=>{e.textContent=t??""})}const Se=y("btn");class ai{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Se()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(Se("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const s=e.createElement("div");s.classList.add(Se("t")),oi(t.props.value("title"),s),this.buttonElement.appendChild(s)}}class li{constructor(e,t){this.emitter=new k,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new ai(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class pi{constructor(e,t){var n;this.constraint_=t==null?void 0:t.constraint,this.equals_=(n=t==null?void 0:t.equals)!==null&&n!==void 0?n:(s,r)=>s===r,this.emitter=new k,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:s,sender:this}))}}class ui{constructor(e){this.emitter=new k,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:this.value_,sender:this}))}}function I(i,e){const t=e==null?void 0:e.constraint,n=e==null?void 0:e.equals;return!t&&!n?new ui(i):new pi(i,e)}class C{constructor(e){this.emitter=new k,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((n,s)=>Object.assign(n,{[s]:I(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new C(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}function di(i,e){const n=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(i[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return n}function ci(i,e){return i.reduce((t,n)=>{if(t===void 0)return;const s=e(n);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function hi(i){return i===null?!1:typeof i=="object"}function A(i){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const n=i(t);return n!==void 0?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function tt(i){return{custom:e=>A(e)(i),boolean:A(e=>typeof e=="boolean"?e:void 0)(i),number:A(e=>typeof e=="number"?e:void 0)(i),string:A(e=>typeof e=="string"?e:void 0)(i),function:A(e=>typeof e=="function"?e:void 0)(i),constant:e=>A(t=>t===e?e:void 0)(i),raw:A(e=>e)(i),object:e=>A(t=>{if(hi(t))return di(t,e)})(i),array:e=>A(t=>{if(Array.isArray(t))return ci(t,e)})(i)}}const H={optional:tt(!0),required:tt(!1)};function Q(i,e){const t=H.required.object(e)(i);return t.succeeded?t.value:void 0}function vi(i){console.warn([`Missing '${i.key}' of ${i.target} in ${i.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function mi(i){return i&&i.parentElement&&i.parentElement.removeChild(i),null}class De{constructor(e){this.value_=e}static create(e){return[new De(e),(t,n)=>{e.setRawValue(t,n)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const bi=y("");function it(i,e){return be(i,bi(void 0,e))}class q extends C{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=De.create(I(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,n,s;const r=e??{};return new q(C.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(n=r.hidden)!==null&&n!==void 0?n:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){B(this.globalDisabled_,it(e,"disabled")),J(this,"hidden",it(e,"hidden"))}bindDisabled(e){B(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){B(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const n=e.previousRawValue;n==null||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function gi(){return["veryfirst","first","last","verylast"]}const nt=y(""),st={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class rt{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{gi().forEach(n=>{t.classList.remove(nt(void 0,st[n]))}),this.blade.get("positions").forEach(n=>{t.classList.add(nt(void 0,st[n]))})}),this.viewProps.handleDispose(()=>{mi(t)})}get parent(){return this.parent_}set parent(e){if(this.parent_=e,!("parent"in this.viewProps.valMap_)){vi({key:"parent",target:q.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const z="http://www.w3.org/2000/svg";function ge(i){i.offsetHeight}function _i(i,e){const t=i.style.transition;i.style.transition="none",e(),i.style.transition=t}function ot(i){return i.ontouchstart!==void 0}function fi(i){for(;i.childNodes.length>0;)i.removeChild(i.childNodes[0])}function wi(i){return i.relatedTarget?i.relatedTarget:"explicitOriginalTarget"in i?i.explicitOriginalTarget:null}const ae=y("lbl");function xi(i,e){const t=i.createDocumentFragment();return e.split(`
`).map(s=>i.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(i.createElement("br")),t.appendChild(s)}),t}class at{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ae()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(ae("l")),J(t.props,"label",r=>{d(r)?this.element.classList.add(ae(void 0,"nol")):(this.element.classList.remove(ae(void 0,"nol")),fi(n),n.appendChild(xi(e,r)))}),this.element.appendChild(n),this.labelElement=n;const s=e.createElement("div");s.classList.add(ae("v")),this.element.appendChild(s),this.valueElement=s}}class _e extends rt{constructor(e,t){const n=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{view:new at(e,{props:t.props,viewProps:n}),viewProps:n})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class yi extends rt{constructor(e){super(e),this.value=e.value}}class Le extends C{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=C.createCore(t);return new Le(n)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!d(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const n=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};J(this,"expanded",n),J(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Ci(i){return Le.create(i)}function Ei(i,e){let t=0;return _i(e,()=>{i.set("expandedHeight",null),i.set("temporaryExpanded",!0),ge(e),t=e.clientHeight,i.set("temporaryExpanded",null),ge(e)}),t}function lt(i,e){e.style.height=i.styleHeight}function Pi(i,e){i.value("expanded").emitter.on("beforechange",()=>{i.set("completed",!1),d(i.get("expandedHeight"))&&i.set("expandedHeight",Ei(i,e)),i.set("shouldFixHeight",!0),ge(e)}),i.emitter.on("change",()=>{lt(i,e)}),lt(i,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&i.cleanUpTransition()})}class pt{constructor(e,t){const n=y(t.viewName);this.element=e.createElement("div"),this.element.classList.add(n()),t.viewProps.bindClassModifiers(this.element)}}class fe extends yi{constructor(e,t){const n=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{value:t.valueController.value,view:new at(e,{props:t.props,viewProps:n}),viewProps:n})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class ki{constructor(){this.disabled=!1,this.emitter=new k}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Vi{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new k,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class ut{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,n)=>n.constrain(t),e)}}function we(i,e){if(i instanceof e)return i;if(i instanceof ut){const t=i.constraints.reduce((n,s)=>n||(s instanceof e?s:null),null);if(t)return t}return null}class dt{constructor(e){this.values=C.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}class Ie{constructor(e){this.values=C.fromObject({max:e.max,min:e.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(e){const t=this.values.get("max"),n=this.values.get("min");let s=e;return d(n)||(s=Math.max(s,n)),d(t)||(s=Math.min(s,t)),s}}class xe{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,n=Math.round((e-t)/this.step);return t+n*this.step}}const ct=y("pop");class zi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ct()),t.viewProps.bindClassModifiers(this.element),B(t.shows,be(this.element,ct(void 0,"v")))}}class Ti{constructor(e,t){this.shows=I(!1),this.viewProps=t.viewProps,this.view=new zi(e,{shows:this.shows,viewProps:this.viewProps})}}const ht=y("txt");class Mi{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ht()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(ht("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class Si{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Mi(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const n=e.currentTarget.value,s=this.parser_(n);d(s)||(this.value.rawValue=s),this.view.refresh()}}function Di(i){return i==="false"?!1:!!i}class Li{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const Ii={"**":(i,e)=>Math.pow(i,e),"*":(i,e)=>i*e,"/":(i,e)=>i/e,"%":(i,e)=>i%e,"+":(i,e)=>i+e,"-":(i,e)=>i-e,"<<":(i,e)=>i<<e,">>":(i,e)=>i>>e,">>>":(i,e)=>i>>>e,"&":(i,e)=>i&e,"^":(i,e)=>i^e,"|":(i,e)=>i|e};class Ri{constructor(e,t,n){this.left=t,this.operator=e,this.right=n}evaluate(){const e=Ii[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Oi={"+":i=>i,"-":i=>-i,"~":i=>~i};class Bi{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=Oi[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Re(i){return(e,t)=>{for(let n=0;n<i.length;n++){const s=i[n](e,t);if(s!=="")return s}return""}}function le(i,e){var t;const n=i.substr(e).match(/^\s+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function Ai(i,e){const t=i.substr(e,1);return t.match(/^[1-9]$/)?t:""}function pe(i,e){var t;const n=i.substr(e).match(/^[0-9]+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function ji(i,e){const t=pe(i,e);if(t!=="")return t;const n=i.substr(e,1);if(e+=1,n!=="-"&&n!=="+")return"";const s=pe(i,e);return s===""?"":n+s}function Oe(i,e){const t=i.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const n=ji(i,e);return n===""?"":t+n}function vt(i,e){const t=i.substr(e,1);if(t==="0")return t;const n=Ai(i,e);return e+=n.length,n===""?"":n+pe(i,e)}function Ni(i,e){const t=vt(i,e);if(e+=t.length,t==="")return"";const n=i.substr(e,1);if(e+=n.length,n!==".")return"";const s=pe(i,e);return e+=s.length,t+n+s+Oe(i,e)}function $i(i,e){const t=i.substr(e,1);if(e+=t.length,t!==".")return"";const n=pe(i,e);return e+=n.length,n===""?"":t+n+Oe(i,e)}function Fi(i,e){const t=vt(i,e);return e+=t.length,t===""?"":t+Oe(i,e)}const Ki=Re([Ni,$i,Fi]);function Gi(i,e){var t;const n=i.substr(e).match(/^[01]+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function Ui(i,e){const t=i.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const n=Gi(i,e);return n===""?"":t+n}function Hi(i,e){var t;const n=i.substr(e).match(/^[0-7]+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function qi(i,e){const t=i.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const n=Hi(i,e);return n===""?"":t+n}function Xi(i,e){var t;const n=i.substr(e).match(/^[0-9a-f]+/i);return(t=n&&n[0])!==null&&t!==void 0?t:""}function Yi(i,e){const t=i.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const n=Xi(i,e);return n===""?"":t+n}const Wi=Re([Ui,qi,Yi]),Zi=Re([Wi,Ki]);function Ji(i,e){const t=Zi(i,e);return e+=t.length,t===""?null:{evaluable:new Li(t),cursor:e}}function Qi(i,e){const t=i.substr(e,1);if(e+=t.length,t!=="(")return null;const n=bt(i,e);if(!n)return null;e=n.cursor,e+=le(i,e).length;const s=i.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:n.evaluable,cursor:e}}function en(i,e){var t;return(t=Ji(i,e))!==null&&t!==void 0?t:Qi(i,e)}function mt(i,e){const t=en(i,e);if(t)return t;const n=i.substr(e,1);if(e+=n.length,n!=="+"&&n!=="-"&&n!=="~")return null;const s=mt(i,e);return s?(e=s.cursor,{cursor:e,evaluable:new Bi(n,s.evaluable)}):null}function tn(i,e,t){t+=le(e,t).length;const n=i.filter(s=>e.startsWith(s,t))[0];return n?(t+=n.length,t+=le(e,t).length,{cursor:t,operator:n}):null}function nn(i,e){return(t,n)=>{const s=i(t,n);if(!s)return null;n=s.cursor;let r=s.evaluable;for(;;){const o=tn(e,t,n);if(!o)break;n=o.cursor;const l=i(t,n);if(!l)return null;n=l.cursor,r=new Ri(o.operator,r,l.evaluable)}return r?{cursor:n,evaluable:r}:null}}const sn=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((i,e)=>nn(i,e),mt);function bt(i,e){return e+=le(i,e).length,sn(i,e)}function rn(i){const e=bt(i,0);return!e||e.cursor+le(i,e.cursor).length!==i.length?null:e.evaluable}function ye(i){var e;const t=rn(i);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function on(i){if(typeof i=="number")return i;if(typeof i=="string"){const e=ye(i);if(!d(e))return e}return 0}function V(i){return e=>e.toFixed(Math.max(Math.min(i,20),0))}const an=V(0);function Ce(i){return an(i)+"%"}function ln(i){return String(i)}function gt(i,e){for(;i.length<e;)i.push(void 0)}function pn(i){const e=[];return gt(e,i),I(e)}function un(i){const e=i.indexOf(void 0);return e<0?i:i.slice(0,e)}function dn(i,e){const t=[...un(i),e];return t.length>i.length?t.splice(0,t.length-i.length):gt(t,i.length),t}function _t({primary:i,secondary:e,forward:t,backward:n}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}i.emitter.on("change",o=>{r(()=>{e.setRawValue(t(i,e),o.options)})}),e.emitter.on("change",o=>{r(()=>{i.setRawValue(n(i,e),o.options)}),r(()=>{e.setRawValue(t(i,e),o.options)})}),r(()=>{e.setRawValue(t(i,e),{forceEmit:!1,last:!0})})}function ee(i,e){const t=i*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function Ee(i){return{altKey:i.altKey,downKey:i.key==="ArrowDown",shiftKey:i.shiftKey,upKey:i.key==="ArrowUp"}}function ft(i){return{altKey:i.altKey,downKey:i.key==="ArrowLeft",shiftKey:i.shiftKey,upKey:i.key==="ArrowRight"}}function cn(i){return i==="ArrowUp"||i==="ArrowDown"}function wt(i){return cn(i)||i==="ArrowLeft"||i==="ArrowRight"}function Be(i,e){var t,n;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:i.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:i.pageY-(((n=s&&s.scrollY)!==null&&n!==void 0?n:0)+r.top)}}class Pe{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new k,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Be(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Be(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Be(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const n=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-s.left,y:n.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}}function E(i,e,t,n,s){const r=(i-e)/(t-e);return n+r*(s-n)}function xt(i){return String(i.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function te(i,e,t){return Math.min(Math.max(i,e),t)}const S=y("txt");class hn{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(S(),S(void 0,"num")),t.arrayPosition&&this.element.classList.add(S(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(S("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(S()),this.inputElement.classList.add(S("i"));const s=e.createElement("div");s.classList.add(S("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(z,"svg");r.classList.add(S("g")),this.knobElement.appendChild(r);const o=e.createElementNS(z,"path");o.classList.add(S("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(z,"path");l.classList.add(S("gh")),r.appendChild(l),this.guideHeadElem_=l;const b=e.createElement("div");b.classList.add(y("tt")()),this.knobElement.appendChild(b),this.tooltipElem_=b,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(S(void 0,"drg"));return}this.element.classList.add(S(void 0,"drg"));const t=e.rawValue/this.props_.get("draggingScale"),n=t+(t>0?-1:t<0?1:0),s=te(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+s},0 L${n},4 L${n+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class vn{constructor(e,t){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.sliderProps_=(n=t.sliderProps)!==null&&n!==void 0?n:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=I(null),this.view=new hn(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Pe(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,n;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("minValue"),r=(n=this.sliderProps_)===null||n===void 0?void 0:n.get("maxValue");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const n=e.currentTarget.value,s=this.parser_(n);d(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=ee(this.baseStep_,Ee(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){ee(this.baseStep_,Ee(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("draggingScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function Ae(i,e){i.write(e)}function mn(i){const e=i?we(i,xe):null;return e?e.step:null}function bn(i,e){const t=i&&we(i,xe);return t?xt(t.step):Math.max(xt(e),2)}function yt(i){const e=mn(i);return e??1}function gn(i,e){var t;const n=i&&we(i,xe),s=Math.abs((t=n==null?void 0:n.step)!==null&&t!==void 0?t:e);return s===0?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function ke(i){return[i[0],i[1],i[2]]}function Ct(i){const e=te(Math.floor(i),0,255).toString(16);return e.length===1?`0${e}`:e}function _n(i,e="#"){const t=ke(i.getComponents("rgb")).map(Ct).join("");return`${e}${t}`}function fn(i,e="#"){const t=i.getComponents("rgb"),n=[t[0],t[1],t[2],t[3]*255].map(Ct).join("");return`${e}${n}`}function wn(i,e){const t=V(e==="float"?2:0);return`rgb(${ke(i.getComponents("rgb",e)).map(s=>t(s)).join(", ")})`}function xn(i){return e=>wn(e,i)}function yn(i,e){const t=V(2),n=V(e==="float"?2:0);return`rgba(${i.getComponents("rgb",e).map((r,o)=>(o===3?t:n)(r)).join(", ")})`}function Cn(i){return e=>yn(e,i)}function En(i){const e=[V(0),Ce,Ce];return`hsl(${ke(i.getComponents("hsl")).map((n,s)=>e[s](n)).join(", ")})`}function Pn(i){const e=[V(0),Ce,Ce,V(2)];return`hsla(${i.getComponents("hsl").map((n,s)=>e[s](n)).join(", ")})`}function kn(i,e){const t=V(e==="float"?2:0),n=["r","g","b"];return`{${ke(i.getComponents("rgb",e)).map((r,o)=>`${n[o]}: ${t(r)}`).join(", ")}}`}function Vn(i){return e=>kn(e,i)}function zn(i,e){const t=V(2),n=V(e==="float"?2:0),s=["r","g","b","a"];return`{${i.getComponents("rgb",e).map((o,l)=>{const b=l===3?t:n;return`${s[l]}: ${b(o)}`}).join(", ")}}`}function Tn(i){return e=>zn(e,i)}[...["int","float"].reduce((i,e)=>[...i,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:xn(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:Cn(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Vn(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Tn(e)}],[])];class Mn{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((n,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(n))!==null&&o!==void 0?o:n});return this.asm_.fromComponents(t)}}const Et=y("pndtxt");class Sn{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Et()),this.textViews.forEach(n=>{const s=e.createElement("div");s.classList.add(Et("a")),s.appendChild(n.element),this.element.appendChild(s)})}}function Dn(i,e,t){return new vn(i,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",baseStep:e.axes[t].baseStep,parser:e.parser,props:e.axes[t].textProps,value:I(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}class je{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((n,s)=>Dn(e,t,s)),this.acs_.forEach((n,s)=>{_t({primary:this.value,secondary:n.value,forward:r=>t.assembly.toComponents(r.rawValue)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r.rawValue);return l[s]=o.rawValue,t.assembly.fromComponents(l)}})}),this.view=new Sn(e,{textViews:this.acs_.map(n=>n.view)})}}function Ln(i,e){return"step"in i&&!d(i.step)?new xe(i.step,e):null}function In(i){return!d(i.max)&&!d(i.min)?new dt({max:i.max,min:i.min}):!d(i.max)||!d(i.min)?new Ie({max:i.max,min:i.min}):null}const Rn={monitor:{defaultInterval:200,defaultLineCount:3}},$=y("grl");class On{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add($()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(z,"svg");n.classList.add($("g")),n.style.height=`calc(var(--bld-us) * ${t.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const s=e.createElementNS(z,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add($("t"),y("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,n=this.props_.get("minValue"),s=this.props_.get("maxValue"),r=[];this.value.rawValue.forEach((j,Ze)=>{if(j===void 0)return;const os=E(Ze,0,t,0,e.width),as=E(j,n,s,e.height,0);r.push([os,as].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove($("t","a"));return}const b=E(this.cursor_.rawValue,0,t,0,e.width),L=E(l,n,s,e.height,0);o.style.left=`${b}px`,o.style.top=`${L}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains($("t","a"))||(o.classList.add($("t","a"),$("t","in")),ge(o),o.classList.remove($("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Bn{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=I(-1),this.view=new On(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!ot(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const n=new Pe(this.view.element);n.emitter.on("down",this.onGraphPointerDown_),n.emitter.on("move",this.onGraphPointerMove_),n.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(E(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(E(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class Pt{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return(e=this.controller_.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller_.emitter.on(e,()=>{n(new _(this))}),this}}class An extends _{constructor(e,t,n){super(e),this.cell=t,this.index=n}}class kt extends u{constructor(e){super(e),this.cellToApiMap_=new Map,this.emitter_=new k;const t=this.controller_.valueController;t.cellControllers.forEach((n,s)=>{const r=new Pt(n);this.cellToApiMap_.set(n,r),n.emitter.on("click",()=>{const o=s%t.size[0],l=Math.floor(s/t.size[0]);this.emitter_.emit("click",{event:new An(this,r,[o,l])})})})}cell(e,t){const n=this.controller_.valueController,s=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(s)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,s=>{n(s.event)}),this}}class Ne{constructor(e,t){this.size=t.size;const[n,s]=this.size,r=[];for(let o=0;o<s;o++)for(let l=0;l<n;l++){const b=new li(e,{props:C.fromObject(Object.assign({},t.cellConfig(l,o))),viewProps:q.create()});r.push(b)}this.cellCs_=r,this.viewProps=q.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(o=>{o.viewProps.set("disposed",!0)})}),this.view=new pt(e,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach(o=>{this.view.element.appendChild(o.view.element)})}get cellControllers(){return this.cellCs_}}const jn={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const e=H,t=Q(i,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return t?{params:t}:null},controller(i){return new _e(i.document,{blade:i.blade,props:C.fromObject({label:i.params.label}),valueController:new Ne(i.document,{cellConfig:i.params.cells,size:i.params.size})})},api(i){return!(i.controller instanceof _e)||!(i.controller.valueController instanceof Ne)?null:new kt(i.controller)}};class Vt extends u{get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const n=t.bind(this);return this.controller_.valueController.value.emitter.on(e,s=>{n(new f(this,s.rawValue,void 0,s.options.last))}),this}}function D(i,e,t){return i*(1-t)+e*t}const Nn=20,$n=.001,$e=100;function Fn(i,e){let t=.25,n=.5,s=-1;for(let r=0;r<Nn;r++){const[o,l]=i.curve(n);if(n+=t*(o<e?1:-1),s=l,t*=.5,Math.abs(e-o)<$n)break}return s}class F{constructor(e=0,t=0,n=1,s=1){this.cache_=[],this.comps_=[e,t,n,s]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(e){return d(e)||!Array.isArray(e)?!1:typeof e[0]=="number"&&typeof e[1]=="number"&&typeof e[2]=="number"&&typeof e[3]=="number"}static equals(e,t){return e.x1===t.x1&&e.y1===t.y1&&e.x2===t.x2&&e.y2===t.y2}curve(e){const t=D(0,this.x1,e),n=D(0,this.y1,e),s=D(this.x1,this.x2,e),r=D(this.y1,this.y2,e),o=D(this.x2,1,e),l=D(this.y2,1,e),b=D(t,s,e),L=D(n,r,e),j=D(s,o,e),Ze=D(r,l,e);return[D(b,j,e),D(L,Ze,e)]}y(e){if(this.cache_.length===0){const t=[];for(let n=0;n<$e;n++)t.push(Fn(this,E(n,0,$e-1,0,1)));this.cache_=t}return this.cache_[Math.round(E(te(e,0,1),0,1,0,$e-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const Fe={toComponents:i=>i.toObject(),fromComponents:i=>new F(...i)};function Kn(i){const e=V(2);return`cubic-bezier(${i.toObject().map(n=>e(n)).join(", ")})`}const zt=[0,.5,.5,1];function Gn(i){const e=i.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new F(...zt);const t=[e[1],e[2],e[3],e[4]].reduce((n,s)=>{if(!n)return null;const r=Number(s);return isNaN(r)?null:[...n,r]},[]);return new F(...t??zt)}const X=y("cbz");class Tt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(X()),t.viewProps.bindClassModifiers(this.element),t.foldable.bindExpandedClass(this.element,X(void 0,"expanded")),J(t.foldable,"completed",be(this.element,X(void 0,"cpl")));const n=e.createElement("div");n.classList.add(X("h")),this.element.appendChild(n);const s=e.createElement("button");s.classList.add(X("b")),t.viewProps.bindDisabled(s);const r=e.createElementNS(z,"svg");r.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',s.appendChild(r),n.appendChild(s),this.buttonElement=s;const o=e.createElement("div");if(o.classList.add(X("t")),n.appendChild(o),this.textElement=o,t.pickerLayout==="inline"){const l=e.createElement("div");l.classList.add(X("p")),this.element.appendChild(l),this.pickerElement=l}else this.pickerElement=null}}const Ke=y("cbzp");class Mt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ke()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ke("g")),this.element.appendChild(n),this.graphElement=n;const s=e.createElement("div");s.classList.add(Ke("t")),this.element.appendChild(s),this.textElement=s}}function St(i,e){const t=new MutationObserver(s=>{for(const r of s)r.type==="childList"&&r.addedNodes.forEach(o=>{o.contains(o)&&(e(),t.disconnect())})}),n=i.ownerDocument;t.observe(n.body,{attributes:!0,childList:!0,subtree:!0})}const K=y("cbzg");function Un(i,e){return t=>e(i(t))}class Dt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(K()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(K("p")),this.element.appendChild(n),this.previewElement=n;const s=e.createElementNS(z,"svg");s.classList.add(K("g")),this.element.appendChild(s),this.svgElem_=s;const r=e.createElementNS(z,"path");r.classList.add(K("u")),this.svgElem_.appendChild(r),this.guideElem_=r;const o=e.createElementNS(z,"polyline");o.classList.add(K("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[e.createElement("div"),e.createElement("div")],this.handleElems_.forEach(l=>{l.classList.add(K("h")),this.element.appendChild(l)}),this.vectorElems_=[e.createElementNS(z,"line"),e.createElementNS(z,"line")],this.vectorElems_.forEach(l=>{l.classList.add(K("v")),this.svgElem_.appendChild(l)}),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=t.selection,this.handleElems_.forEach((l,b)=>{B(this.sel_,Un(L=>L===b,be(l,K("h","sel"))))}),St(this.element,()=>{this.refresh()})}getVertMargin_(e){return e*.25}valueToPosition(e,t){const n=this.element.getBoundingClientRect(),s=n.width,r=n.height,o=this.getVertMargin_(r);return{x:E(e,0,1,0,s),y:E(t,0,1,r-o,o)}}positionToValue(e,t){const n=this.element.getBoundingClientRect(),s=n.width,r=n.height,o=this.getVertMargin_(r);return{x:te(E(e,0,s,0,1),0,1),y:E(t,r-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(r=>{const o=this.valueToPosition(0,r),l=this.valueToPosition(1,r);return[`M ${o.x},${o.y}`,`L ${l.x},${l.y}`].join(" ")}).join(" "));const e=this.value_.rawValue,t=[];let n=0;for(;;){const r=this.valueToPosition(...e.curve(n));if(t.push([r.x,r.y].join(",")),n>=1)break;n=Math.min(n+.05,1)}this.lineElem_.setAttributeNS(null,"points",t.join(" "));const s=e.toObject();[0,1].forEach(r=>{const o=this.valueToPosition(r,r),l=this.valueToPosition(s[r*2],s[r*2+1]),b=this.vectorElems_[r];b.setAttributeNS(null,"x1",String(o.x)),b.setAttributeNS(null,"y1",String(o.y)),b.setAttributeNS(null,"x2",String(l.x)),b.setAttributeNS(null,"y2",String(l.y));const L=this.handleElems_[r];L.style.left=`${l.x}px`,L.style.top=`${l.y}px`})}onValueChange_(){this.refresh()}}const Lt=24,It=400,Rt=1e3,ie=y("cbzprv");class Ot{constructor(e,t){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ie()),t.viewProps.bindClassModifiers(this.element);const n=e.createElementNS(z,"svg");n.classList.add(ie("g")),this.element.appendChild(n),this.svgElem_=n;const s=e.createElementNS(z,"path");s.classList.add(ie("t")),this.svgElem_.appendChild(s),this.ticksElem_=s;const r=e.createElement("div");r.classList.add(ie("m")),this.element.appendChild(r),this.markerElem_=r,this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.viewProps.handleDispose(this.onDispose_),St(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(ie("m","a")),this.startTime_=new Date().getTime()+It,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(ie("m","a"))}onDispose_(){this.stop()}updateMarker_(e){const t=this.value_.rawValue.y(te(e,0,1));this.markerElem_.style.left=`${t*100}%`}refresh(){const e=this.svgElem_.getBoundingClientRect(),t=e.width,n=e.height,s=[],r=this.value_.rawValue;for(let o=0;o<Lt;o++){const l=E(o,0,Lt-1,0,1),b=E(r.y(l),0,1,0,t);s.push(`M ${b},0 v${n}`)}this.ticksElem_.setAttributeNS(null,"d",s.join(" "))}onTimer_(){if(this.startTime_===null)return;const e=new Date().getTime()-this.startTime_,t=e/Rt;this.updateMarker_(t),e>Rt+It&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function Ge(i,e,t,n){const s=t-i,r=n-e;return Math.sqrt(s*s+r*r)}function Hn(i,e,t,n){const s=Ge(i,e,t,n),r=Math.atan2(n-e,t-i),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:i+Math.cos(o)*s,y:e+Math.sin(o)*s}}class Bt{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.sel_=I(0),this.viewProps=t.viewProps,this.view=new Dt(e,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new Ot(e,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",s=>{s.stopImmediatePropagation(),s.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const n=new Pe(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(e,t,n){const s=this.sel_.rawValue,r=this.value.rawValue.toObject(),o=this.view.positionToValue(e.x,e.y),l=t?Hn(s,s,o.x,o.y):o;r[s*2]=l.x,r[s*2+1]=l.y,this.value.setRawValue(new F(...r),n)}onPointerDown_(e){const t=e.data;if(!t.point)return;const n=this.value.rawValue,s=this.view.valueToPosition(n.x1,n.y1),r=Ge(t.point.x,t.point.y,s.x,s.y),o=this.view.valueToPosition(n.x2,n.y2),l=Ge(t.point.x,t.point.y,o.x,o.y);this.sel_.rawValue=r<=l?0:1,this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(e){wt(e.key)&&e.preventDefault();const t=this.sel_.rawValue,n=this.value.rawValue.toObject();n[t*2]+=ee(this.baseStep_,ft(e)),n[t*2+1]+=ee(this.baseStep_,Ee(e)),this.value.setRawValue(new F(...n),{forceEmit:!1,last:!1})}onKeyUp_(e){wt(e.key)&&e.preventDefault();const t=ee(this.baseStep_,ft(e)),n=ee(this.baseStep_,Ee(e));t===0&&n===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class At{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Mt(e,{viewProps:this.viewProps}),this.gc_=new Bt(e,{baseStep:t.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const n=Object.assign(Object.assign({},t.axis),{constraint:new Ie({max:1,min:0})}),s=Object.assign(Object.assign({},t.axis),{constraint:void 0});this.tc_=new je(e,{assembly:Fe,axes:[n,s,n,s],parser:ye,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(e=>e.inputElement)]}refresh(){this.gc_.refresh()}}class Ue{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Ci(t.expanded),this.view=new Tt(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Si(e,{parser:Gn,props:C.fromObject({formatter:Kn}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=t.pickerLayout==="popup"?new Ti(e,{viewProps:this.viewProps}):null;const n=new At(e,{axis:t.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach(s=>{s.addEventListener("blur",this.onPopupChildBlur_),s.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),B(this.popC_.shows,s=>{s&&n.refresh()}),_t({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:s=>s.rawValue,backward:(s,r)=>r.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Pi(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=e.relatedTarget;(!t||!this.popC_.view.element.contains(t))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=wi(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!ot(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_&&e.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function qn(){return new Mn({assembly:Fe,components:[0,1,2,3].map(i=>i%2===0?new Ie({min:0,max:1}):void 0)})}const Xn={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const e=H,t=Q(i,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom(n=>n==="inline"||n==="popup"?n:void 0)});return t?{params:t}:null},controller(i){var e,t;const n=new F(...i.params.value),s=I(n,{constraint:qn(),equals:F.equals}),r=new Ue(i.document,{axis:{baseStep:.1,textProps:C.fromObject({draggingScale:.01,formatter:V(2)})},expanded:(e=i.params.expanded)!==null&&e!==void 0?e:!1,pickerLayout:(t=i.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:i.viewProps});return new fe(i.document,{blade:i.blade,props:C.fromObject({label:i.params.label}),valueController:r})},api(i){return!(i.controller instanceof fe)||!(i.controller.valueController instanceof Ue)?null:new Vt(i.controller)}};class jt extends u{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Nt=20;class $t{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(e){this.start_=e.getTime()}calculateFps_(e){if(this.timestamps_.length===0)return null;const t=this.timestamps_[0];return 1e3*(this.frameCount_-t.frameCount)/(e-t.time)}compactTimestamps_(){if(this.timestamps_.length<=Nt)return;const e=this.timestamps_.length-Nt;this.timestamps_.splice(0,e);const t=this.timestamps_[0].frameCount;this.timestamps_.forEach(n=>{n.frameCount-=t}),this.frameCount_-=t}end(e){if(this.start_===null)return;const t=e.getTime();this.duration_=t-this.start_,this.start_=null,this.fps_=this.calculateFps_(t),this.timestamps_.push({frameCount:this.frameCount_,time:t}),++this.frameCount_,this.compactTimestamps_()}}const ue=y("fps");class Ft{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ue()),t.viewProps.bindClassModifiers(this.element),this.graphElement=e.createElement("div"),this.graphElement.classList.add(ue("g")),this.element.appendChild(this.graphElement);const n=e.createElement("div");n.classList.add(ue("l")),this.element.appendChild(n);const s=e.createElement("span");s.classList.add(ue("v")),s.textContent="--",n.appendChild(s),this.valueElement=s;const r=e.createElement("span");r.classList.add(ue("u")),r.textContent="FPS",n.appendChild(r)}}class He{constructor(e,t){this.stopwatch_=new $t,this.onTick_=this.onTick_.bind(this),this.ticker_=t.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=t.value,this.viewProps=t.viewProps,this.view=new Ft(e,{viewProps:this.viewProps}),this.graphC_=new Bn(e,{formatter:V(0),lineCount:t.lineCount,props:C.fromObject({maxValue:t.maxValue,minValue:t.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()})}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const e=this.stopwatch_.fps;if(e!==null){const t=this.value_.rawValue;this.value_.rawValue=dn(t,e),this.view.valueElement.textContent=e.toFixed(0)}}}function Yn(i,e){return e===0?new ki:new Vi(i,e??Rn.monitor.defaultInterval)}const Wn={id:"fpsgraph",type:"blade",accept(i){const e=H,t=Q(i,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return t?{params:t}:null},controller(i){var e,t,n,s;const r=(e=i.params.interval)!==null&&e!==void 0?e:500;return new _e(i.document,{blade:i.blade,props:C.fromObject({label:i.params.label}),valueController:new He(i.document,{lineCount:(t=i.params.lineCount)!==null&&t!==void 0?t:2,maxValue:(n=i.params.max)!==null&&n!==void 0?n:90,minValue:(s=i.params.min)!==null&&s!==void 0?s:0,ticker:Yn(i.document,r),value:pn(80),viewProps:i.viewProps})})},api(i){return!(i.controller instanceof _e)||!(i.controller.valueController instanceof He)?null:new jt(i.controller)}};class T{constructor(e,t){this.min=e,this.max=t}static isObject(e){if(typeof e!="object"||e===null)return!1;const t=e.min,n=e.max;return!(typeof t!="number"||typeof n!="number")}static equals(e,t){return e.min===t.min&&e.max===t.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const qe={fromComponents:i=>new T(i[0],i[1]),toComponents:i=>[i.min,i.max]};class Xe{constructor(e){this.edge=e}constrain(e){var t,n,s,r,o,l,b,L;if(e.min<=e.max)return new T((n=(t=this.edge)===null||t===void 0?void 0:t.constrain(e.min))!==null&&n!==void 0?n:e.min,(r=(s=this.edge)===null||s===void 0?void 0:s.constrain(e.max))!==null&&r!==void 0?r:e.max);const j=(e.min+e.max)/2;return new T((l=(o=this.edge)===null||o===void 0?void 0:o.constrain(j))!==null&&l!==void 0?l:j,(L=(b=this.edge)===null||b===void 0?void 0:b.constrain(j))!==null&&L!==void 0?L:j)}}const Ye=y("rsltxt");class Kt{constructor(e,t){this.sliderView_=t.sliderView,this.textView_=t.textView,this.element=e.createElement("div"),this.element.classList.add(Ye());const n=e.createElement("div");n.classList.add(Ye("s")),n.appendChild(this.sliderView_.element),this.element.appendChild(n);const s=e.createElement("div");s.classList.add(Ye("t")),s.appendChild(this.textView_.element),this.element.appendChild(s)}}const Y=y("rsl");class Gt{constructor(e,t){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=t.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Y()),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_);const n=e.createElement("div");n.classList.add(Y("t")),this.element.appendChild(n),this.trackElement=n;const s=e.createElement("div");s.classList.add(Y("b")),n.appendChild(s),this.barElement=s;const r=["min","max"].map(o=>{const l=e.createElement("div");return l.classList.add(Y("k"),Y("k",o)),n.appendChild(l),l});this.knobElements=[r[0],r[1]],this.update_()}valueToX_(e){const t=this.sliderProps_.get("minValue"),n=this.sliderProps_.get("maxValue");return te(E(e,t,n,0,1),0,1)*100}update_(){const e=this.value_.rawValue;e.length===0?this.element.classList.add(Y(void 0,"zero")):this.element.classList.remove(Y(void 0,"zero"));const t=[this.valueToX_(e.min),this.valueToX_(e.max)];this.barElement.style.left=`${t[0]}%`,this.barElement.style.right=`${100-t[1]}%`,this.knobElements.forEach((n,s)=>{n.style.left=`${t[s]}%`})}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Ut{constructor(e,t){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=t.sliderProps,this.viewProps=t.viewProps,this.value=t.value,this.view=new Gt(e,{sliderProps:this.sliderProps,value:this.value,viewProps:t.viewProps});const n=new Pe(this.view.trackElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(e){if(!e.point)return null;const t=(e.point.x+this.ofs_())/e.bounds.width,n=this.sliderProps.get("minValue"),s=this.sliderProps.get("maxValue");return E(t,0,1,n,s)}onPointerDown_(e){if(!e.data.point)return;const t=e.data.point.x/e.data.bounds.width,n=this.value.rawValue,s=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue"),o=E(n.min,s,r,0,1),l=E(n.max,s,r,0,1);Math.abs(l-t)<=.025?this.grabbing_="max":Math.abs(o-t)<=.025?this.grabbing_="min":t>=o&&t<=l?(this.grabbing_="length",this.grabOffset_=E(t-o,0,1,0,r-s)):t<o?(this.grabbing_="min",this.onPointerMove_(e)):t>l&&(this.grabbing_="max",this.onPointerMove_(e))}applyPointToValue_(e,t){const n=this.valueFromData_(e);if(n===null)return;const s=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue");if(this.grabbing_==="min")this.value.setRawValue(new T(n,this.value.rawValue.max),t);else if(this.grabbing_==="max")this.value.setRawValue(new T(this.value.rawValue.min,n),t);else if(this.grabbing_==="length"){const o=this.value.rawValue.length;let l=n-this.grabOffset_,b=l+o;l<s?(l=s,b=s+o):b>r&&(l=r-o,b=r),this.value.setRawValue(new T(l,b),t)}}onPointerMove_(e){this.applyPointToValue_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.applyPointToValue_(e.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Ht{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sc_=new Ut(e,t);const n={baseStep:t.baseStep,constraint:t.constraint,textProps:C.fromObject({draggingScale:t.draggingScale,formatter:t.formatter})};this.tc_=new je(e,{assembly:qe,axes:[n,n],parser:t.parser,value:this.value,viewProps:t.viewProps}),this.view=new Kt(e,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function Zn(i){return T.isObject(i)?new T(i.min,i.max):new T(0,0)}function Jn(i,e){i.writeProperty("max",e.max),i.writeProperty("min",e.min)}function Qn(i){const e=[],t=In(i);t&&e.push(t);const n=Ln(i);return n&&e.push(n),new Xe(new ut(e))}const es={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(i,e)=>{if(!T.isObject(i))return null;const t=H,n=Q(e,{format:t.optional.function,max:t.optional.number,min:t.optional.number,step:t.optional.number});return n?{initialValue:new T(i.min,i.max),params:n}:null},binding:{reader:i=>Zn,constraint:i=>Qn(i.params),equals:T.equals,writer:i=>Jn},controller(i){var e;const t=i.value,n=i.constraint;if(!(n instanceof Xe))throw P.shouldNeverHappen();const s=(t.rawValue.min+t.rawValue.max)/2,r=(e=i.params.format)!==null&&e!==void 0?e:V(bn(n.edge,s)),o=n.edge&&we(n.edge,dt);if(o)return new Ht(i.document,{baseStep:yt(n.edge),constraint:n.edge,draggingScale:gn(n.edge,s),formatter:r,parser:ye,sliderProps:new C({maxValue:o.values.value("max"),minValue:o.values.value("min")}),value:t,viewProps:i.viewProps});const l={baseStep:yt(n.edge),constraint:n.edge,textProps:C.fromObject({draggingScale:s,formatter:r})};return new je(i.document,{assembly:qe,axes:[l,l],parser:ye,value:t,viewProps:i.viewProps})}};class qt{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return(e=this.controller_.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.props.set("title",e)}}class Xt extends f{constructor(e,t,n,s,r){super(e,s,r),this.cell=t,this.index=n}}class Yt extends u{constructor(e){super(e),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach(n=>{const s=new qt(n);this.cellToApiMap_.set(n,s)})}get value(){return this.controller_.value}cell(e,t){const n=this.controller_.valueController,s=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(s)}on(e,t){const n=t.bind(this);this.controller_.value.emitter.on(e,s=>{const r=this.controller_.valueController,o=r.findCellByValue(s.rawValue);if(!o)return;const l=this.cellToApiMap_.get(o);if(!l)return;const b=r.cellControllers.indexOf(o);n(new Xt(this,l,[b%r.size[0],Math.floor(b/r.size[0])],s.rawValue,void 0))})}}const de=y("rad");class Wt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(de()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(de("l")),this.element.appendChild(n);const s=e.createElement("input");s.classList.add(de("i")),s.name=t.name,s.type="radio",t.viewProps.bindDisabled(s),n.appendChild(s),this.inputElement=s;const r=e.createElement("div");r.classList.add(de("b")),n.appendChild(r);const o=e.createElement("div");o.classList.add(de("t")),r.appendChild(o),J(t.props,"title",l=>{o.textContent=l})}}class Zt{constructor(e,t){this.props=t.props,this.viewProps=t.viewProps,this.view=new Wt(e,{name:t.name,props:this.props,viewProps:this.viewProps})}}class Ve{constructor(e,t){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=t.size;const[n,s]=this.size;for(let r=0;r<s;r++)for(let o=0;o<n;o++){const l=new Zt(e,{name:t.groupName,props:C.fromObject(Object.assign({},t.cellConfig(o,r))),viewProps:q.create()});this.cellCs_.push(l),this.cellValues_.push(t.cellConfig(o,r).value)}this.value=t.value,B(this.value,r=>{const o=this.findCellByValue(r);o&&(o.view.inputElement.checked=!0)}),this.viewProps=q.create(),this.view=new pt(e,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach(r=>{r.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(r.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(e){const t=this.cellValues_.findIndex(n=>n===e);return t<0?null:this.cellCs_[t]}onCellInputChange_(e){const t=e.currentTarget,n=this.cellCs_.findIndex(s=>s.view.inputElement===t);n<0||(this.value.rawValue=this.cellValues_[n])}}const ts=function(){return{id:"radiogrid",type:"blade",accept(i){const e=H,t=Q(i,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return t?{params:t}:null},controller(i){return new fe(i.document,{blade:i.blade,props:C.fromObject({label:i.params.label}),valueController:new Ve(i.document,{groupName:i.params.groupName,cellConfig:i.params.cells,size:i.params.size,value:I(i.params.value)})})},api(i){return!(i.controller instanceof fe)||!(i.controller.valueController instanceof Ve)?null:new Yt(i.controller)}}}();function We(i){return{id:"input-radiogrid",type:"input",accept(e,t){if(!i.isType(e))return null;const n=H,s=Q(t,{cells:n.required.function,groupName:n.required.string,size:n.required.array(n.required.number),view:n.required.constant("radiogrid")});return s?{initialValue:e,params:s}:null},binding:i.binding,controller:e=>new Ve(e.document,{cellConfig:e.params.cells,groupName:e.params.groupName,size:e.params.size,value:e.value})}}const is=We({isType:i=>typeof i=="number",binding:{reader:i=>on,writer:i=>Ae}}),ns=We({isType:i=>typeof i=="string",binding:{reader:i=>ln,writer:i=>Ae}}),ss=We({isType:i=>typeof i=="boolean",binding:{reader:i=>Di,writer:i=>Ae}}),rs=[jn,Xn,Wn,es,ts,ss,is,ns];p.ButtonCellApi=Pt,p.ButtonGridApi=kt,p.ButtonGridController=Ne,p.CubicBezier=F,p.CubicBezierApi=Vt,p.CubicBezierAssembly=Fe,p.CubicBezierController=Ue,p.CubicBezierGraphController=Bt,p.CubicBezierGraphView=Dt,p.CubicBezierPickerController=At,p.CubicBezierPickerView=Mt,p.CubicBezierPreviewView=Ot,p.CubicBezierView=Tt,p.FpsGraphBladeApi=jt,p.FpsGraphController=He,p.FpsView=Ft,p.Fpswatch=$t,p.Interval=T,p.IntervalAssembly=qe,p.IntervalConstraint=Xe,p.RadioCellApi=qt,p.RadioController=Zt,p.RadioGridApi=Yt,p.RadioGridController=Ve,p.RadioView=Wt,p.RangeSliderController=Ut,p.RangeSliderTextController=Ht,p.RangeSliderTextView=Kt,p.RangeSliderView=Gt,p.TpRadioGridChangeEvent=Xt,p.plugins=rs,Object.defineProperty(p,"__esModule",{value:!0})})})(et,et.exports);var ii=et.exports;const Os=hs(ii),Bs=vs({__proto__:null,default:Os},[ii]),ce=Object.fromEntries(Object.entries(Object.assign({"./functions/CameraDebug.js":gs,"./functions/GameDebug.js":ws,"./functions/PlayerDebug.js":Cs,"./functions/PostProcessingDebug.js":ks,"./functions/SceneDebug.js":Ts,"./functions/SoundDebug.js":Ds,"./functions/StatsDebug.js":Rs})).map(([c,a])=>[c.split("/").pop().split(".")[0].replace("Debug",""),a]));var O,Z,oe,M,ve;class Fs{constructor(){ne(this,O,void 0);ne(this,Z,void 0);ne(this,oe,void 0);ne(this,M,void 0);ne(this,ve,void 0);N.register(this),se(this,O,new Map),se(this,Z,new Map)}async load(){se(this,ve,await ei(()=>import("./tweakpane-818bbaec.js").then(a=>a.t),["assets/tweakpane-818bbaec.js","assets/_commonjsHelpers-725317a4.js"]))}init(){var p;se(this,M,new(w(this,ve)).Pane({title:us})),w(this,M).registerPlugin(Bs),w(this,M).hidden=localStorage.getItem("debug")==="true",se(this,oe,w(this,M).addTab({pages:ds.map(u=>({title:u}))}).pages),w(this,M).addSeparator(),w(this,M).addButton({title:"Refresh"}).on("click",()=>w(this,M).refresh());const a=(p=g.debug)==null?void 0:p.urlParams.getNumber("tab");a&&w(this,oe)[a].controller_.onItemClick_()}addToParent(a,p,u){w(this,O).get(u)||w(this,O).set(u,[]),w(this,O).get(u).push(a),w(this,Z).get(u)&&ce[p].createPane(w(this,Z).get(u),a,p)}add(a,p,u=0,_=""){var f,h,d,x;if(ce[p]){const P=(h=(f=ce[p]).createPane)==null?void 0:h.call(f,w(this,oe)[u],a,_||p);(x=(d=ce[p]).debug)==null||x.call(d,a),w(this,Z).set(p,P),w(this,O).get(p)&&(w(this,O).get(p).forEach(k=>ce[p](P,k,p)),w(this,O).delete(p))}else console.warn("No debug mapping found for",p)}onKeyDown(a){a==="h"&&(w(this,M).hidden=!w(this,M).hidden,localStorage.setItem("debug",w(this,M).hidden))}}O=new WeakMap,Z=new WeakMap,oe=new WeakMap,M=new WeakMap,ve=new WeakMap;export{Fs as Mapping};
