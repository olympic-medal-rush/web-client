var We=(d,p,l)=>{if(!p.has(d))throw TypeError("Cannot "+l)};var _=(d,p,l)=>(We(d,p,"read from private field"),l?l.call(d):p.get(d)),et=(d,p,l)=>{if(p.has(d))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(d):p.set(d,l)},it=(d,p,l,u)=>(We(d,p,"write to private field"),u?u.call(d,l):p.set(d,l),l);import{s as nt,E as dt,b as Y,_ as Ze,G as E,g as v,D as ct,h as Zt,M as Vt,i as rn}from"./index-f8bb7fa8.js";import{c as on,g as an}from"./_commonjsHelpers-725317a4.js";import{P as ln,a as pn}from"./debugConfig-0eed7304.js";function un(d,p){for(var l=0;l<p.length;l++){const u=p[l];if(typeof u!="string"&&!Array.isArray(u)){for(const x in u)if(x!=="default"&&!(x in d)){const C=Object.getOwnPropertyDescriptor(u,x);C&&Object.defineProperty(d,x,C.get?C:{enumerable:!0,get:()=>u[x]})}}}return Object.freeze(Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}))}function cn(d,p,l){const u=d.addFolder({title:l,expanded:!1});let x=0;const C=async()=>{const P=Y.$wrapper;if(p.orbitControls)P.style.pointerEvents="",p.orbitControls.dispose(),p.orbitControls=null,p.position.set(0,0,10),p.far=x,p.updateProjectionMatrix();else{P.style.pointerEvents="all";const D=await Ze(()=>import("./OrbitControls-8476f129.js"),["assets/OrbitControls-8476f129.js","assets/index-f8bb7fa8.js","assets/index-4bea3ac6.css"]);p.orbitControls=new D.OrbitControls(p,P),p.orbitControls.enableDamping=!0,p.orbitControls.dampingFactor=.15,p.orbitControls.enableZoom=!0,p.orbitControls.update(),p.position.z+=10,x=p.far,p.far=200,p.updateProjectionMatrix()}},w={Orbit:!1};return new URLSearchParams(location.search).has("orbit")&&(C(),w.Orbit=!0),nt.on(dt.TICK,()=>{var P;return(P=p.orbitControls)==null?void 0:P.update()}),u.addInput(w,"Orbit",{title:"OrbitControls"}).on("change",C),u.addInput(p,"fov"),u.addInput(p,"near"),u.addInput(p,"far"),u.on("change",()=>p.updateProjectionMatrix()),u}function dn(d){}const hn=Object.freeze(Object.defineProperty({__proto__:null,createPane:cn,debug:dn},Symbol.toStringTag,{value:"Module"}));let Jt=0,O,zt,Tt=null,K=null;const Je=Object.entries(rn),b=Zt.data.length-1;function vn(d,p,l){const u=d.addFolder({title:l,expanded:!0});u.addButton({title:"Create Team"}).on("click",()=>{const w=Math.round(Math.random()*(Je.length-1)),c=Je[w];E.game.createTeam({iso:c[0],position:{x:v(0,b),y:v(0,b)}}),console.log("Create Team",c[0])}),u.addButton({title:"Spawn Medals"}).on("click",()=>{const w=[{id:Jt++,type:0,position:{x:v(0,b),y:v(0,b)}},{id:Jt++,type:1,position:{x:v(0,b),y:v(0,b)}},{id:Jt++,type:2,position:{x:v(0,b),y:v(0,b)}}];E.game.addMedals({medals:w})}),u.addButton({title:"Collect Medal"}).on("click",()=>{const w=Array.from(E.game.medals);if(w.length>0){const c={iso:K,medal:w[Math.floor(Math.random()*w.length)][1]};E.game.medalCollect(c)}else alert("There are no more medals")}),u.addSeparator(),nt.on(dt.CREATE_TEAM,()=>C()),nt.on(dt.STATE_READY,()=>C()),K=Y.debug.urlParams.getString("team")||"FRA";function C(){O==null||O.dispose(),zt==null||zt.dispose(),Tt==null||Tt.dispose();const w=[...E.game.teams.keys()].map(c=>({text:c,value:c}));O=u.addBlade({view:"list",label:"Team",options:w,value:K}).on("change",c=>{Y.webgl.camera.playerFocus=Y.webgl.players.get(E.game.teams.get(c.value)),K=c.value}),zt=u.addBlade({view:"buttongrid",size:[3,3],cells:(c,P)=>({title:[["-","UP","-"],["LEFT","-","RIGHT"],["-","DOWN","-"]][P][c]}),label:"Move Team"}).on("click",c=>{O&&c.cell.title!=="-"&&E.game.voteResults({iso:O.value,direction:ct[c.cell.title.toLowerCase()],nextVoteId:0})}),Tt=u.addButton({title:"Get Zone"}).on("click",()=>{if(!(O!=null&&O.value))return;const c=E.game.teams.get(O.value).position;console.log(Zt.mapping[Zt.data[c.y][c.x]],c.x,c.y)})}return u}function bn(d){if(Y.debug.urlParams.has("noServer")){nt.on(dt.KEY_DOWN,l=>{switch(l){case"ArrowUp":E.game.voteResults({iso:K,direction:ct.up,nextVoteId:0});break;case"ArrowDown":E.game.voteResults({iso:K,direction:ct.down,nextVoteId:0});break;case"ArrowLeft":E.game.voteResults({iso:K,direction:ct.left,nextVoteId:0});break;case"ArrowRight":E.game.voteResults({iso:K,direction:ct.right,nextVoteId:0});break}}),E.game.setState({userId:"userId",teamsState:{FRA:{iso:"FRA",position:{x:v(0,b),y:v(0,b)},medals:{0:5,1:2,2:15}},ESP:{iso:"ESP",position:{x:v(0,b),y:v(0,b)},medals:{0:1,1:2,2:3}},AFG:{iso:"AFG",position:{x:v(0,b),y:v(0,b)},medals:{0:50,1:4,2:12}}},medalsInGame:[{id:-4,type:Vt.bronze,position:{x:v(0,b),y:v(0,b)}},{id:-3,type:Vt.gold,position:{x:v(0,b),y:v(0,b)}},{id:-2,type:Vt.gold,position:{x:v(0,b),y:v(0,b)}},{id:-1,type:Vt.silver,position:{x:v(0,b),y:v(0,b)}}]});const p=Y.debug.urlParams.getString("team")||"FRA";E.game.userJoin({iso:p,voteId:1,voteProgress:.5,votes:{down:25,left:25,right:25,up:25}})}}const mn=Object.freeze(Object.defineProperty({__proto__:null,createPane:vn,debug:bn},Symbol.toStringTag,{value:"Module"}));function gn(d){}const _n=Object.freeze(Object.defineProperty({__proto__:null,debug:gn},Symbol.toStringTag,{value:"Module"}));function fn(d,p,l){const u=d.addFolder({title:l,expanded:!1});return u.addMonitor(p.info.memory,"geometries",{label:"Geometries"}),u.addMonitor(p.info.memory,"textures",{label:"Textures"}),u.addMonitor(p.info.programs,"length",{label:"Programs"}),u.addMonitor(p.info.render,"calls",{label:"Calls"}),u.addMonitor(p.info.render,"points",{label:"Points"}),u.addMonitor(p.info.render,"triangles",{label:"Triangles"}),p.info.autoReset=!1,nt.on(dt.RENDER,()=>p.info.reset()),u}function wn(d){}const xn=Object.freeze(Object.defineProperty({__proto__:null,createPane:fn,debug:wn},Symbol.toStringTag,{value:"Module"}));var ht={},Cn={get exports(){return ht},set exports(d){ht=d}};(function(d,p){(function(l,u){u(p)})(on,function(l){class u{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class x{constructor(t){this.target=t}}class C extends x{constructor(t,e,s,n){super(t),this.value=e,this.presetKey=s,this.last=n??!0}}function w(i){return i}function c(i){return i==null}const P={alreadydisposed:()=>"View has been already disposed",invalidparams:i=>`Invalid parameters for '${i.name}'`,nomatchingcontroller:i=>`No matching controller for '${i.key}'`,nomatchingview:i=>`No matching view for '${JSON.stringify(i.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:i=>`Property '${i.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class D{constructor(t){var e;this.message=(e=P[t.type](t.context))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new D({type:"alreadydisposed"})}static notBindable(){return new D({type:"notbindable"})}static propertyNotFound(t){return new D({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new D({type:"shouldneverhappen"})}}class S{constructor(){this.observers_={}}on(t,e){let s=this.observers_[t];return s||(s=this.observers_[t]=[]),s.push({handler:e}),this}off(t,e){const s=this.observers_[t];return s&&(this.observers_[t]=s.filter(n=>n.handler!==e)),this}emit(t,e){const s=this.observers_[t];s&&s.forEach(n=>{n.handler(e)})}}const Qe="tp";function m(i){return(e,s)=>[Qe,"-",i,"v",e?`_${e}`:"",s?`-${s}`:""].join("")}function ti(i,t){return e=>t(i(e))}function ei(i){return i.rawValue}function B(i,t){i.emitter.on("change",ti(ei,t)),t(i.rawValue)}function W(i,t,e){B(i.value(t),e)}function ii(i,t,e){e?i.classList.add(t):i.classList.remove(t)}function bt(i,t){return e=>{ii(i,t,e)}}function si(i,t){B(i,e=>{t.textContent=e??""})}const Mt=m("btn");class ni{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Mt()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("button");s.classList.add(Mt("b")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const n=t.createElement("div");n.classList.add(Mt("t")),si(e.props.value("title"),n),this.buttonElement.appendChild(n)}}class ri{constructor(t,e){this.emitter=new S,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new ni(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class oi{constructor(t,e){var s;this.constraint_=e==null?void 0:e.constraint,this.equals_=(s=e==null?void 0:e.equals)!==null&&s!==void 0?s:(n,r)=>n===r,this.emitter=new S,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const s=e??{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t,r=this.rawValue_;this.equals_(r,n)&&!s.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:s,previousRawValue:r,rawValue:n,sender:this}))}}class ai{constructor(t){this.emitter=new S,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const s=e??{forceEmit:!1,last:!0},n=this.value_;n===t&&!s.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:s,previousRawValue:n,rawValue:this.value_,sender:this}))}}function R(i,t){const e=t==null?void 0:t.constraint,s=t==null?void 0:t.equals;return!e&&!s?new ai(i):new oi(i,t)}class g{constructor(t){this.emitter=new S,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}static createCore(t){return Object.keys(t).reduce((s,n)=>Object.assign(s,{[n]:R(t[n])}),{})}static fromObject(t){const e=this.createCore(t);return new g(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function li(i,t){const s=Object.keys(t).reduce((n,r)=>{if(n===void 0)return;const o=t[r],a=o(i[r]);return a.succeeded?Object.assign(Object.assign({},n),{[r]:a.value}):void 0},{});return s}function pi(i,t){return i.reduce((e,s)=>{if(e===void 0)return;const n=t(s);if(!(!n.succeeded||n.value===void 0))return[...e,n.value]},[])}function ui(i){return i===null?!1:typeof i=="object"}function N(i){return t=>e=>{if(!t&&e===void 0)return{succeeded:!1,value:void 0};if(t&&e===void 0)return{succeeded:!0,value:void 0};const s=i(e);return s!==void 0?{succeeded:!0,value:s}:{succeeded:!1,value:void 0}}}function Qt(i){return{custom:t=>N(t)(i),boolean:N(t=>typeof t=="boolean"?t:void 0)(i),number:N(t=>typeof t=="number"?t:void 0)(i),string:N(t=>typeof t=="string"?t:void 0)(i),function:N(t=>typeof t=="function"?t:void 0)(i),constant:t=>N(e=>e===t?t:void 0)(i),raw:N(t=>t)(i),object:t=>N(e=>{if(ui(e))return li(e,t)})(i),array:t=>N(e=>{if(Array.isArray(e))return pi(e,t)})(i)}}const F={optional:Qt(!0),required:Qt(!1)};function J(i,t){const e=F.required.object(t)(i);return e.succeeded?e.value:void 0}function ci(i){console.warn([`Missing '${i.key}' of ${i.target} in ${i.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function di(i){return i&&i.parentElement&&i.parentElement.removeChild(i),null}class Dt{constructor(t){this.value_=t}static create(t){return[new Dt(t),(e,s)=>{t.setRawValue(e,s)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const hi=m("");function te(i,t){return bt(i,hi(void 0,t))}class U extends g{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Dt.create(R(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,s,n;const r=t??{};return new U(g.createCore({disabled:(e=r.disabled)!==null&&e!==void 0?e:!1,disposed:!1,hidden:(s=r.hidden)!==null&&s!==void 0?s:!1,parent:(n=r.parent)!==null&&n!==void 0?n:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){B(this.globalDisabled_,te(t,"disabled")),W(this,"hidden",te(t,"hidden"))}bindDisabled(t){B(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){B(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}getGlobalDisabled_(){const t=this.get("parent");return(t?t.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const s=t.previousRawValue;s==null||s.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function vi(){return["veryfirst","first","last","verylast"]}const ee=m(""),ie={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class se{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{vi().forEach(s=>{e.classList.remove(ee(void 0,ie[s]))}),this.blade.get("positions").forEach(s=>{e.classList.add(ee(void 0,ie[s]))})}),this.viewProps.handleDispose(()=>{di(e)})}get parent(){return this.parent_}set parent(t){if(this.parent_=t,!("parent"in this.viewProps.valMap_)){ci({key:"parent",target:U.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const k="http://www.w3.org/2000/svg";function mt(i){i.offsetHeight}function bi(i,t){const e=i.style.transition;i.style.transition="none",t(),i.style.transition=e}function ne(i){return i.ontouchstart!==void 0}function mi(i){for(;i.childNodes.length>0;)i.removeChild(i.childNodes[0])}function gi(i){return i.relatedTarget?i.relatedTarget:"explicitOriginalTarget"in i?i.explicitOriginalTarget:null}const rt=m("lbl");function _i(i,t){const e=i.createDocumentFragment();return t.split(`
`).map(n=>i.createTextNode(n)).forEach((n,r)=>{r>0&&e.appendChild(i.createElement("br")),e.appendChild(n)}),e}class re{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(rt()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(rt("l")),W(e.props,"label",r=>{c(r)?this.element.classList.add(rt(void 0,"nol")):(this.element.classList.remove(rt(void 0,"nol")),mi(s),s.appendChild(_i(t,r)))}),this.element.appendChild(s),this.labelElement=s;const n=t.createElement("div");n.classList.add(rt("v")),this.element.appendChild(n),this.valueElement=n}}class gt extends se{constructor(t,e){const s=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new re(t,{props:e.props,viewProps:s}),viewProps:s})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class fi extends se{constructor(t){super(t),this.value=t.value}}class Lt extends g{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},s=g.createCore(e);return new Lt(s)}get styleExpanded(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!c(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const s=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};W(this,"expanded",s),W(this,"temporaryExpanded",s)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function wi(i){return Lt.create(i)}function xi(i,t){let e=0;return bi(t,()=>{i.set("expandedHeight",null),i.set("temporaryExpanded",!0),mt(t),e=t.clientHeight,i.set("temporaryExpanded",null),mt(t)}),e}function oe(i,t){t.style.height=i.styleHeight}function Ci(i,t){i.value("expanded").emitter.on("beforechange",()=>{i.set("completed",!1),c(i.get("expandedHeight"))&&i.set("expandedHeight",xi(i,t)),i.set("shouldFixHeight",!0),mt(t)}),i.emitter.on("change",()=>{oe(i,t)}),oe(i,t),t.addEventListener("transitionend",e=>{e.propertyName==="height"&&i.cleanUpTransition()})}class ae{constructor(t,e){const s=m(e.viewName);this.element=t.createElement("div"),this.element.classList.add(s()),e.viewProps.bindClassModifiers(this.element)}}class _t extends fi{constructor(t,e){const s=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new re(t,{props:e.props,viewProps:s}),viewProps:s})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class yi{constructor(){this.disabled=!1,this.emitter=new S}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Ei{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new S,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class le{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((e,s)=>s.constrain(e),t)}}function ft(i,t){if(i instanceof t)return i;if(i instanceof le){const e=i.constraints.reduce((s,n)=>s||(n instanceof t?n:null),null);if(e)return e}return null}class pe{constructor(t){this.values=g.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),s=this.values.get("min");return Math.min(Math.max(t,s),e)}}class St{constructor(t){this.values=g.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),s=this.values.get("min");let n=t;return c(s)||(n=Math.max(n,s)),c(e)||(n=Math.min(n,e)),n}}class wt{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step,s=Math.round((t-e)/this.step);return e+s*this.step}}const ue=m("pop");class Pi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ue()),e.viewProps.bindClassModifiers(this.element),B(e.shows,bt(this.element,ue(void 0,"v")))}}class ki{constructor(t,e){this.shows=R(!1),this.viewProps=e.viewProps,this.view=new Pi(t,{shows:this.shows,viewProps:this.viewProps})}}const ce=m("txt");class Vi{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ce()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const s=t.createElement("input");s.classList.add(ce("i")),s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class zi{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Vi(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const s=t.currentTarget.value,n=this.parser_(s);c(n)||(this.value.rawValue=n),this.view.refresh()}}function Ti(i){return i==="false"?!1:!!i}class Mi{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const Di={"**":(i,t)=>Math.pow(i,t),"*":(i,t)=>i*t,"/":(i,t)=>i/t,"%":(i,t)=>i%t,"+":(i,t)=>i+t,"-":(i,t)=>i-t,"<<":(i,t)=>i<<t,">>":(i,t)=>i>>t,">>>":(i,t)=>i>>>t,"&":(i,t)=>i&t,"^":(i,t)=>i^t,"|":(i,t)=>i|t};class Li{constructor(t,e,s){this.left=e,this.operator=t,this.right=s}evaluate(){const t=Di[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Si={"+":i=>i,"-":i=>-i,"~":i=>~i};class Ri{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=Si[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Rt(i){return(t,e)=>{for(let s=0;s<i.length;s++){const n=i[s](t,e);if(n!=="")return n}return""}}function ot(i,t){var e;const s=i.substr(t).match(/^\s+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Oi(i,t){const e=i.substr(t,1);return e.match(/^[1-9]$/)?e:""}function at(i,t){var e;const s=i.substr(t).match(/^[0-9]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Ai(i,t){const e=at(i,t);if(e!=="")return e;const s=i.substr(t,1);if(t+=1,s!=="-"&&s!=="+")return"";const n=at(i,t);return n===""?"":s+n}function Ot(i,t){const e=i.substr(t,1);if(t+=1,e.toLowerCase()!=="e")return"";const s=Ai(i,t);return s===""?"":e+s}function de(i,t){const e=i.substr(t,1);if(e==="0")return e;const s=Oi(i,t);return t+=s.length,s===""?"":s+at(i,t)}function Bi(i,t){const e=de(i,t);if(t+=e.length,e==="")return"";const s=i.substr(t,1);if(t+=s.length,s!==".")return"";const n=at(i,t);return t+=n.length,e+s+n+Ot(i,t)}function Ni(i,t){const e=i.substr(t,1);if(t+=e.length,e!==".")return"";const s=at(i,t);return t+=s.length,s===""?"":e+s+Ot(i,t)}function Ii(i,t){const e=de(i,t);return t+=e.length,e===""?"":e+Ot(i,t)}const ji=Rt([Bi,Ni,Ii]);function $i(i,t){var e;const s=i.substr(t).match(/^[01]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Gi(i,t){const e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0b")return"";const s=$i(i,t);return s===""?"":e+s}function Ki(i,t){var e;const s=i.substr(t).match(/^[0-7]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Fi(i,t){const e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0o")return"";const s=Ki(i,t);return s===""?"":e+s}function Ui(i,t){var e;const s=i.substr(t).match(/^[0-9a-f]+/i);return(e=s&&s[0])!==null&&e!==void 0?e:""}function qi(i,t){const e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0x")return"";const s=Ui(i,t);return s===""?"":e+s}const Hi=Rt([Gi,Fi,qi]),Xi=Rt([Hi,ji]);function Yi(i,t){const e=Xi(i,t);return t+=e.length,e===""?null:{evaluable:new Mi(e),cursor:t}}function Wi(i,t){const e=i.substr(t,1);if(t+=e.length,e!=="(")return null;const s=ve(i,t);if(!s)return null;t=s.cursor,t+=ot(i,t).length;const n=i.substr(t,1);return t+=n.length,n!==")"?null:{evaluable:s.evaluable,cursor:t}}function Ji(i,t){var e;return(e=Yi(i,t))!==null&&e!==void 0?e:Wi(i,t)}function he(i,t){const e=Ji(i,t);if(e)return e;const s=i.substr(t,1);if(t+=s.length,s!=="+"&&s!=="-"&&s!=="~")return null;const n=he(i,t);return n?(t=n.cursor,{cursor:t,evaluable:new Ri(s,n.evaluable)}):null}function Zi(i,t,e){e+=ot(t,e).length;const s=i.filter(n=>t.startsWith(n,e))[0];return s?(e+=s.length,e+=ot(t,e).length,{cursor:e,operator:s}):null}function Qi(i,t){return(e,s)=>{const n=i(e,s);if(!n)return null;s=n.cursor;let r=n.evaluable;for(;;){const o=Zi(t,e,s);if(!o)break;s=o.cursor;const a=i(e,s);if(!a)return null;s=a.cursor,r=new Li(o.operator,r,a.evaluable)}return r?{cursor:s,evaluable:r}:null}}const ts=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((i,t)=>Qi(i,t),he);function ve(i,t){return t+=ot(i,t).length,ts(i,t)}function es(i){const t=ve(i,0);return!t||t.cursor+ot(i,t.cursor).length!==i.length?null:t.evaluable}function xt(i){var t;const e=es(i);return(t=e==null?void 0:e.evaluate())!==null&&t!==void 0?t:null}function is(i){if(typeof i=="number")return i;if(typeof i=="string"){const t=xt(i);if(!c(t))return t}return 0}function y(i){return t=>t.toFixed(Math.max(Math.min(i,20),0))}const ss=y(0);function Ct(i){return ss(i)+"%"}function ns(i){return String(i)}function be(i,t){for(;i.length<t;)i.push(void 0)}function rs(i){const t=[];return be(t,i),R(t)}function os(i){const t=i.indexOf(void 0);return t<0?i:i.slice(0,t)}function as(i,t){const e=[...os(i),t];return e.length>i.length?e.splice(0,e.length-i.length):be(e,i.length),e}function me({primary:i,secondary:t,forward:e,backward:s}){let n=!1;function r(o){n||(n=!0,o(),n=!1)}i.emitter.on("change",o=>{r(()=>{t.setRawValue(e(i,t),o.options)})}),t.emitter.on("change",o=>{r(()=>{i.setRawValue(s(i,t),o.options)}),r(()=>{t.setRawValue(e(i,t),o.options)})}),r(()=>{t.setRawValue(e(i,t),{forceEmit:!1,last:!0})})}function Z(i,t){const e=i*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+e:t.downKey?-e:0}function yt(i){return{altKey:i.altKey,downKey:i.key==="ArrowDown",shiftKey:i.shiftKey,upKey:i.key==="ArrowUp"}}function ge(i){return{altKey:i.altKey,downKey:i.key==="ArrowLeft",shiftKey:i.shiftKey,upKey:i.key==="ArrowRight"}}function ls(i){return i==="ArrowUp"||i==="ArrowDown"}function _e(i){return ls(i)||i==="ArrowLeft"||i==="ArrowRight"}function At(i,t){var e,s;const n=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:i.pageX-(((e=n&&n.scrollX)!==null&&e!==void 0?e:0)+r.left),y:i.pageY-(((s=n&&n.scrollY)!==null&&s!==void 0?s:0)+r.top)}}class Et{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new S,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),(e=t.currentTarget)===null||e===void 0||e.focus();const s=this.elem_.ownerDocument;s.addEventListener("mousemove",this.onDocumentMouseMove_),s.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(At(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(At(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(At(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),s=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-s.left,y:e.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),s=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-s.left,y:e.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const s=(e=t.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(s?{x:s.clientX-n.left,y:s.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function f(i,t,e,s,n){const r=(i-t)/(e-t);return s+r*(n-s)}function fe(i){return String(i.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Q(i,t,e){return Math.min(Math.max(i,t),e)}const z=m("txt");class ps{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(z(),z(void 0,"num")),e.arrayPosition&&this.element.classList.add(z(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("input");s.classList.add(z("i")),s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(z()),this.inputElement.classList.add(z("i"));const n=t.createElement("div");n.classList.add(z("k")),this.element.appendChild(n),this.knobElement=n;const r=t.createElementNS(k,"svg");r.classList.add(z("g")),this.knobElement.appendChild(r);const o=t.createElementNS(k,"path");o.classList.add(z("gb")),r.appendChild(o),this.guideBodyElem_=o;const a=t.createElementNS(k,"path");a.classList.add(z("gh")),r.appendChild(a),this.guideHeadElem_=a;const h=t.createElement("div");h.classList.add(m("tt")()),this.knobElement.appendChild(h),this.tooltipElem_=h,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(t.rawValue===null){this.element.classList.remove(z(void 0,"drg"));return}this.element.classList.add(z(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),s=e+(e>0?-1:e<0?1:0),n=Q(-s,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${s+n},0 L${s},4 L${s+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class us{constructor(t,e){var s;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=(s=e.sliderProps)!==null&&s!==void 0?s:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=R(null),this.view=new ps(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new Et(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,s;const n=(e=this.sliderProps_)===null||e===void 0?void 0:e.get("minValue"),r=(s=this.sliderProps_)===null||s===void 0?void 0:s.get("maxValue");let o=t;return n!==void 0&&(o=Math.max(o,n)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(t){const s=t.currentTarget.value,n=this.parser_(s);c(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(t){const e=Z(this.baseStep_,yt(t));e!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){Z(this.baseStep_,yt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function Bt(i,t){i.write(t)}function cs(i){const t=i?ft(i,wt):null;return t?t.step:null}function ds(i,t){const e=i&&ft(i,wt);return e?fe(e.step):Math.max(fe(t),2)}function we(i){const t=cs(i);return t??1}function hs(i,t){var e;const s=i&&ft(i,wt),n=Math.abs((e=s==null?void 0:s.step)!==null&&e!==void 0?e:t);return n===0?.1:Math.pow(10,Math.floor(Math.log10(n))-1)}function Pt(i){return[i[0],i[1],i[2]]}function xe(i){const t=Q(Math.floor(i),0,255).toString(16);return t.length===1?`0${t}`:t}function vs(i,t="#"){const e=Pt(i.getComponents("rgb")).map(xe).join("");return`${t}${e}`}function bs(i,t="#"){const e=i.getComponents("rgb"),s=[e[0],e[1],e[2],e[3]*255].map(xe).join("");return`${t}${s}`}function ms(i,t){const e=y(t==="float"?2:0);return`rgb(${Pt(i.getComponents("rgb",t)).map(n=>e(n)).join(", ")})`}function gs(i){return t=>ms(t,i)}function _s(i,t){const e=y(2),s=y(t==="float"?2:0);return`rgba(${i.getComponents("rgb",t).map((r,o)=>(o===3?e:s)(r)).join(", ")})`}function fs(i){return t=>_s(t,i)}function ws(i){const t=[y(0),Ct,Ct];return`hsl(${Pt(i.getComponents("hsl")).map((s,n)=>t[n](s)).join(", ")})`}function xs(i){const t=[y(0),Ct,Ct,y(2)];return`hsla(${i.getComponents("hsl").map((s,n)=>t[n](s)).join(", ")})`}function Cs(i,t){const e=y(t==="float"?2:0),s=["r","g","b"];return`{${Pt(i.getComponents("rgb",t)).map((r,o)=>`${s[o]}: ${e(r)}`).join(", ")}}`}function ys(i){return t=>Cs(t,i)}function Es(i,t){const e=y(2),s=y(t==="float"?2:0),n=["r","g","b","a"];return`{${i.getComponents("rgb",t).map((o,a)=>{const h=a===3?e:s;return`${n[a]}: ${h(o)}`}).join(", ")}}`}function Ps(i){return t=>Es(t,i)}[...["int","float"].reduce((i,t)=>[...i,{format:{alpha:!1,mode:"rgb",notation:"func",type:t},stringifier:gs(t)},{format:{alpha:!0,mode:"rgb",notation:"func",type:t},stringifier:fs(t)},{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:ys(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:Ps(t)}],[])];class ks{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((s,n)=>{var r,o;return(o=(r=this.components[n])===null||r===void 0?void 0:r.constrain(s))!==null&&o!==void 0?o:s});return this.asm_.fromComponents(e)}}const Ce=m("pndtxt");class Vs{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Ce()),this.textViews.forEach(s=>{const n=t.createElement("div");n.classList.add(Ce("a")),n.appendChild(s.element),this.element.appendChild(n)})}}function zs(i,t,e){return new us(i,{arrayPosition:e===0?"fst":e===t.axes.length-1?"lst":"mid",baseStep:t.axes[e].baseStep,parser:t.parser,props:t.axes[e].textProps,value:R(0,{constraint:t.axes[e].constraint}),viewProps:t.viewProps})}class Nt{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((s,n)=>zs(t,e,n)),this.acs_.forEach((s,n)=>{me({primary:this.value,secondary:s.value,forward:r=>e.assembly.toComponents(r.rawValue)[n],backward:(r,o)=>{const a=e.assembly.toComponents(r.rawValue);return a[n]=o.rawValue,e.assembly.fromComponents(a)}})}),this.view=new Vs(t,{textViews:this.acs_.map(s=>s.view)})}}function Ts(i,t){return"step"in i&&!c(i.step)?new wt(i.step,t):null}function Ms(i){return!c(i.max)&&!c(i.min)?new pe({max:i.max,min:i.min}):!c(i.max)||!c(i.min)?new St({max:i.max,min:i.min}):null}const Ds={monitor:{defaultInterval:200,defaultLineCount:3}},j=m("grl");class Ls{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(j()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const s=t.createElementNS(k,"svg");s.classList.add(j("g")),s.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(s),this.svgElem_=s;const n=t.createElementNS(k,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const r=t.createElement("div");r.classList.add(j("t"),m("tt")()),this.element.appendChild(r),this.tooltipElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,s=this.props_.get("minValue"),n=this.props_.get("maxValue"),r=[];this.value.rawValue.forEach((I,Wt)=>{if(I===void 0)return;const sn=f(Wt,0,e,0,t.width),nn=f(I,s,n,t.height,0);r.push([sn,nn].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){o.classList.remove(j("t","a"));return}const h=f(this.cursor_.rawValue,0,e,0,t.width),M=f(a,s,n,t.height,0);o.style.left=`${h}px`,o.style.top=`${M}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains(j("t","a"))||(o.classList.add(j("t","a"),j("t","in")),mt(o),o.classList.remove(j("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Ss{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=R(-1),this.view=new Ls(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!ne(t))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const s=new Et(this.view.element);s.emitter.on("down",this.onGraphPointerDown_),s.emitter.on("move",this.onGraphPointerMove_),s.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(f(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){if(!t.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(f(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class ye{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return(t=this.controller_.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const s=e.bind(this);return this.controller_.emitter.on(t,()=>{s(new x(this))}),this}}class Rs extends x{constructor(t,e,s){super(t),this.cell=e,this.index=s}}class Ee extends u{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new S;const e=this.controller_.valueController;e.cellControllers.forEach((s,n)=>{const r=new ye(s);this.cellToApiMap_.set(s,r),s.emitter.on("click",()=>{const o=n%e.size[0],a=Math.floor(n/e.size[0]);this.emitter_.emit("click",{event:new Rs(this,r,[o,a])})})})}cell(t,e){const s=this.controller_.valueController,n=s.cellControllers[e*s.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const s=e.bind(this);return this.emitter_.on(t,n=>{s(n.event)}),this}}class It{constructor(t,e){this.size=e.size;const[s,n]=this.size,r=[];for(let o=0;o<n;o++)for(let a=0;a<s;a++){const h=new ri(t,{props:g.fromObject(Object.assign({},e.cellConfig(a,o))),viewProps:U.create()});r.push(h)}this.cellCs_=r,this.viewProps=U.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(o=>{o.viewProps.set("disposed",!0)})}),this.view=new ae(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${s}, 1fr)`,this.cellCs_.forEach(o=>{this.view.element.appendChild(o.view.element)})}get cellControllers(){return this.cellCs_}}const Os={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const t=F,e=J(i,{cells:t.required.function,size:t.required.array(t.required.number),view:t.required.constant("buttongrid"),label:t.optional.string});return e?{params:e}:null},controller(i){return new gt(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:new It(i.document,{cellConfig:i.params.cells,size:i.params.size})})},api(i){return!(i.controller instanceof gt)||!(i.controller.valueController instanceof It)?null:new Ee(i.controller)}};class Pe extends u{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const s=e.bind(this);return this.controller_.valueController.value.emitter.on(t,n=>{s(new C(this,n.rawValue,void 0,n.options.last))}),this}}function T(i,t,e){return i*(1-e)+t*e}const As=20,Bs=.001,jt=100;function Ns(i,t){let e=.25,s=.5,n=-1;for(let r=0;r<As;r++){const[o,a]=i.curve(s);if(s+=e*(o<t?1:-1),n=a,e*=.5,Math.abs(t-o)<Bs)break}return n}class ${constructor(t=0,e=0,s=1,n=1){this.cache_=[],this.comps_=[t,e,s,n]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return c(t)||!Array.isArray(t)?!1:typeof t[0]=="number"&&typeof t[1]=="number"&&typeof t[2]=="number"&&typeof t[3]=="number"}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=T(0,this.x1,t),s=T(0,this.y1,t),n=T(this.x1,this.x2,t),r=T(this.y1,this.y2,t),o=T(this.x2,1,t),a=T(this.y2,1,t),h=T(e,n,t),M=T(s,r,t),I=T(n,o,t),Wt=T(r,a,t);return[T(h,I,t),T(M,Wt,t)]}y(t){if(this.cache_.length===0){const e=[];for(let s=0;s<jt;s++)e.push(Ns(this,f(s,0,jt-1,0,1)));this.cache_=e}return this.cache_[Math.round(f(Q(t,0,1),0,1,0,jt-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const $t={toComponents:i=>i.toObject(),fromComponents:i=>new $(...i)};function Is(i){const t=y(2);return`cubic-bezier(${i.toObject().map(s=>t(s)).join(", ")})`}const ke=[0,.5,.5,1];function js(i){const t=i.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!t)return new $(...ke);const e=[t[1],t[2],t[3],t[4]].reduce((s,n)=>{if(!s)return null;const r=Number(n);return isNaN(r)?null:[...s,r]},[]);return new $(...e??ke)}const q=m("cbz");class Ve{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(q()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,q(void 0,"expanded")),W(e.foldable,"completed",bt(this.element,q(void 0,"cpl")));const s=t.createElement("div");s.classList.add(q("h")),this.element.appendChild(s);const n=t.createElement("button");n.classList.add(q("b")),e.viewProps.bindDisabled(n);const r=t.createElementNS(k,"svg");r.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',n.appendChild(r),s.appendChild(n),this.buttonElement=n;const o=t.createElement("div");if(o.classList.add(q("t")),s.appendChild(o),this.textElement=o,e.pickerLayout==="inline"){const a=t.createElement("div");a.classList.add(q("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}const Gt=m("cbzp");class ze{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Gt()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Gt("g")),this.element.appendChild(s),this.graphElement=s;const n=t.createElement("div");n.classList.add(Gt("t")),this.element.appendChild(n),this.textElement=n}}function Te(i,t){const e=new MutationObserver(n=>{for(const r of n)r.type==="childList"&&r.addedNodes.forEach(o=>{o.contains(o)&&(t(),e.disconnect())})}),s=i.ownerDocument;e.observe(s.body,{attributes:!0,childList:!0,subtree:!0})}const G=m("cbzg");function $s(i,t){return e=>t(i(e))}class Me{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(G()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("div");s.classList.add(G("p")),this.element.appendChild(s),this.previewElement=s;const n=t.createElementNS(k,"svg");n.classList.add(G("g")),this.element.appendChild(n),this.svgElem_=n;const r=t.createElementNS(k,"path");r.classList.add(G("u")),this.svgElem_.appendChild(r),this.guideElem_=r;const o=t.createElementNS(k,"polyline");o.classList.add(G("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach(a=>{a.classList.add(G("h")),this.element.appendChild(a)}),this.vectorElems_=[t.createElementNS(k,"line"),t.createElementNS(k,"line")],this.vectorElems_.forEach(a=>{a.classList.add(G("v")),this.svgElem_.appendChild(a)}),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach((a,h)=>{B(this.sel_,$s(M=>M===h,bt(a,G("h","sel"))))}),Te(this.element,()=>{this.refresh()})}getVertMargin_(t){return t*.25}valueToPosition(t,e){const s=this.element.getBoundingClientRect(),n=s.width,r=s.height,o=this.getVertMargin_(r);return{x:f(t,0,1,0,n),y:f(e,0,1,r-o,o)}}positionToValue(t,e){const s=this.element.getBoundingClientRect(),n=s.width,r=s.height,o=this.getVertMargin_(r);return{x:Q(f(t,0,n,0,1),0,1),y:f(e,r-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(r=>{const o=this.valueToPosition(0,r),a=this.valueToPosition(1,r);return[`M ${o.x},${o.y}`,`L ${a.x},${a.y}`].join(" ")}).join(" "));const t=this.value_.rawValue,e=[];let s=0;for(;;){const r=this.valueToPosition(...t.curve(s));if(e.push([r.x,r.y].join(",")),s>=1)break;s=Math.min(s+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const n=t.toObject();[0,1].forEach(r=>{const o=this.valueToPosition(r,r),a=this.valueToPosition(n[r*2],n[r*2+1]),h=this.vectorElems_[r];h.setAttributeNS(null,"x1",String(o.x)),h.setAttributeNS(null,"y1",String(o.y)),h.setAttributeNS(null,"x2",String(a.x)),h.setAttributeNS(null,"y2",String(a.y));const M=this.handleElems_[r];M.style.left=`${a.x}px`,M.style.top=`${a.y}px`})}onValueChange_(){this.refresh()}}const De=24,Le=400,Se=1e3,tt=m("cbzprv");class Re{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(tt()),e.viewProps.bindClassModifiers(this.element);const s=t.createElementNS(k,"svg");s.classList.add(tt("g")),this.element.appendChild(s),this.svgElem_=s;const n=t.createElementNS(k,"path");n.classList.add(tt("t")),this.svgElem_.appendChild(n),this.ticksElem_=n;const r=t.createElement("div");r.classList.add(tt("m")),this.element.appendChild(r),this.markerElem_=r,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),Te(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(tt("m","a")),this.startTime_=new Date().getTime()+Le,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(tt("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(Q(t,0,1));this.markerElem_.style.left=`${e*100}%`}refresh(){const t=this.svgElem_.getBoundingClientRect(),e=t.width,s=t.height,n=[],r=this.value_.rawValue;for(let o=0;o<De;o++){const a=f(o,0,De-1,0,1),h=f(r.y(a),0,1,0,e);n.push(`M ${h},0 v${s}`)}this.ticksElem_.setAttributeNS(null,"d",n.join(" "))}onTimer_(){if(this.startTime_===null)return;const t=new Date().getTime()-this.startTime_,e=t/Se;this.updateMarker_(e),t>Se+Le&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function Kt(i,t,e,s){const n=e-i,r=s-t;return Math.sqrt(n*n+r*r)}function Gs(i,t,e,s){const n=Kt(i,t,e,s),r=Math.atan2(s-t,e-i),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:i+Math.cos(o)*n,y:t+Math.sin(o)*n}}class Oe{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=R(0),this.viewProps=e.viewProps,this.view=new Me(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new Re(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",n=>{n.stopImmediatePropagation(),n.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const s=new Et(this.view.element);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e,s){const n=this.sel_.rawValue,r=this.value.rawValue.toObject(),o=this.view.positionToValue(t.x,t.y),a=e?Gs(n,n,o.x,o.y):o;r[n*2]=a.x,r[n*2+1]=a.y,this.value.setRawValue(new $(...r),s)}onPointerDown_(t){const e=t.data;if(!e.point)return;const s=this.value.rawValue,n=this.view.valueToPosition(s.x1,s.y1),r=Kt(e.point.x,e.point.y,n.x,n.y),o=this.view.valueToPosition(s.x2,s.y2),a=Kt(e.point.x,e.point.y,o.x,o.y);this.sel_.rawValue=r<=a?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(t){_e(t.key)&&t.preventDefault();const e=this.sel_.rawValue,s=this.value.rawValue.toObject();s[e*2]+=Z(this.baseStep_,ge(t)),s[e*2+1]+=Z(this.baseStep_,yt(t)),this.value.setRawValue(new $(...s),{forceEmit:!1,last:!1})}onKeyUp_(t){_e(t.key)&&t.preventDefault();const e=Z(this.baseStep_,ge(t)),s=Z(this.baseStep_,yt(t));e===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ae{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ze(t,{viewProps:this.viewProps}),this.gc_=new Oe(t,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const s=Object.assign(Object.assign({},e.axis),{constraint:new St({max:1,min:0})}),n=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new Nt(t,{assembly:$t,axes:[s,n,s,n],parser:xt,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(t=>t.inputElement)]}refresh(){this.gc_.refresh()}}class Ft{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=wi(e.expanded),this.view=new Ve(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new zi(t,{parser:js,props:g.fromObject({formatter:Is}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=e.pickerLayout==="popup"?new ki(t,{viewProps:this.viewProps}):null;const s=new Ae(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});s.allFocusableElements.forEach(n=>{n.addEventListener("blur",this.onPopupChildBlur_),n.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),B(this.popC_.shows,n=>{n&&s.refresh()}),me({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:n=>n.rawValue,backward:(n,r)=>r.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ci(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;(!e||!this.popC_.view.element.contains(e))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,s=gi(t);s&&e.contains(s)||s&&s===this.view.buttonElement&&!ne(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_&&t.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function Ks(){return new ks({assembly:$t,components:[0,1,2,3].map(i=>i%2===0?new St({min:0,max:1}):void 0)})}const Fs={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const t=F,e=J(i,{value:t.required.array(t.required.number),view:t.required.constant("cubicbezier"),expanded:t.optional.boolean,label:t.optional.string,picker:t.optional.custom(s=>s==="inline"||s==="popup"?s:void 0)});return e?{params:e}:null},controller(i){var t,e;const s=new $(...i.params.value),n=R(s,{constraint:Ks(),equals:$.equals}),r=new Ft(i.document,{axis:{baseStep:.1,textProps:g.fromObject({draggingScale:.01,formatter:y(2)})},expanded:(t=i.params.expanded)!==null&&t!==void 0?t:!1,pickerLayout:(e=i.params.picker)!==null&&e!==void 0?e:"popup",value:n,viewProps:i.viewProps});return new _t(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:r})},api(i){return!(i.controller instanceof _t)||!(i.controller.valueController instanceof Ft)?null:new Pe(i.controller)}};class Be extends u{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Ne=20;class Ie{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(this.timestamps_.length===0)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=Ne)return;const t=this.timestamps_.length-Ne;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach(s=>{s.frameCount-=e}),this.frameCount_-=e}end(t){if(this.start_===null)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const lt=m("fps");class je{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(lt()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(lt("g")),this.element.appendChild(this.graphElement);const s=t.createElement("div");s.classList.add(lt("l")),this.element.appendChild(s);const n=t.createElement("span");n.classList.add(lt("v")),n.textContent="--",s.appendChild(n),this.valueElement=n;const r=t.createElement("span");r.classList.add(lt("u")),r.textContent="FPS",s.appendChild(r)}}class Ut{constructor(t,e){this.stopwatch_=new Ie,this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new je(t,{viewProps:this.viewProps}),this.graphC_=new Ss(t,{formatter:y(0),lineCount:e.lineCount,props:g.fromObject({maxValue:e.maxValue,minValue:e.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()})}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.stopwatch_.fps;if(t!==null){const e=this.value_.rawValue;this.value_.rawValue=as(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}function Us(i,t){return t===0?new yi:new Ei(i,t??Ds.monitor.defaultInterval)}const qs={id:"fpsgraph",type:"blade",accept(i){const t=F,e=J(i,{view:t.required.constant("fpsgraph"),interval:t.optional.number,label:t.optional.string,lineCount:t.optional.number,max:t.optional.number,min:t.optional.number});return e?{params:e}:null},controller(i){var t,e,s,n;const r=(t=i.params.interval)!==null&&t!==void 0?t:500;return new gt(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:new Ut(i.document,{lineCount:(e=i.params.lineCount)!==null&&e!==void 0?e:2,maxValue:(s=i.params.max)!==null&&s!==void 0?s:90,minValue:(n=i.params.min)!==null&&n!==void 0?n:0,ticker:Us(i.document,r),value:rs(80),viewProps:i.viewProps})})},api(i){return!(i.controller instanceof gt)||!(i.controller.valueController instanceof Ut)?null:new Be(i.controller)}};class V{constructor(t,e){this.min=t,this.max=e}static isObject(t){if(typeof t!="object"||t===null)return!1;const e=t.min,s=t.max;return!(typeof e!="number"||typeof s!="number")}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const qt={fromComponents:i=>new V(i[0],i[1]),toComponents:i=>[i.min,i.max]};class Ht{constructor(t){this.edge=t}constrain(t){var e,s,n,r,o,a,h,M;if(t.min<=t.max)return new V((s=(e=this.edge)===null||e===void 0?void 0:e.constrain(t.min))!==null&&s!==void 0?s:t.min,(r=(n=this.edge)===null||n===void 0?void 0:n.constrain(t.max))!==null&&r!==void 0?r:t.max);const I=(t.min+t.max)/2;return new V((a=(o=this.edge)===null||o===void 0?void 0:o.constrain(I))!==null&&a!==void 0?a:I,(M=(h=this.edge)===null||h===void 0?void 0:h.constrain(I))!==null&&M!==void 0?M:I)}}const Xt=m("rsltxt");class $e{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(Xt());const s=t.createElement("div");s.classList.add(Xt("s")),s.appendChild(this.sliderView_.element),this.element.appendChild(s);const n=t.createElement("div");n.classList.add(Xt("t")),n.appendChild(this.textView_.element),this.element.appendChild(n)}}const H=m("rsl");class Ge{constructor(t,e){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=e.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=t.createElement("div"),this.element.classList.add(H()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_);const s=t.createElement("div");s.classList.add(H("t")),this.element.appendChild(s),this.trackElement=s;const n=t.createElement("div");n.classList.add(H("b")),s.appendChild(n),this.barElement=n;const r=["min","max"].map(o=>{const a=t.createElement("div");return a.classList.add(H("k"),H("k",o)),s.appendChild(a),a});this.knobElements=[r[0],r[1]],this.update_()}valueToX_(t){const e=this.sliderProps_.get("minValue"),s=this.sliderProps_.get("maxValue");return Q(f(t,e,s,0,1),0,1)*100}update_(){const t=this.value_.rawValue;t.length===0?this.element.classList.add(H(void 0,"zero")):this.element.classList.remove(H(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=`${100-e[1]}%`,this.knobElements.forEach((s,n)=>{s.style.left=`${e[n]}%`})}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Ke{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=e.sliderProps,this.viewProps=e.viewProps,this.value=e.value,this.view=new Ge(t,{sliderProps:this.sliderProps,value:this.value,viewProps:e.viewProps});const s=new Et(this.view.trackElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){if(!t.point)return null;const e=(t.point.x+this.ofs_())/t.bounds.width,s=this.sliderProps.get("minValue"),n=this.sliderProps.get("maxValue");return f(e,0,1,s,n)}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,s=this.value.rawValue,n=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue"),o=f(s.min,n,r,0,1),a=f(s.max,n,r,0,1);Math.abs(a-e)<=.025?this.grabbing_="max":Math.abs(o-e)<=.025?this.grabbing_="min":e>=o&&e<=a?(this.grabbing_="length",this.grabOffset_=f(e-o,0,1,0,r-n)):e<o?(this.grabbing_="min",this.onPointerMove_(t)):e>a&&(this.grabbing_="max",this.onPointerMove_(t))}applyPointToValue_(t,e){const s=this.valueFromData_(t);if(s===null)return;const n=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue");if(this.grabbing_==="min")this.value.setRawValue(new V(s,this.value.rawValue.max),e);else if(this.grabbing_==="max")this.value.setRawValue(new V(this.value.rawValue.min,s),e);else if(this.grabbing_==="length"){const o=this.value.rawValue.length;let a=s-this.grabOffset_,h=a+o;a<n?(a=n,h=n+o):h>r&&(a=r-o,h=r),this.value.setRawValue(new V(a,h),e)}}onPointerMove_(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Fe{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new Ke(t,e);const s={baseStep:e.baseStep,constraint:e.constraint,textProps:g.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new Nt(t,{assembly:qt,axes:[s,s],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new $e(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function Hs(i){return V.isObject(i)?new V(i.min,i.max):new V(0,0)}function Xs(i,t){i.writeProperty("max",t.max),i.writeProperty("min",t.min)}function Ys(i){const t=[],e=Ms(i);e&&t.push(e);const s=Ts(i);return s&&t.push(s),new Ht(new le(t))}const Ws={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(i,t)=>{if(!V.isObject(i))return null;const e=F,s=J(t,{format:e.optional.function,max:e.optional.number,min:e.optional.number,step:e.optional.number});return s?{initialValue:new V(i.min,i.max),params:s}:null},binding:{reader:i=>Hs,constraint:i=>Ys(i.params),equals:V.equals,writer:i=>Xs},controller(i){var t;const e=i.value,s=i.constraint;if(!(s instanceof Ht))throw D.shouldNeverHappen();const n=(e.rawValue.min+e.rawValue.max)/2,r=(t=i.params.format)!==null&&t!==void 0?t:y(ds(s.edge,n)),o=s.edge&&ft(s.edge,pe);if(o)return new Fe(i.document,{baseStep:we(s.edge),constraint:s.edge,draggingScale:hs(s.edge,n),formatter:r,parser:xt,sliderProps:new g({maxValue:o.values.value("max"),minValue:o.values.value("min")}),value:e,viewProps:i.viewProps});const a={baseStep:we(s.edge),constraint:s.edge,textProps:g.fromObject({draggingScale:n,formatter:r})};return new Nt(i.document,{assembly:qt,axes:[a,a],parser:xt,value:e,viewProps:i.viewProps})}};class Ue{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return(t=this.controller_.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.props.set("title",t)}}class qe extends C{constructor(t,e,s,n,r){super(t,n,r),this.cell=e,this.index=s}}class He extends u{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach(s=>{const n=new Ue(s);this.cellToApiMap_.set(s,n)})}get value(){return this.controller_.value}cell(t,e){const s=this.controller_.valueController,n=s.cellControllers[e*s.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const s=e.bind(this);this.controller_.value.emitter.on(t,n=>{const r=this.controller_.valueController,o=r.findCellByValue(n.rawValue);if(!o)return;const a=this.cellToApiMap_.get(o);if(!a)return;const h=r.cellControllers.indexOf(o);s(new qe(this,a,[h%r.size[0],Math.floor(h/r.size[0])],n.rawValue,void 0))})}}const pt=m("rad");class Xe{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pt()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("label");s.classList.add(pt("l")),this.element.appendChild(s);const n=t.createElement("input");n.classList.add(pt("i")),n.name=e.name,n.type="radio",e.viewProps.bindDisabled(n),s.appendChild(n),this.inputElement=n;const r=t.createElement("div");r.classList.add(pt("b")),s.appendChild(r);const o=t.createElement("div");o.classList.add(pt("t")),r.appendChild(o),W(e.props,"title",a=>{o.textContent=a})}}class Ye{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Xe(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class kt{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[s,n]=this.size;for(let r=0;r<n;r++)for(let o=0;o<s;o++){const a=new Ye(t,{name:e.groupName,props:g.fromObject(Object.assign({},e.cellConfig(o,r))),viewProps:U.create()});this.cellCs_.push(a),this.cellValues_.push(e.cellConfig(o,r).value)}this.value=e.value,B(this.value,r=>{const o=this.findCellByValue(r);o&&(o.view.inputElement.checked=!0)}),this.viewProps=U.create(),this.view=new ae(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${s}, 1fr)`,this.cellCs_.forEach(r=>{r.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(r.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex(s=>s===t);return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,s=this.cellCs_.findIndex(n=>n.view.inputElement===e);s<0||(this.value.rawValue=this.cellValues_[s])}}const Js=function(){return{id:"radiogrid",type:"blade",accept(i){const t=F,e=J(i,{cells:t.required.function,groupName:t.required.string,size:t.required.array(t.required.number),value:t.required.raw,view:t.required.constant("radiogrid"),label:t.optional.string});return e?{params:e}:null},controller(i){return new _t(i.document,{blade:i.blade,props:g.fromObject({label:i.params.label}),valueController:new kt(i.document,{groupName:i.params.groupName,cellConfig:i.params.cells,size:i.params.size,value:R(i.params.value)})})},api(i){return!(i.controller instanceof _t)||!(i.controller.valueController instanceof kt)?null:new He(i.controller)}}}();function Yt(i){return{id:"input-radiogrid",type:"input",accept(t,e){if(!i.isType(t))return null;const s=F,n=J(e,{cells:s.required.function,groupName:s.required.string,size:s.required.array(s.required.number),view:s.required.constant("radiogrid")});return n?{initialValue:t,params:n}:null},binding:i.binding,controller:t=>new kt(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}}const Zs=Yt({isType:i=>typeof i=="number",binding:{reader:i=>is,writer:i=>Bt}}),Qs=Yt({isType:i=>typeof i=="string",binding:{reader:i=>ns,writer:i=>Bt}}),tn=Yt({isType:i=>typeof i=="boolean",binding:{reader:i=>Ti,writer:i=>Bt}}),en=[Os,Fs,qs,Ws,Js,tn,Zs,Qs];l.ButtonCellApi=ye,l.ButtonGridApi=Ee,l.ButtonGridController=It,l.CubicBezier=$,l.CubicBezierApi=Pe,l.CubicBezierAssembly=$t,l.CubicBezierController=Ft,l.CubicBezierGraphController=Oe,l.CubicBezierGraphView=Me,l.CubicBezierPickerController=Ae,l.CubicBezierPickerView=ze,l.CubicBezierPreviewView=Re,l.CubicBezierView=Ve,l.FpsGraphBladeApi=Be,l.FpsGraphController=Ut,l.FpsView=je,l.Fpswatch=Ie,l.Interval=V,l.IntervalAssembly=qt,l.IntervalConstraint=Ht,l.RadioCellApi=Ue,l.RadioController=Ye,l.RadioGridApi=He,l.RadioGridController=kt,l.RadioView=Xe,l.RangeSliderController=Ke,l.RangeSliderTextController=Fe,l.RangeSliderTextView=$e,l.RangeSliderView=Ge,l.TpRadioGridChangeEvent=qe,l.plugins=en,Object.defineProperty(l,"__esModule",{value:!0})})})(Cn,ht);const yn=an(ht),En=un({__proto__:null,default:yn},[ht]),ut=Object.fromEntries(Object.entries(Object.assign({"./functions/CameraDebug.js":hn,"./functions/GameDebug.js":mn,"./functions/SceneDebug.js":_n,"./functions/StatsDebug.js":xn})).map(([d,p])=>[d.split("/").pop().split(".")[0].replace("Debug",""),p]));var A,X,st,L,vt;class Tn{constructor(){et(this,A,void 0);et(this,X,void 0);et(this,st,void 0);et(this,L,void 0);et(this,vt,void 0);nt.register(this),it(this,A,new Map),it(this,X,new Map)}async load(){it(this,vt,await Ze(()=>import("./tweakpane-6a89d895.js").then(p=>p.t),["assets/tweakpane-6a89d895.js","assets/_commonjsHelpers-725317a4.js"]))}init(){var l;it(this,L,new(_(this,vt)).Pane({title:ln})),_(this,L).registerPlugin(En),it(this,st,_(this,L).addTab({pages:pn.map(u=>({title:u}))}).pages),_(this,L).addSeparator(),_(this,L).addButton({title:"Refresh"}).on("click",()=>_(this,L).refresh());const p=(l=Y.debug)==null?void 0:l.urlParams.getNumber("tab");p&&_(this,st)[p].controller_.onItemClick_()}addToParent(p,l,u){_(this,A).get(u)||_(this,A).set(u,[]),_(this,A).get(u).push(p),_(this,X).get(u)&&ut[l].createPane(_(this,X).get(u),p,l)}add(p,l,u=0,x=""){var C,w,c,P;if(ut[l]){const D=(w=(C=ut[l]).createPane)==null?void 0:w.call(C,_(this,st)[u],p,x||l);(P=(c=ut[l]).debug)==null||P.call(c,p),_(this,X).set(l,D),_(this,A).get(l)&&(_(this,A).get(l).forEach(S=>ut[l](D,S,l)),_(this,A).delete(l))}else console.warn("No debug mapping found for",l)}onKeyDown(p){p==="h"&&(_(this,L).hidden=!_(this,L).hidden)}}A=new WeakMap,X=new WeakMap,st=new WeakMap,L=new WeakMap,vt=new WeakMap;export{Tn as Mapping};
