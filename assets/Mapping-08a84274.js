var Jt=(d,a,p)=>{if(!a.has(d))throw TypeError("Cannot "+p)};var g=(d,a,p)=>(Jt(d,a,"read from private field"),p?p.call(d):a.get(d)),ne=(d,a,p)=>{if(a.has(d))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(d):a.set(d,p)},se=(d,a,p,u)=>(Jt(d,a,"write to private field"),u?u.call(d,p):a.set(d,p),p);import{f as $,E as H,e as N,_ as ti,V as as,T as Qt,G as C,j as _,D as he,k as et,M as Me,l as ls,C as ps}from"./index-d89a730a.js";import{C as re,P as us,a as ds}from"./debugConfig-5b4f09a7.js";import{c as cs,g as hs}from"./_commonjsHelpers-725317a4.js";function vs(d,a){for(var p=0;p<a.length;p++){const u=a[p];if(typeof u!="string"&&!Array.isArray(u)){for(const m in u)if(m!=="default"&&!(m in d)){const b=Object.getOwnPropertyDescriptor(u,m);b&&Object.defineProperty(d,m,b.get?b:{enumerable:!0,get:()=>u[m]})}}}return Object.freeze(Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}))}function ms(d,a,p){const u=d.addFolder({title:p,expanded:!1});let m=0;const b=async()=>{const w=N.$wrapper;if(a.orbitControls)w.style.pointerEvents="",a.orbitControls.dispose(),a.orbitControls=null,a.position.set(0,0,10),a.far=m,a.updateProjectionMatrix();else{w.style.pointerEvents="all";const E=await ti(()=>import("./OrbitControls-f7dd6e1a.js"),["assets/OrbitControls-f7dd6e1a.js","assets/index-d89a730a.js","assets/index-4bea3ac6.css"]);a.orbitControls=new E.OrbitControls(a,w),a.orbitControls.enableDamping=!0,a.orbitControls.dampingFactor=.15,a.orbitControls.enableZoom=!0,a.orbitControls.update(),a.position.z+=10,a.orbitControls.target=new as(Qt.size*.5,0,Qt.size*.5),m=a.far,a.far=200,a.updateProjectionMatrix()}},h={Orbit:!1};return new URLSearchParams(location.search).has("orbit")&&(b(),h.Orbit=!0),$.on(H.TICK,()=>{var w;return(w=a.orbitControls)==null?void 0:w.update()}),u.addInput(h,"Orbit",{title:"OrbitControls"}).on("change",b),u.addInput(a,"fov"),u.addInput(a,"near"),u.addInput(a,"far"),u.on("change",()=>a.updateProjectionMatrix()),u}function bs(d){$.on(H.KEY_DOWN,a=>{a===" "&&(d.focusPlayer=!d.focusPlayer)})}const gs=Object.freeze(Object.defineProperty({__proto__:null,createPane:ms,debug:bs},Symbol.toStringTag,{value:"Module"}));let Qe=0,R,Te,De=null,U=null;const ei=Object.entries(ls),f=et.data.length-1;function _s(d,a,p){const u=d.addFolder({title:p,expanded:!0});u.addButton({title:"Create Team"}).on("click",()=>{const h=Math.round(Math.random()*(ei.length-1)),c=ei[h];C.game.createTeam({iso:c[0],position:{x:_(0,f),y:_(0,f)}}),console.log("Create Team",c[0])}),u.addButton({title:"Spawn Medals"}).on("click",()=>{const h=[{id:Qe++,type:0,position:{x:_(0,f),y:_(0,f)}},{id:Qe++,type:1,position:{x:_(0,f),y:_(0,f)}},{id:Qe++,type:2,position:{x:_(0,f),y:_(0,f)}}];C.game.addMedals({medals:h})}),u.addButton({title:"Collect Medal"}).on("click",()=>{const h=Array.from(C.game.medals);if(h.length>0){const c={iso:U,medal:h[Math.floor(Math.random()*h.length)][1]};C.game.medalCollect(c)}else alert("There are no more medals")}),u.addSeparator(),$.on(H.CREATE_TEAM,()=>b()),$.on(H.STATE_READY,()=>b()),U=N.debug.urlParams.getString("team")||"FRA";function b(){R==null||R.dispose(),Te==null||Te.dispose(),De==null||De.dispose();const h=[...C.game.teams.keys()].map(c=>({text:c,value:c}));R=u.addBlade({view:"list",label:"Team",options:h,value:U}).on("change",c=>{N.webgl.camera.playerPosition=N.webgl.players.get(C.game.teams.get(c.value)).position,N.webgl.camera.focusPlayer=!0,U=c.value}),Te=u.addBlade({view:"buttongrid",size:[3,3],cells:(c,w)=>({title:[["-","UP","-"],["LEFT","-","RIGHT"],["-","DOWN","-"]][w][c]}),label:"Move Team"}).on("click",c=>{R&&c.cell.title!=="-"&&C.game.voteResults({iso:R.value,direction:he[c.cell.title.toLowerCase()],nextVoteId:0})}),De=u.addButton({title:"Get Zone"}).on("click",()=>{if(!(R!=null&&R.value))return;const c=C.game.teams.get(R.value).position;console.log(et.mapping[et.data[c.y][c.x]],c.x,c.y)})}return u}function fs(d){if(N.debug.urlParams.has("noServer")){$.on(H.KEY_DOWN,p=>{switch(p){case"ArrowUp":C.game.voteResults({iso:U,direction:he.up,nextVoteId:0});break;case"ArrowDown":C.game.voteResults({iso:U,direction:he.down,nextVoteId:0});break;case"ArrowLeft":C.game.voteResults({iso:U,direction:he.left,nextVoteId:0});break;case"ArrowRight":C.game.voteResults({iso:U,direction:he.right,nextVoteId:0});break}}),C.game.setState({userId:"userId",teamsState:{BZH:{iso:"BZH",position:{x:_(0,f),y:_(0,f)},medals:{0:5,1:2,2:15}},ESP:{iso:"ESP",position:{x:_(0,f),y:_(0,f)},medals:{0:1,1:2,2:3}},BRA:{iso:"BRA",position:{x:_(0,f),y:_(0,f)},medals:{0:50,1:4,2:12}}},medalsInGame:[{id:-4,type:Me.bronze,position:{x:_(0,f),y:_(0,f)}},{id:-3,type:Me.gold,position:{x:_(0,f),y:_(0,f)}},{id:-2,type:Me.gold,position:{x:_(0,f),y:_(0,f)}},{id:-1,type:Me.silver,position:{x:_(0,f),y:_(0,f)}}]});const a=N.debug.urlParams.getString("team")||"FRA";C.game.userJoin({iso:a,voteId:1,voteProgress:.5,votes:{down:25,left:25,right:25,up:25}})}}const ws=Object.freeze(Object.defineProperty({__proto__:null,createPane:_s,debug:fs},Symbol.toStringTag,{value:"Module"}));function xs(d,a,p){const u=d.addFolder({title:p,expanded:!1}),m=u.addFolder({title:"Flame",expanded:!1});m.addInput(a.flame.material.uniforms.uRadius,"value",{min:0,max:.6,label:"uRadius"}),m.addInput(a.flame.material.uniforms.uGlobalSpead,"value",{min:0,max:5,label:"uGlobalSpead"}),m.addInput(a.flame.material.uniforms.uElevation,"value",{min:.5,max:1.5,label:"uElevation"}),m.addInput(new re(a.flame.material.uniforms.uColor,"value"),"value",{label:"uColor"});const b=u.addFolder({title:"Face",expanded:!1}),h=a.model.getObjectByName("face").material;b.addInput(h.uniforms.uRoughness,"value",{min:0,max:1,step:.001,label:"uRoughness"}),b.addInput(h.uniforms.uMetalness,"value",{min:0,max:1,step:.001,label:"uMetalness"}),b.addInput(h.uniforms.uEnvMapIntensity,"value",{min:0,max:1,step:.001,label:"uEnvMapIntensity"}),b.addInput(new re(h.uniforms.uColor,"value"),"value",{label:"uColor"});const c=u.addFolder({title:"Body",expanded:!1}),w=a.model.getObjectByName("body").material;c.addInput(new re(w.uniforms.uColor1,"value"),"value",{label:"uColor1"}),c.addInput(new re(w.uniforms.uColor2,"value"),"value",{label:"uColor2"}),c.addInput(new re(w.uniforms.uColor3,"value"),"value",{label:"uColor3"});const E=u.addFolder({title:"Gold",expanded:!1}),k=a.model.getObjectByName("gold").material;return E.addInput(k.uniforms.uRoughness,"value",{min:0,max:1,step:.001,label:"uRoughness"}),E.addInput(k.uniforms.uMetalness,"value",{min:0,max:1,step:.001,label:"uMetalness"}),E.addInput(k.uniforms.uEnvMapIntensity,"value",{min:0,max:1,step:.001,label:"uEnvMapIntensity"}),E.addInput(new re(k.uniforms.uColor,"value"),"value",{label:"uColor"}),u}function ys(d){}const Cs=Object.freeze(Object.defineProperty({__proto__:null,createPane:xs,debug:ys},Symbol.toStringTag,{value:"Module"}));function Ps(d,a,p){const u=d.addFolder({title:p,expanded:!1});return u.addInput(a.uniforms.uEmissiveIntensity,"value",{min:0,max:10,label:"uEmissiveIntensity"}),u}function Es(d){}const ks=Object.freeze(Object.defineProperty({__proto__:null,createPane:Ps,debug:Es},Symbol.toStringTag,{value:"Module"}));function Vs(d){}function zs(d,a,p){const u=d.addFolder({title:p,expanded:!0});u.addInput(a.sun,"position");const m=new ps(a.sun.shadow.camera);m.visible=!1,a.add(m),u.addInput(m,"visible",{label:"CamHelper"});const b={value:!1},h=document.createElement("canvas");h.width=a.sun.shadow.mapSize.x,h.height=a.sun.shadow.mapSize.y,h.style.width="512px",h.style.height="512px",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.transformOrigin="0 0",h.style.backgroundColor="#000";const c=h.getContext("2d"),w=()=>{const k=new Uint8Array(4*h.width*h.height);N.webgl.renderer.readRenderTargetPixels(a.sun.shadow.map,0,0,h.width,h.height,k);const be=new ImageData(h.width,h.height);be.data.set(k),c.putImageData(be,0,0)},E=()=>{b.value?(document.body.appendChild(h),$.on(H.TICK,w)):(document.body.removeChild(h),$.off(H.TICK,w))};return u.addInput(b,"value",{label:"ShadowCanvas"}).on("change",E),u}const Ms=Object.freeze(Object.defineProperty({__proto__:null,createPane:zs,debug:Vs},Symbol.toStringTag,{value:"Module"}));function Ts(d,a,p){const u=d.addFolder({title:p,expanded:!1});return u.addButton({title:"Play"}).on("click",()=>{C.sound.isInit?(console.log("Sound play"),C.sound.audios.mario.play()):(console.log("Sound init"),C.sound.initAudio(),console.log("Sound play"),C.sound.audios.mario.play())}),u.addButton({title:"Pause"}).on("click",()=>{console.log("Sound pause"),C.sound.audios.mario.pause(),C.sound.audios.mario.currentTime=0}),u}function Ds(d){}const Ss=Object.freeze(Object.defineProperty({__proto__:null,createPane:Ts,debug:Ds},Symbol.toStringTag,{value:"Module"}));function Ls(d,a,p){const u=d.addFolder({title:p,expanded:!1});return u.addMonitor(a.info.memory,"geometries",{label:"Geometries"}),u.addMonitor(a.info.memory,"textures",{label:"Textures"}),u.addMonitor(a.info.programs,"length",{label:"Programs"}),u.addMonitor(a.info.render,"calls",{label:"Calls"}),u.addMonitor(a.info.render,"points",{label:"Points"}),u.addMonitor(a.info.render,"triangles",{label:"Triangles"}),a.info.autoReset=!1,$.on(H.RENDER,()=>a.info.reset()),u}function Is(d){}const Rs=Object.freeze(Object.defineProperty({__proto__:null,createPane:Ls,debug:Is},Symbol.toStringTag,{value:"Module"}));var ve={},Os={get exports(){return ve},set exports(d){ve=d}};(function(d,a){(function(p,u){u(a)})(cs,function(p){class u{constructor(e){this.controller_=e}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(e){this.controller_.viewProps.set("hidden",e)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class m{constructor(e){this.target=e}}class b extends m{constructor(e,t,n,s){super(e),this.value=t,this.presetKey=n,this.last=s??!0}}function h(i){return i}function c(i){return i==null}const w={alreadydisposed:()=>"View has been already disposed",invalidparams:i=>`Invalid parameters for '${i.name}'`,nomatchingcontroller:i=>`No matching controller for '${i.key}'`,nomatchingview:i=>`No matching view for '${JSON.stringify(i.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:i=>`Property '${i.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class E{constructor(e){var t;this.message=(t=w[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}static alreadyDisposed(){return new E({type:"alreadydisposed"})}static notBindable(){return new E({type:"notbindable"})}static propertyNotFound(e){return new E({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new E({type:"shouldneverhappen"})}}class k{constructor(){this.observers_={}}on(e,t){let n=this.observers_[e];return n||(n=this.observers_[e]=[]),n.push({handler:t}),this}off(e,t){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter(s=>s.handler!==t)),this}emit(e,t){const n=this.observers_[e];n&&n.forEach(s=>{s.handler(t)})}}const be="tp";function x(i){return(t,n)=>[be,"-",i,"v",t?`_${t}`:"",n?`-${n}`:""].join("")}function ii(i,e){return t=>e(i(t))}function ni(i){return i.rawValue}function B(i,e){i.emitter.on("change",ii(ni,e)),e(i.rawValue)}function J(i,e,t){B(i.value(e),t)}function si(i,e,t){t?i.classList.add(e):i.classList.remove(e)}function ge(i,e){return t=>{si(i,e,t)}}function ri(i,e){B(i,t=>{e.textContent=t??""})}const Se=x("btn");class oi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Se()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(Se("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const s=e.createElement("div");s.classList.add(Se("t")),ri(t.props.value("title"),s),this.buttonElement.appendChild(s)}}class ai{constructor(e,t){this.emitter=new k,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new oi(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class li{constructor(e,t){var n;this.constraint_=t==null?void 0:t.constraint,this.equals_=(n=t==null?void 0:t.equals)!==null&&n!==void 0?n:(s,r)=>s===r,this.emitter=new k,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:s,sender:this}))}}class pi{constructor(e){this.emitter=new k,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:this.value_,sender:this}))}}function I(i,e){const t=e==null?void 0:e.constraint,n=e==null?void 0:e.equals;return!t&&!n?new pi(i):new li(i,e)}class y{constructor(e){this.emitter=new k,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((n,s)=>Object.assign(n,{[s]:I(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new y(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}function ui(i,e){const n=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(i[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return n}function di(i,e){return i.reduce((t,n)=>{if(t===void 0)return;const s=e(n);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function ci(i){return i===null?!1:typeof i=="object"}function j(i){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const n=i(t);return n!==void 0?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function tt(i){return{custom:e=>j(e)(i),boolean:j(e=>typeof e=="boolean"?e:void 0)(i),number:j(e=>typeof e=="number"?e:void 0)(i),string:j(e=>typeof e=="string"?e:void 0)(i),function:j(e=>typeof e=="function"?e:void 0)(i),constant:e=>j(t=>t===e?e:void 0)(i),raw:j(e=>e)(i),object:e=>j(t=>{if(ci(t))return ui(t,e)})(i),array:e=>j(t=>{if(Array.isArray(t))return di(t,e)})(i)}}const q={optional:tt(!0),required:tt(!1)};function Q(i,e){const t=q.required.object(e)(i);return t.succeeded?t.value:void 0}function hi(i){console.warn([`Missing '${i.key}' of ${i.target} in ${i.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function vi(i){return i&&i.parentElement&&i.parentElement.removeChild(i),null}class Le{constructor(e){this.value_=e}static create(e){return[new Le(e),(t,n)=>{e.setRawValue(t,n)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const mi=x("");function it(i,e){return ge(i,mi(void 0,e))}class X extends y{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Le.create(I(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,n,s;const r=e??{};return new X(y.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(n=r.hidden)!==null&&n!==void 0?n:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){B(this.globalDisabled_,it(e,"disabled")),J(this,"hidden",it(e,"hidden"))}bindDisabled(e){B(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){B(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const n=e.previousRawValue;n==null||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function bi(){return["veryfirst","first","last","verylast"]}const nt=x(""),st={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class rt{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{bi().forEach(n=>{t.classList.remove(nt(void 0,st[n]))}),this.blade.get("positions").forEach(n=>{t.classList.add(nt(void 0,st[n]))})}),this.viewProps.handleDispose(()=>{vi(t)})}get parent(){return this.parent_}set parent(e){if(this.parent_=e,!("parent"in this.viewProps.valMap_)){hi({key:"parent",target:X.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const z="http://www.w3.org/2000/svg";function _e(i){i.offsetHeight}function gi(i,e){const t=i.style.transition;i.style.transition="none",e(),i.style.transition=t}function ot(i){return i.ontouchstart!==void 0}function _i(i){for(;i.childNodes.length>0;)i.removeChild(i.childNodes[0])}function fi(i){return i.relatedTarget?i.relatedTarget:"explicitOriginalTarget"in i?i.explicitOriginalTarget:null}const ae=x("lbl");function wi(i,e){const t=i.createDocumentFragment();return e.split(`
`).map(s=>i.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(i.createElement("br")),t.appendChild(s)}),t}class at{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ae()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(ae("l")),J(t.props,"label",r=>{c(r)?this.element.classList.add(ae(void 0,"nol")):(this.element.classList.remove(ae(void 0,"nol")),_i(n),n.appendChild(wi(e,r)))}),this.element.appendChild(n),this.labelElement=n;const s=e.createElement("div");s.classList.add(ae("v")),this.element.appendChild(s),this.valueElement=s}}class fe extends rt{constructor(e,t){const n=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{view:new at(e,{props:t.props,viewProps:n}),viewProps:n})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class xi extends rt{constructor(e){super(e),this.value=e.value}}class Ie extends y{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=y.createCore(t);return new Ie(n)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!c(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const n=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};J(this,"expanded",n),J(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function yi(i){return Ie.create(i)}function Ci(i,e){let t=0;return gi(e,()=>{i.set("expandedHeight",null),i.set("temporaryExpanded",!0),_e(e),t=e.clientHeight,i.set("temporaryExpanded",null),_e(e)}),t}function lt(i,e){e.style.height=i.styleHeight}function Pi(i,e){i.value("expanded").emitter.on("beforechange",()=>{i.set("completed",!1),c(i.get("expandedHeight"))&&i.set("expandedHeight",Ci(i,e)),i.set("shouldFixHeight",!0),_e(e)}),i.emitter.on("change",()=>{lt(i,e)}),lt(i,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&i.cleanUpTransition()})}class pt{constructor(e,t){const n=x(t.viewName);this.element=e.createElement("div"),this.element.classList.add(n()),t.viewProps.bindClassModifiers(this.element)}}class we extends xi{constructor(e,t){const n=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{value:t.valueController.value,view:new at(e,{props:t.props,viewProps:n}),viewProps:n})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Ei{constructor(){this.disabled=!1,this.emitter=new k}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class ki{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new k,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class ut{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,n)=>n.constrain(t),e)}}function xe(i,e){if(i instanceof e)return i;if(i instanceof ut){const t=i.constraints.reduce((n,s)=>n||(s instanceof e?s:null),null);if(t)return t}return null}class dt{constructor(e){this.values=y.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}class Re{constructor(e){this.values=y.fromObject({max:e.max,min:e.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(e){const t=this.values.get("max"),n=this.values.get("min");let s=e;return c(n)||(s=Math.max(s,n)),c(t)||(s=Math.min(s,t)),s}}class ye{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,n=Math.round((e-t)/this.step);return t+n*this.step}}const ct=x("pop");class Vi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ct()),t.viewProps.bindClassModifiers(this.element),B(t.shows,ge(this.element,ct(void 0,"v")))}}class zi{constructor(e,t){this.shows=I(!1),this.viewProps=t.viewProps,this.view=new Vi(e,{shows:this.shows,viewProps:this.viewProps})}}const ht=x("txt");class Mi{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ht()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(ht("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class Ti{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Mi(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const n=e.currentTarget.value,s=this.parser_(n);c(s)||(this.value.rawValue=s),this.view.refresh()}}function Di(i){return i==="false"?!1:!!i}class Si{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const Li={"**":(i,e)=>Math.pow(i,e),"*":(i,e)=>i*e,"/":(i,e)=>i/e,"%":(i,e)=>i%e,"+":(i,e)=>i+e,"-":(i,e)=>i-e,"<<":(i,e)=>i<<e,">>":(i,e)=>i>>e,">>>":(i,e)=>i>>>e,"&":(i,e)=>i&e,"^":(i,e)=>i^e,"|":(i,e)=>i|e};class Ii{constructor(e,t,n){this.left=t,this.operator=e,this.right=n}evaluate(){const e=Li[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Ri={"+":i=>i,"-":i=>-i,"~":i=>~i};class Oi{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=Ri[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Oe(i){return(e,t)=>{for(let n=0;n<i.length;n++){const s=i[n](e,t);if(s!=="")return s}return""}}function le(i,e){var t;const n=i.substr(e).match(/^\s+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function Bi(i,e){const t=i.substr(e,1);return t.match(/^[1-9]$/)?t:""}function pe(i,e){var t;const n=i.substr(e).match(/^[0-9]+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function ji(i,e){const t=pe(i,e);if(t!=="")return t;const n=i.substr(e,1);if(e+=1,n!=="-"&&n!=="+")return"";const s=pe(i,e);return s===""?"":n+s}function Be(i,e){const t=i.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const n=ji(i,e);return n===""?"":t+n}function vt(i,e){const t=i.substr(e,1);if(t==="0")return t;const n=Bi(i,e);return e+=n.length,n===""?"":n+pe(i,e)}function Ai(i,e){const t=vt(i,e);if(e+=t.length,t==="")return"";const n=i.substr(e,1);if(e+=n.length,n!==".")return"";const s=pe(i,e);return e+=s.length,t+n+s+Be(i,e)}function Ni(i,e){const t=i.substr(e,1);if(e+=t.length,t!==".")return"";const n=pe(i,e);return e+=n.length,n===""?"":t+n+Be(i,e)}function $i(i,e){const t=vt(i,e);return e+=t.length,t===""?"":t+Be(i,e)}const Fi=Oe([Ai,Ni,$i]);function Gi(i,e){var t;const n=i.substr(e).match(/^[01]+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function Ki(i,e){const t=i.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const n=Gi(i,e);return n===""?"":t+n}function Ui(i,e){var t;const n=i.substr(e).match(/^[0-7]+/);return(t=n&&n[0])!==null&&t!==void 0?t:""}function Hi(i,e){const t=i.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const n=Ui(i,e);return n===""?"":t+n}function qi(i,e){var t;const n=i.substr(e).match(/^[0-9a-f]+/i);return(t=n&&n[0])!==null&&t!==void 0?t:""}function Xi(i,e){const t=i.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const n=qi(i,e);return n===""?"":t+n}const Yi=Oe([Ki,Hi,Xi]),Wi=Oe([Yi,Fi]);function Zi(i,e){const t=Wi(i,e);return e+=t.length,t===""?null:{evaluable:new Si(t),cursor:e}}function Ji(i,e){const t=i.substr(e,1);if(e+=t.length,t!=="(")return null;const n=bt(i,e);if(!n)return null;e=n.cursor,e+=le(i,e).length;const s=i.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:n.evaluable,cursor:e}}function Qi(i,e){var t;return(t=Zi(i,e))!==null&&t!==void 0?t:Ji(i,e)}function mt(i,e){const t=Qi(i,e);if(t)return t;const n=i.substr(e,1);if(e+=n.length,n!=="+"&&n!=="-"&&n!=="~")return null;const s=mt(i,e);return s?(e=s.cursor,{cursor:e,evaluable:new Oi(n,s.evaluable)}):null}function en(i,e,t){t+=le(e,t).length;const n=i.filter(s=>e.startsWith(s,t))[0];return n?(t+=n.length,t+=le(e,t).length,{cursor:t,operator:n}):null}function tn(i,e){return(t,n)=>{const s=i(t,n);if(!s)return null;n=s.cursor;let r=s.evaluable;for(;;){const o=en(e,t,n);if(!o)break;n=o.cursor;const l=i(t,n);if(!l)return null;n=l.cursor,r=new Ii(o.operator,r,l.evaluable)}return r?{cursor:n,evaluable:r}:null}}const nn=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((i,e)=>tn(i,e),mt);function bt(i,e){return e+=le(i,e).length,nn(i,e)}function sn(i){const e=bt(i,0);return!e||e.cursor+le(i,e.cursor).length!==i.length?null:e.evaluable}function Ce(i){var e;const t=sn(i);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function rn(i){if(typeof i=="number")return i;if(typeof i=="string"){const e=Ce(i);if(!c(e))return e}return 0}function V(i){return e=>e.toFixed(Math.max(Math.min(i,20),0))}const on=V(0);function Pe(i){return on(i)+"%"}function an(i){return String(i)}function gt(i,e){for(;i.length<e;)i.push(void 0)}function ln(i){const e=[];return gt(e,i),I(e)}function pn(i){const e=i.indexOf(void 0);return e<0?i:i.slice(0,e)}function un(i,e){const t=[...pn(i),e];return t.length>i.length?t.splice(0,t.length-i.length):gt(t,i.length),t}function _t({primary:i,secondary:e,forward:t,backward:n}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}i.emitter.on("change",o=>{r(()=>{e.setRawValue(t(i,e),o.options)})}),e.emitter.on("change",o=>{r(()=>{i.setRawValue(n(i,e),o.options)}),r(()=>{e.setRawValue(t(i,e),o.options)})}),r(()=>{e.setRawValue(t(i,e),{forceEmit:!1,last:!0})})}function ee(i,e){const t=i*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function Ee(i){return{altKey:i.altKey,downKey:i.key==="ArrowDown",shiftKey:i.shiftKey,upKey:i.key==="ArrowUp"}}function ft(i){return{altKey:i.altKey,downKey:i.key==="ArrowLeft",shiftKey:i.shiftKey,upKey:i.key==="ArrowRight"}}function dn(i){return i==="ArrowUp"||i==="ArrowDown"}function wt(i){return dn(i)||i==="ArrowLeft"||i==="ArrowRight"}function je(i,e){var t,n;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:i.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:i.pageY-(((n=s&&s.scrollY)!==null&&n!==void 0?n:0)+r.top)}}class ke{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new k,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(je(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(je(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(je(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const n=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-s.left,y:n.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}}function P(i,e,t,n,s){const r=(i-e)/(t-e);return n+r*(s-n)}function xt(i){return String(i.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function te(i,e,t){return Math.min(Math.max(i,e),t)}const D=x("txt");class cn{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(D(),D(void 0,"num")),t.arrayPosition&&this.element.classList.add(D(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(D("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(D()),this.inputElement.classList.add(D("i"));const s=e.createElement("div");s.classList.add(D("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(z,"svg");r.classList.add(D("g")),this.knobElement.appendChild(r);const o=e.createElementNS(z,"path");o.classList.add(D("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(z,"path");l.classList.add(D("gh")),r.appendChild(l),this.guideHeadElem_=l;const v=e.createElement("div");v.classList.add(x("tt")()),this.knobElement.appendChild(v),this.tooltipElem_=v,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(D(void 0,"drg"));return}this.element.classList.add(D(void 0,"drg"));const t=e.rawValue/this.props_.get("draggingScale"),n=t+(t>0?-1:t<0?1:0),s=te(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+s},0 L${n},4 L${n+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class hn{constructor(e,t){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.sliderProps_=(n=t.sliderProps)!==null&&n!==void 0?n:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=I(null),this.view=new cn(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new ke(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,n;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("minValue"),r=(n=this.sliderProps_)===null||n===void 0?void 0:n.get("maxValue");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const n=e.currentTarget.value,s=this.parser_(n);c(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=ee(this.baseStep_,Ee(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){ee(this.baseStep_,Ee(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("draggingScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function Ae(i,e){i.write(e)}function vn(i){const e=i?xe(i,ye):null;return e?e.step:null}function mn(i,e){const t=i&&xe(i,ye);return t?xt(t.step):Math.max(xt(e),2)}function yt(i){const e=vn(i);return e??1}function bn(i,e){var t;const n=i&&xe(i,ye),s=Math.abs((t=n==null?void 0:n.step)!==null&&t!==void 0?t:e);return s===0?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function Ve(i){return[i[0],i[1],i[2]]}function Ct(i){const e=te(Math.floor(i),0,255).toString(16);return e.length===1?`0${e}`:e}function gn(i,e="#"){const t=Ve(i.getComponents("rgb")).map(Ct).join("");return`${e}${t}`}function _n(i,e="#"){const t=i.getComponents("rgb"),n=[t[0],t[1],t[2],t[3]*255].map(Ct).join("");return`${e}${n}`}function fn(i,e){const t=V(e==="float"?2:0);return`rgb(${Ve(i.getComponents("rgb",e)).map(s=>t(s)).join(", ")})`}function wn(i){return e=>fn(e,i)}function xn(i,e){const t=V(2),n=V(e==="float"?2:0);return`rgba(${i.getComponents("rgb",e).map((r,o)=>(o===3?t:n)(r)).join(", ")})`}function yn(i){return e=>xn(e,i)}function Cn(i){const e=[V(0),Pe,Pe];return`hsl(${Ve(i.getComponents("hsl")).map((n,s)=>e[s](n)).join(", ")})`}function Pn(i){const e=[V(0),Pe,Pe,V(2)];return`hsla(${i.getComponents("hsl").map((n,s)=>e[s](n)).join(", ")})`}function En(i,e){const t=V(e==="float"?2:0),n=["r","g","b"];return`{${Ve(i.getComponents("rgb",e)).map((r,o)=>`${n[o]}: ${t(r)}`).join(", ")}}`}function kn(i){return e=>En(e,i)}function Vn(i,e){const t=V(2),n=V(e==="float"?2:0),s=["r","g","b","a"];return`{${i.getComponents("rgb",e).map((o,l)=>{const v=l===3?t:n;return`${s[l]}: ${v(o)}`}).join(", ")}}`}function zn(i){return e=>Vn(e,i)}[...["int","float"].reduce((i,e)=>[...i,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:wn(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:yn(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:kn(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:zn(e)}],[])];class Mn{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((n,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(n))!==null&&o!==void 0?o:n});return this.asm_.fromComponents(t)}}const Pt=x("pndtxt");class Tn{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Pt()),this.textViews.forEach(n=>{const s=e.createElement("div");s.classList.add(Pt("a")),s.appendChild(n.element),this.element.appendChild(s)})}}function Dn(i,e,t){return new hn(i,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",baseStep:e.axes[t].baseStep,parser:e.parser,props:e.axes[t].textProps,value:I(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}class Ne{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((n,s)=>Dn(e,t,s)),this.acs_.forEach((n,s)=>{_t({primary:this.value,secondary:n.value,forward:r=>t.assembly.toComponents(r.rawValue)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r.rawValue);return l[s]=o.rawValue,t.assembly.fromComponents(l)}})}),this.view=new Tn(e,{textViews:this.acs_.map(n=>n.view)})}}function Sn(i,e){return"step"in i&&!c(i.step)?new ye(i.step,e):null}function Ln(i){return!c(i.max)&&!c(i.min)?new dt({max:i.max,min:i.min}):!c(i.max)||!c(i.min)?new Re({max:i.max,min:i.min}):null}const In={monitor:{defaultInterval:200,defaultLineCount:3}},F=x("grl");class Rn{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(F()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(z,"svg");n.classList.add(F("g")),n.style.height=`calc(var(--bld-us) * ${t.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const s=e.createElementNS(z,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(F("t"),x("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,n=this.props_.get("minValue"),s=this.props_.get("maxValue"),r=[];this.value.rawValue.forEach((A,Je)=>{if(A===void 0)return;const rs=P(Je,0,t,0,e.width),os=P(A,n,s,e.height,0);r.push([rs,os].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(F("t","a"));return}const v=P(this.cursor_.rawValue,0,t,0,e.width),L=P(l,n,s,e.height,0);o.style.left=`${v}px`,o.style.top=`${L}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(F("t","a"))||(o.classList.add(F("t","a"),F("t","in")),_e(o),o.classList.remove(F("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class On{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=I(-1),this.view=new Rn(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!ot(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const n=new ke(this.view.element);n.emitter.on("down",this.onGraphPointerDown_),n.emitter.on("move",this.onGraphPointerMove_),n.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(P(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(P(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class Et{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return(e=this.controller_.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller_.emitter.on(e,()=>{n(new m(this))}),this}}class Bn extends m{constructor(e,t,n){super(e),this.cell=t,this.index=n}}class kt extends u{constructor(e){super(e),this.cellToApiMap_=new Map,this.emitter_=new k;const t=this.controller_.valueController;t.cellControllers.forEach((n,s)=>{const r=new Et(n);this.cellToApiMap_.set(n,r),n.emitter.on("click",()=>{const o=s%t.size[0],l=Math.floor(s/t.size[0]);this.emitter_.emit("click",{event:new Bn(this,r,[o,l])})})})}cell(e,t){const n=this.controller_.valueController,s=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(s)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,s=>{n(s.event)}),this}}class $e{constructor(e,t){this.size=t.size;const[n,s]=this.size,r=[];for(let o=0;o<s;o++)for(let l=0;l<n;l++){const v=new ai(e,{props:y.fromObject(Object.assign({},t.cellConfig(l,o))),viewProps:X.create()});r.push(v)}this.cellCs_=r,this.viewProps=X.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(o=>{o.viewProps.set("disposed",!0)})}),this.view=new pt(e,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach(o=>{this.view.element.appendChild(o.view.element)})}get cellControllers(){return this.cellCs_}}const jn={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const e=q,t=Q(i,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return t?{params:t}:null},controller(i){return new fe(i.document,{blade:i.blade,props:y.fromObject({label:i.params.label}),valueController:new $e(i.document,{cellConfig:i.params.cells,size:i.params.size})})},api(i){return!(i.controller instanceof fe)||!(i.controller.valueController instanceof $e)?null:new kt(i.controller)}};class Vt extends u{get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const n=t.bind(this);return this.controller_.valueController.value.emitter.on(e,s=>{n(new b(this,s.rawValue,void 0,s.options.last))}),this}}function S(i,e,t){return i*(1-t)+e*t}const An=20,Nn=.001,Fe=100;function $n(i,e){let t=.25,n=.5,s=-1;for(let r=0;r<An;r++){const[o,l]=i.curve(n);if(n+=t*(o<e?1:-1),s=l,t*=.5,Math.abs(e-o)<Nn)break}return s}class G{constructor(e=0,t=0,n=1,s=1){this.cache_=[],this.comps_=[e,t,n,s]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(e){return c(e)||!Array.isArray(e)?!1:typeof e[0]=="number"&&typeof e[1]=="number"&&typeof e[2]=="number"&&typeof e[3]=="number"}static equals(e,t){return e.x1===t.x1&&e.y1===t.y1&&e.x2===t.x2&&e.y2===t.y2}curve(e){const t=S(0,this.x1,e),n=S(0,this.y1,e),s=S(this.x1,this.x2,e),r=S(this.y1,this.y2,e),o=S(this.x2,1,e),l=S(this.y2,1,e),v=S(t,s,e),L=S(n,r,e),A=S(s,o,e),Je=S(r,l,e);return[S(v,A,e),S(L,Je,e)]}y(e){if(this.cache_.length===0){const t=[];for(let n=0;n<Fe;n++)t.push($n(this,P(n,0,Fe-1,0,1)));this.cache_=t}return this.cache_[Math.round(P(te(e,0,1),0,1,0,Fe-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const Ge={toComponents:i=>i.toObject(),fromComponents:i=>new G(...i)};function Fn(i){const e=V(2);return`cubic-bezier(${i.toObject().map(n=>e(n)).join(", ")})`}const zt=[0,.5,.5,1];function Gn(i){const e=i.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new G(...zt);const t=[e[1],e[2],e[3],e[4]].reduce((n,s)=>{if(!n)return null;const r=Number(s);return isNaN(r)?null:[...n,r]},[]);return new G(...t??zt)}const Y=x("cbz");class Mt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Y()),t.viewProps.bindClassModifiers(this.element),t.foldable.bindExpandedClass(this.element,Y(void 0,"expanded")),J(t.foldable,"completed",ge(this.element,Y(void 0,"cpl")));const n=e.createElement("div");n.classList.add(Y("h")),this.element.appendChild(n);const s=e.createElement("button");s.classList.add(Y("b")),t.viewProps.bindDisabled(s);const r=e.createElementNS(z,"svg");r.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',s.appendChild(r),n.appendChild(s),this.buttonElement=s;const o=e.createElement("div");if(o.classList.add(Y("t")),n.appendChild(o),this.textElement=o,t.pickerLayout==="inline"){const l=e.createElement("div");l.classList.add(Y("p")),this.element.appendChild(l),this.pickerElement=l}else this.pickerElement=null}}const Ke=x("cbzp");class Tt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ke()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ke("g")),this.element.appendChild(n),this.graphElement=n;const s=e.createElement("div");s.classList.add(Ke("t")),this.element.appendChild(s),this.textElement=s}}function Dt(i,e){const t=new MutationObserver(s=>{for(const r of s)r.type==="childList"&&r.addedNodes.forEach(o=>{o.contains(o)&&(e(),t.disconnect())})}),n=i.ownerDocument;t.observe(n.body,{attributes:!0,childList:!0,subtree:!0})}const K=x("cbzg");function Kn(i,e){return t=>e(i(t))}class St{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(K()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(K("p")),this.element.appendChild(n),this.previewElement=n;const s=e.createElementNS(z,"svg");s.classList.add(K("g")),this.element.appendChild(s),this.svgElem_=s;const r=e.createElementNS(z,"path");r.classList.add(K("u")),this.svgElem_.appendChild(r),this.guideElem_=r;const o=e.createElementNS(z,"polyline");o.classList.add(K("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[e.createElement("div"),e.createElement("div")],this.handleElems_.forEach(l=>{l.classList.add(K("h")),this.element.appendChild(l)}),this.vectorElems_=[e.createElementNS(z,"line"),e.createElementNS(z,"line")],this.vectorElems_.forEach(l=>{l.classList.add(K("v")),this.svgElem_.appendChild(l)}),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=t.selection,this.handleElems_.forEach((l,v)=>{B(this.sel_,Kn(L=>L===v,ge(l,K("h","sel"))))}),Dt(this.element,()=>{this.refresh()})}getVertMargin_(e){return e*.25}valueToPosition(e,t){const n=this.element.getBoundingClientRect(),s=n.width,r=n.height,o=this.getVertMargin_(r);return{x:P(e,0,1,0,s),y:P(t,0,1,r-o,o)}}positionToValue(e,t){const n=this.element.getBoundingClientRect(),s=n.width,r=n.height,o=this.getVertMargin_(r);return{x:te(P(e,0,s,0,1),0,1),y:P(t,r-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(r=>{const o=this.valueToPosition(0,r),l=this.valueToPosition(1,r);return[`M ${o.x},${o.y}`,`L ${l.x},${l.y}`].join(" ")}).join(" "));const e=this.value_.rawValue,t=[];let n=0;for(;;){const r=this.valueToPosition(...e.curve(n));if(t.push([r.x,r.y].join(",")),n>=1)break;n=Math.min(n+.05,1)}this.lineElem_.setAttributeNS(null,"points",t.join(" "));const s=e.toObject();[0,1].forEach(r=>{const o=this.valueToPosition(r,r),l=this.valueToPosition(s[r*2],s[r*2+1]),v=this.vectorElems_[r];v.setAttributeNS(null,"x1",String(o.x)),v.setAttributeNS(null,"y1",String(o.y)),v.setAttributeNS(null,"x2",String(l.x)),v.setAttributeNS(null,"y2",String(l.y));const L=this.handleElems_[r];L.style.left=`${l.x}px`,L.style.top=`${l.y}px`})}onValueChange_(){this.refresh()}}const Lt=24,It=400,Rt=1e3,ie=x("cbzprv");class Ot{constructor(e,t){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ie()),t.viewProps.bindClassModifiers(this.element);const n=e.createElementNS(z,"svg");n.classList.add(ie("g")),this.element.appendChild(n),this.svgElem_=n;const s=e.createElementNS(z,"path");s.classList.add(ie("t")),this.svgElem_.appendChild(s),this.ticksElem_=s;const r=e.createElement("div");r.classList.add(ie("m")),this.element.appendChild(r),this.markerElem_=r,this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.viewProps.handleDispose(this.onDispose_),Dt(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(ie("m","a")),this.startTime_=new Date().getTime()+It,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(ie("m","a"))}onDispose_(){this.stop()}updateMarker_(e){const t=this.value_.rawValue.y(te(e,0,1));this.markerElem_.style.left=`${t*100}%`}refresh(){const e=this.svgElem_.getBoundingClientRect(),t=e.width,n=e.height,s=[],r=this.value_.rawValue;for(let o=0;o<Lt;o++){const l=P(o,0,Lt-1,0,1),v=P(r.y(l),0,1,0,t);s.push(`M ${v},0 v${n}`)}this.ticksElem_.setAttributeNS(null,"d",s.join(" "))}onTimer_(){if(this.startTime_===null)return;const e=new Date().getTime()-this.startTime_,t=e/Rt;this.updateMarker_(t),e>Rt+It&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function Ue(i,e,t,n){const s=t-i,r=n-e;return Math.sqrt(s*s+r*r)}function Un(i,e,t,n){const s=Ue(i,e,t,n),r=Math.atan2(n-e,t-i),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:i+Math.cos(o)*s,y:e+Math.sin(o)*s}}class Bt{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.sel_=I(0),this.viewProps=t.viewProps,this.view=new St(e,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new Ot(e,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",s=>{s.stopImmediatePropagation(),s.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const n=new ke(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(e,t,n){const s=this.sel_.rawValue,r=this.value.rawValue.toObject(),o=this.view.positionToValue(e.x,e.y),l=t?Un(s,s,o.x,o.y):o;r[s*2]=l.x,r[s*2+1]=l.y,this.value.setRawValue(new G(...r),n)}onPointerDown_(e){const t=e.data;if(!t.point)return;const n=this.value.rawValue,s=this.view.valueToPosition(n.x1,n.y1),r=Ue(t.point.x,t.point.y,s.x,s.y),o=this.view.valueToPosition(n.x2,n.y2),l=Ue(t.point.x,t.point.y,o.x,o.y);this.sel_.rawValue=r<=l?0:1,this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(e){wt(e.key)&&e.preventDefault();const t=this.sel_.rawValue,n=this.value.rawValue.toObject();n[t*2]+=ee(this.baseStep_,ft(e)),n[t*2+1]+=ee(this.baseStep_,Ee(e)),this.value.setRawValue(new G(...n),{forceEmit:!1,last:!1})}onKeyUp_(e){wt(e.key)&&e.preventDefault();const t=ee(this.baseStep_,ft(e)),n=ee(this.baseStep_,Ee(e));t===0&&n===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class jt{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Tt(e,{viewProps:this.viewProps}),this.gc_=new Bt(e,{baseStep:t.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const n=Object.assign(Object.assign({},t.axis),{constraint:new Re({max:1,min:0})}),s=Object.assign(Object.assign({},t.axis),{constraint:void 0});this.tc_=new Ne(e,{assembly:Ge,axes:[n,s,n,s],parser:Ce,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(e=>e.inputElement)]}refresh(){this.gc_.refresh()}}class He{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=yi(t.expanded),this.view=new Mt(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Ti(e,{parser:Gn,props:y.fromObject({formatter:Fn}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=t.pickerLayout==="popup"?new zi(e,{viewProps:this.viewProps}):null;const n=new jt(e,{axis:t.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach(s=>{s.addEventListener("blur",this.onPopupChildBlur_),s.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),B(this.popC_.shows,s=>{s&&n.refresh()}),_t({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:s=>s.rawValue,backward:(s,r)=>r.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Pi(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=e.relatedTarget;(!t||!this.popC_.view.element.contains(t))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=fi(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!ot(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_&&e.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function Hn(){return new Mn({assembly:Ge,components:[0,1,2,3].map(i=>i%2===0?new Re({min:0,max:1}):void 0)})}const qn={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(i){const e=q,t=Q(i,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom(n=>n==="inline"||n==="popup"?n:void 0)});return t?{params:t}:null},controller(i){var e,t;const n=new G(...i.params.value),s=I(n,{constraint:Hn(),equals:G.equals}),r=new He(i.document,{axis:{baseStep:.1,textProps:y.fromObject({draggingScale:.01,formatter:V(2)})},expanded:(e=i.params.expanded)!==null&&e!==void 0?e:!1,pickerLayout:(t=i.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:i.viewProps});return new we(i.document,{blade:i.blade,props:y.fromObject({label:i.params.label}),valueController:r})},api(i){return!(i.controller instanceof we)||!(i.controller.valueController instanceof He)?null:new Vt(i.controller)}};class At extends u{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Nt=20;class $t{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(e){this.start_=e.getTime()}calculateFps_(e){if(this.timestamps_.length===0)return null;const t=this.timestamps_[0];return 1e3*(this.frameCount_-t.frameCount)/(e-t.time)}compactTimestamps_(){if(this.timestamps_.length<=Nt)return;const e=this.timestamps_.length-Nt;this.timestamps_.splice(0,e);const t=this.timestamps_[0].frameCount;this.timestamps_.forEach(n=>{n.frameCount-=t}),this.frameCount_-=t}end(e){if(this.start_===null)return;const t=e.getTime();this.duration_=t-this.start_,this.start_=null,this.fps_=this.calculateFps_(t),this.timestamps_.push({frameCount:this.frameCount_,time:t}),++this.frameCount_,this.compactTimestamps_()}}const ue=x("fps");class Ft{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ue()),t.viewProps.bindClassModifiers(this.element),this.graphElement=e.createElement("div"),this.graphElement.classList.add(ue("g")),this.element.appendChild(this.graphElement);const n=e.createElement("div");n.classList.add(ue("l")),this.element.appendChild(n);const s=e.createElement("span");s.classList.add(ue("v")),s.textContent="--",n.appendChild(s),this.valueElement=s;const r=e.createElement("span");r.classList.add(ue("u")),r.textContent="FPS",n.appendChild(r)}}class qe{constructor(e,t){this.stopwatch_=new $t,this.onTick_=this.onTick_.bind(this),this.ticker_=t.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=t.value,this.viewProps=t.viewProps,this.view=new Ft(e,{viewProps:this.viewProps}),this.graphC_=new On(e,{formatter:V(0),lineCount:t.lineCount,props:y.fromObject({maxValue:t.maxValue,minValue:t.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()})}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const e=this.stopwatch_.fps;if(e!==null){const t=this.value_.rawValue;this.value_.rawValue=un(t,e),this.view.valueElement.textContent=e.toFixed(0)}}}function Xn(i,e){return e===0?new Ei:new ki(i,e??In.monitor.defaultInterval)}const Yn={id:"fpsgraph",type:"blade",accept(i){const e=q,t=Q(i,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return t?{params:t}:null},controller(i){var e,t,n,s;const r=(e=i.params.interval)!==null&&e!==void 0?e:500;return new fe(i.document,{blade:i.blade,props:y.fromObject({label:i.params.label}),valueController:new qe(i.document,{lineCount:(t=i.params.lineCount)!==null&&t!==void 0?t:2,maxValue:(n=i.params.max)!==null&&n!==void 0?n:90,minValue:(s=i.params.min)!==null&&s!==void 0?s:0,ticker:Xn(i.document,r),value:ln(80),viewProps:i.viewProps})})},api(i){return!(i.controller instanceof fe)||!(i.controller.valueController instanceof qe)?null:new At(i.controller)}};class M{constructor(e,t){this.min=e,this.max=t}static isObject(e){if(typeof e!="object"||e===null)return!1;const t=e.min,n=e.max;return!(typeof t!="number"||typeof n!="number")}static equals(e,t){return e.min===t.min&&e.max===t.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Xe={fromComponents:i=>new M(i[0],i[1]),toComponents:i=>[i.min,i.max]};class Ye{constructor(e){this.edge=e}constrain(e){var t,n,s,r,o,l,v,L;if(e.min<=e.max)return new M((n=(t=this.edge)===null||t===void 0?void 0:t.constrain(e.min))!==null&&n!==void 0?n:e.min,(r=(s=this.edge)===null||s===void 0?void 0:s.constrain(e.max))!==null&&r!==void 0?r:e.max);const A=(e.min+e.max)/2;return new M((l=(o=this.edge)===null||o===void 0?void 0:o.constrain(A))!==null&&l!==void 0?l:A,(L=(v=this.edge)===null||v===void 0?void 0:v.constrain(A))!==null&&L!==void 0?L:A)}}const We=x("rsltxt");class Gt{constructor(e,t){this.sliderView_=t.sliderView,this.textView_=t.textView,this.element=e.createElement("div"),this.element.classList.add(We());const n=e.createElement("div");n.classList.add(We("s")),n.appendChild(this.sliderView_.element),this.element.appendChild(n);const s=e.createElement("div");s.classList.add(We("t")),s.appendChild(this.textView_.element),this.element.appendChild(s)}}const W=x("rsl");class Kt{constructor(e,t){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=t.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=e.createElement("div"),this.element.classList.add(W()),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_);const n=e.createElement("div");n.classList.add(W("t")),this.element.appendChild(n),this.trackElement=n;const s=e.createElement("div");s.classList.add(W("b")),n.appendChild(s),this.barElement=s;const r=["min","max"].map(o=>{const l=e.createElement("div");return l.classList.add(W("k"),W("k",o)),n.appendChild(l),l});this.knobElements=[r[0],r[1]],this.update_()}valueToX_(e){const t=this.sliderProps_.get("minValue"),n=this.sliderProps_.get("maxValue");return te(P(e,t,n,0,1),0,1)*100}update_(){const e=this.value_.rawValue;e.length===0?this.element.classList.add(W(void 0,"zero")):this.element.classList.remove(W(void 0,"zero"));const t=[this.valueToX_(e.min),this.valueToX_(e.max)];this.barElement.style.left=`${t[0]}%`,this.barElement.style.right=`${100-t[1]}%`,this.knobElements.forEach((n,s)=>{n.style.left=`${t[s]}%`})}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Ut{constructor(e,t){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=t.sliderProps,this.viewProps=t.viewProps,this.value=t.value,this.view=new Kt(e,{sliderProps:this.sliderProps,value:this.value,viewProps:t.viewProps});const n=new ke(this.view.trackElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(e){if(!e.point)return null;const t=(e.point.x+this.ofs_())/e.bounds.width,n=this.sliderProps.get("minValue"),s=this.sliderProps.get("maxValue");return P(t,0,1,n,s)}onPointerDown_(e){if(!e.data.point)return;const t=e.data.point.x/e.data.bounds.width,n=this.value.rawValue,s=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue"),o=P(n.min,s,r,0,1),l=P(n.max,s,r,0,1);Math.abs(l-t)<=.025?this.grabbing_="max":Math.abs(o-t)<=.025?this.grabbing_="min":t>=o&&t<=l?(this.grabbing_="length",this.grabOffset_=P(t-o,0,1,0,r-s)):t<o?(this.grabbing_="min",this.onPointerMove_(e)):t>l&&(this.grabbing_="max",this.onPointerMove_(e))}applyPointToValue_(e,t){const n=this.valueFromData_(e);if(n===null)return;const s=this.sliderProps.get("minValue"),r=this.sliderProps.get("maxValue");if(this.grabbing_==="min")this.value.setRawValue(new M(n,this.value.rawValue.max),t);else if(this.grabbing_==="max")this.value.setRawValue(new M(this.value.rawValue.min,n),t);else if(this.grabbing_==="length"){const o=this.value.rawValue.length;let l=n-this.grabOffset_,v=l+o;l<s?(l=s,v=s+o):v>r&&(l=r-o,v=r),this.value.setRawValue(new M(l,v),t)}}onPointerMove_(e){this.applyPointToValue_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.applyPointToValue_(e.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Ht{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sc_=new Ut(e,t);const n={baseStep:t.baseStep,constraint:t.constraint,textProps:y.fromObject({draggingScale:t.draggingScale,formatter:t.formatter})};this.tc_=new Ne(e,{assembly:Xe,axes:[n,n],parser:t.parser,value:this.value,viewProps:t.viewProps}),this.view=new Gt(e,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function Wn(i){return M.isObject(i)?new M(i.min,i.max):new M(0,0)}function Zn(i,e){i.writeProperty("max",e.max),i.writeProperty("min",e.min)}function Jn(i){const e=[],t=Ln(i);t&&e.push(t);const n=Sn(i);return n&&e.push(n),new Ye(new ut(e))}const Qn={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(i,e)=>{if(!M.isObject(i))return null;const t=q,n=Q(e,{format:t.optional.function,max:t.optional.number,min:t.optional.number,step:t.optional.number});return n?{initialValue:new M(i.min,i.max),params:n}:null},binding:{reader:i=>Wn,constraint:i=>Jn(i.params),equals:M.equals,writer:i=>Zn},controller(i){var e;const t=i.value,n=i.constraint;if(!(n instanceof Ye))throw E.shouldNeverHappen();const s=(t.rawValue.min+t.rawValue.max)/2,r=(e=i.params.format)!==null&&e!==void 0?e:V(mn(n.edge,s)),o=n.edge&&xe(n.edge,dt);if(o)return new Ht(i.document,{baseStep:yt(n.edge),constraint:n.edge,draggingScale:bn(n.edge,s),formatter:r,parser:Ce,sliderProps:new y({maxValue:o.values.value("max"),minValue:o.values.value("min")}),value:t,viewProps:i.viewProps});const l={baseStep:yt(n.edge),constraint:n.edge,textProps:y.fromObject({draggingScale:s,formatter:r})};return new Ne(i.document,{assembly:Xe,axes:[l,l],parser:Ce,value:t,viewProps:i.viewProps})}};class qt{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return(e=this.controller_.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.props.set("title",e)}}class Xt extends b{constructor(e,t,n,s,r){super(e,s,r),this.cell=t,this.index=n}}class Yt extends u{constructor(e){super(e),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach(n=>{const s=new qt(n);this.cellToApiMap_.set(n,s)})}get value(){return this.controller_.value}cell(e,t){const n=this.controller_.valueController,s=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(s)}on(e,t){const n=t.bind(this);this.controller_.value.emitter.on(e,s=>{const r=this.controller_.valueController,o=r.findCellByValue(s.rawValue);if(!o)return;const l=this.cellToApiMap_.get(o);if(!l)return;const v=r.cellControllers.indexOf(o);n(new Xt(this,l,[v%r.size[0],Math.floor(v/r.size[0])],s.rawValue,void 0))})}}const de=x("rad");class Wt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(de()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(de("l")),this.element.appendChild(n);const s=e.createElement("input");s.classList.add(de("i")),s.name=t.name,s.type="radio",t.viewProps.bindDisabled(s),n.appendChild(s),this.inputElement=s;const r=e.createElement("div");r.classList.add(de("b")),n.appendChild(r);const o=e.createElement("div");o.classList.add(de("t")),r.appendChild(o),J(t.props,"title",l=>{o.textContent=l})}}class Zt{constructor(e,t){this.props=t.props,this.viewProps=t.viewProps,this.view=new Wt(e,{name:t.name,props:this.props,viewProps:this.viewProps})}}class ze{constructor(e,t){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=t.size;const[n,s]=this.size;for(let r=0;r<s;r++)for(let o=0;o<n;o++){const l=new Zt(e,{name:t.groupName,props:y.fromObject(Object.assign({},t.cellConfig(o,r))),viewProps:X.create()});this.cellCs_.push(l),this.cellValues_.push(t.cellConfig(o,r).value)}this.value=t.value,B(this.value,r=>{const o=this.findCellByValue(r);o&&(o.view.inputElement.checked=!0)}),this.viewProps=X.create(),this.view=new pt(e,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach(r=>{r.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(r.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(e){const t=this.cellValues_.findIndex(n=>n===e);return t<0?null:this.cellCs_[t]}onCellInputChange_(e){const t=e.currentTarget,n=this.cellCs_.findIndex(s=>s.view.inputElement===t);n<0||(this.value.rawValue=this.cellValues_[n])}}const es=function(){return{id:"radiogrid",type:"blade",accept(i){const e=q,t=Q(i,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return t?{params:t}:null},controller(i){return new we(i.document,{blade:i.blade,props:y.fromObject({label:i.params.label}),valueController:new ze(i.document,{groupName:i.params.groupName,cellConfig:i.params.cells,size:i.params.size,value:I(i.params.value)})})},api(i){return!(i.controller instanceof we)||!(i.controller.valueController instanceof ze)?null:new Yt(i.controller)}}}();function Ze(i){return{id:"input-radiogrid",type:"input",accept(e,t){if(!i.isType(e))return null;const n=q,s=Q(t,{cells:n.required.function,groupName:n.required.string,size:n.required.array(n.required.number),view:n.required.constant("radiogrid")});return s?{initialValue:e,params:s}:null},binding:i.binding,controller:e=>new ze(e.document,{cellConfig:e.params.cells,groupName:e.params.groupName,size:e.params.size,value:e.value})}}const ts=Ze({isType:i=>typeof i=="number",binding:{reader:i=>rn,writer:i=>Ae}}),is=Ze({isType:i=>typeof i=="string",binding:{reader:i=>an,writer:i=>Ae}}),ns=Ze({isType:i=>typeof i=="boolean",binding:{reader:i=>Di,writer:i=>Ae}}),ss=[jn,qn,Yn,Qn,es,ns,ts,is];p.ButtonCellApi=Et,p.ButtonGridApi=kt,p.ButtonGridController=$e,p.CubicBezier=G,p.CubicBezierApi=Vt,p.CubicBezierAssembly=Ge,p.CubicBezierController=He,p.CubicBezierGraphController=Bt,p.CubicBezierGraphView=St,p.CubicBezierPickerController=jt,p.CubicBezierPickerView=Tt,p.CubicBezierPreviewView=Ot,p.CubicBezierView=Mt,p.FpsGraphBladeApi=At,p.FpsGraphController=qe,p.FpsView=Ft,p.Fpswatch=$t,p.Interval=M,p.IntervalAssembly=Xe,p.IntervalConstraint=Ye,p.RadioCellApi=qt,p.RadioController=Zt,p.RadioGridApi=Yt,p.RadioGridController=ze,p.RadioView=Wt,p.RangeSliderController=Ut,p.RangeSliderTextController=Ht,p.RangeSliderTextView=Gt,p.RangeSliderView=Kt,p.TpRadioGridChangeEvent=Xt,p.plugins=ss,Object.defineProperty(p,"__esModule",{value:!0})})})(Os,ve);const Bs=hs(ve),js=vs({__proto__:null,default:Bs},[ve]),ce=Object.fromEntries(Object.entries(Object.assign({"./functions/CameraDebug.js":gs,"./functions/GameDebug.js":ws,"./functions/PlayerDebug.js":Cs,"./functions/PostProcessingDebug.js":ks,"./functions/SceneDebug.js":Ms,"./functions/SoundDebug.js":Ss,"./functions/StatsDebug.js":Rs})).map(([d,a])=>[d.split("/").pop().split(".")[0].replace("Debug",""),a]));var O,Z,oe,T,me;class Gs{constructor(){ne(this,O,void 0);ne(this,Z,void 0);ne(this,oe,void 0);ne(this,T,void 0);ne(this,me,void 0);$.register(this),se(this,O,new Map),se(this,Z,new Map)}async load(){se(this,me,await ti(()=>import("./tweakpane-6a89d895.js").then(a=>a.t),["assets/tweakpane-6a89d895.js","assets/_commonjsHelpers-725317a4.js"]))}init(){var p;se(this,T,new(g(this,me)).Pane({title:us})),g(this,T).registerPlugin(js),g(this,T).hidden=localStorage.getItem("debug")==="true",se(this,oe,g(this,T).addTab({pages:ds.map(u=>({title:u}))}).pages),g(this,T).addSeparator(),g(this,T).addButton({title:"Refresh"}).on("click",()=>g(this,T).refresh());const a=(p=N.debug)==null?void 0:p.urlParams.getNumber("tab");a&&g(this,oe)[a].controller_.onItemClick_()}addToParent(a,p,u){g(this,O).get(u)||g(this,O).set(u,[]),g(this,O).get(u).push(a),g(this,Z).get(u)&&ce[p].createPane(g(this,Z).get(u),a,p)}add(a,p,u=0,m=""){var b,h,c,w;if(ce[p]){const E=(h=(b=ce[p]).createPane)==null?void 0:h.call(b,g(this,oe)[u],a,m||p);(w=(c=ce[p]).debug)==null||w.call(c,a),g(this,Z).set(p,E),g(this,O).get(p)&&(g(this,O).get(p).forEach(k=>ce[p](E,k,p)),g(this,O).delete(p))}else console.warn("No debug mapping found for",p)}onKeyDown(a){a==="h"&&(g(this,T).hidden=!g(this,T).hidden,localStorage.setItem("debug",g(this,T).hidden))}}O=new WeakMap,Z=new WeakMap,oe=new WeakMap,T=new WeakMap,me=new WeakMap;export{Gs as Mapping};
